import{s as d,S as w,R as M,_ as W,b as I,c as st,r as S,j as e,f as N,B as x,n as A,o as rt,A as it,m as V}from"./index-364164ff.js";import{u as ot,a as ct,b as lt,f as q,e as dt,o as ut,c as ft,d as mt}from"./format-date-to-iso-c8369123.js";import{d as L,e as xt,b as pt}from"./use-transaction-11dd6a75.js";import{s as z}from"./sleep-da79c358.js";import{a as ht}from"./mineCooldown-95f931d2.js";import{I as k}from"./index-80efe635.js";import{i as D}from"./index-34b29f91.js";import{i as wt}from"./index-2cf8db19.js";import"./user-miners-query-e605aaca.js";import"./axios-43b00e28.js";import"./index-3b291b83.js";import"./index.esm-00b1d713.js";import"./iconBase-50db91b3.js";const jt=d("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",w:"100%","@sm":{px:"0px"}}),yt=d("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),gt=d("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Tt=d("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"20px",w:"100%",maxWidth:"1330px",mt:"40px",px:"15px",bg:"rgba(3, 16, 32,  .55)",br:"22px",padding:"20px 35px","@sm":{padding:"20px"}}),y=d("div",{d:"grid",gridTemplateColumns:"2fr 1fr 2fr",gap:"15px",w:"100%",padding:"10px 40px ",br:"10px",bg:"rgba(255,255,255,0.03)","@sm":{d:"flex",align:"center",justify:"center",direction:"column",padding:"10px 10px ",maxH:"100%",button:{h:"30px",minW:"100%",maxW:"100%"}}}),g=d("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),F=d("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"25px",h:"100%",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),Q=d("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"5px",color:"$white500",mr:"auto",">div":{mx:"auto",w:"95%",bg:"rgba(255,255,255)",br:"10px"},input:{color:"black",ff:"$heading",textAlign:"right",mr:"5px"},"@sm":{w:"100%",justify:"space-between"}}),T=d("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"14px",w:"100%","@md":{fs:"12px"},"@sm":{fs:"11px",fw:"$bold"}}),b=d("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"24px",w:"100%",svg:{m:"auto 5px",w:"20px",h:"20px"},"@md":{fs:"18px"},"@sm":{justify:"space-between",w:"max-content",fw:"$bold",fs:"12px",svg:{w:"15px",h:"15px"}}}),_=d("div",{d:"flex",align:"center",justify:"center",gap:"10px",padding:"5px 20px 5px 10px",w:"100%",svg:{color:"$white500",w:"25px",h:"25px",mr:"auto"},"@sm":{d:"none"}}),p=d("span",{w:"100%",color:"$white500",fs:"18px",ff:"$heading",svg:{verticalAlign:"sub",w:"23px",h:"23px"},"@lg":{fs:"12px"},"@md":{fs:"10px"},"@sm":{}}),H=d("div",{w:"100%",h:"100%",d:"flex",align:"center",justify:"center",gap:"10px"});async function bt(t){const{executeTransaction:s}=L(),i=_t(t);return!!await s(i)}function _t(t){return{actions:[{account:w.M__FEDERATION,name:"claimcomms",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{receiver:t.name}}]}}async function Mt(t){const{executeTransaction:s}=L(),i=Lt(t);return!!await s(i)}function Lt(t){return{actions:[{account:w.AWLNDRATINGS,name:"claimpay",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{receiver:t.name}}]}}async function Ct(t,s,i){const{executeTransaction:r}=L(),l=Rt(s,i,t);return!!await r(l)}function Rt(t,s,i){return{actions:s.map(l=>({account:w.MISSION_CONTROL,name:"claimweek",authorization:[{actor:i.name,permission:i.authorization.permission}],data:{wallet:i.name,week_id:l,boost_percentage:t}}))}}async function vt(t,s){const{executeTransaction:i}=L(),r=St(t,s);return!!await i(r)}function St(t,s){return{actions:[{account:w.HQ_MU,name:"withdrawtlm",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name}},{account:w.MEMBERS_MC,name:"withdrawdepo",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,amount:s}}]}}async function Dt(t,s){const{executeTransaction:i}=L(),r=Wt(t,s);return!!await i(r)}function Wt(t,s){return{actions:[{account:w.MISSION_CONTROL,name:"storeqp",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,qp:s}}]}}async function $t(t,s){const{executeTransaction:i}=L(),r=Et(t,s);return!!await i(r)}function Et(t,s){return{actions:[{account:w.MISSION_CONTROL,name:"withdrawqp",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,qp:s}}]}}const It={addTLM:!1,withdrawTLM:!1,claimTLM:!1,claimMines:!1,claimComms:!1,claimPay:!1,weekReward:!1},h=M.lazy(()=>W(()=>import("./info-builder-c1cb9080.js"),["assets/info-builder-c1cb9080.js","assets/index-364164ff.js","assets/index-55fec1ff.css"])),v=M.lazy(()=>W(()=>import("./tlm-537a6456.js"),["assets/tlm-537a6456.js","assets/index-364164ff.js","assets/index-55fec1ff.css"])),At=M.lazy(()=>W(()=>import("./star-6b77c4b0.js"),["assets/star-6b77c4b0.js","assets/index-364164ff.js","assets/index-55fec1ff.css"])),zt=M.lazy(()=>W(()=>import("./quest-6317f198.js"),["assets/quest-6317f198.js","assets/index-364164ff.js","assets/index-55fec1ff.css"])),Jt=()=>{var B,P,O;const t=I(n=>n.user),s=I(n=>n.updateMember),i=st(n=>n.weeklies);ot();const{data:r}=xt(),{data:l}=ct(),{data:f}=lt(),[o,c]=M.useState(It),[G,U]=M.useState(""),u=S.useRef(null),C=S.useRef(null),$=i==null?void 0:i.reduce((n,a)=>{const R=((a==null?void 0:a.initial_prize_pool_formatted)??0)*((a==null?void 0:a.total_quest_points)??1)/((a==null?void 0:a.total_quest_points_week)??1);return a.week_id&&a.total_quest_points_user_week>0&&D(new Date,new Date(a==null?void 0:a.expiresDate))&&wt(new Date,new Date((a==null?void 0:a.end_date)??""))?{total:n.total+R,weeks:[...n.weeks,a.week_id]}:{total:n.total,weeks:[...n.weeks]}},{total:0,weeks:[]});async function Z(){if(t){c({...o,claimMines:!0});try{if(!await dt(t))throw new Error("Claim Mines error from contract");await m()}catch(n){console.log(n)}finally{c({...o,claimMines:!1})}}}async function J(){if(t){c({...o,claimComms:!0});try{if(!await bt(t))throw new Error("Claim Comms error from contract");await m()}catch(n){console.log(n)}finally{c({...o,claimComms:!1})}}}async function K(){if(t){c({...o,claimPay:!0});try{if(!await Mt(t))throw new Error("Claim Pay error from contract");await m()}catch(n){console.log(n)}finally{c({...o,claimPay:!1})}}}async function X(){if(t){c({...o,weekReward:!1});try{if(!await Ct(t,0,$.weeks))throw new Error("Week Reward error from contract");await m(),await rt()}catch(n){console.log(n)}finally{c({...o,weekReward:!1})}}}async function m(){if(!(t!=null&&t.name))return null;await z(500);const n=await it(t==null?void 0:t.name);I.setState(a=>({...a,user:a.user?{...a.user,userTlm:n}:null})),await s(),await ut(),await pt(),await ft(),await mt()}async function Y(n){if(t){c({...o,withdrawTLM:!0});try{if(!await vt(t,n))throw new Error("Withdrawn TLM error from contract");await m()}catch(a){console.log(a)}finally{c({...o,withdrawTLM:!1})}}}async function tt(){if(!(!t||!(u!=null&&u.current))){c({...o,withdrawTLM:!0});try{if(!await $t(t,Number(u.current.value)))throw new Error("Withdrawn TLM error from contract");await m(),await z(1e3),V.success("Successfully withdrawn")}catch(n){console.log(n)}finally{c({...o,withdrawTLM:!1})}}}async function et(){if(!(!t||!(C!=null&&C.current))){c({...o,withdrawTLM:!0});try{if(!await Dt(t,Number(C.current.value)))throw new Error("Withdrawn TLM error from contract");await m(),await z(1e3),V.success("Successfully deposited")}catch(n){console.log(n)}finally{c({...o,withdrawTLM:!1})}}}function nt(){u!=null&&u.current&&(u.current.value=((t==null?void 0:t.score_nft)??0).toString())}const at=n=>{const a=n.days?`${n.days}d`:"",R=n.hours?`${n.hours}h`:"",E=n.minutes?`${n.minutes}m`:"";return`${a}${R}${E}${n.seconds}s`},j=S.useMemo(()=>new Date((r==null?void 0:r.timestamp)||new Date),[r==null?void 0:r.timestamp]);return S.useEffect(()=>{const n=setInterval(()=>{const a=new Date(`${q(j)}`),R=ht(a),E=at(R);U(E)},1e3);return()=>clearInterval(n)},[j]),e.jsxs(jt,{children:[e.jsxs(yt,{children:[e.jsx(gt,{children:"The Vault"}),e.jsx("img",{src:"/assets/background/bg-the-vault.webp",alt:""})]}),e.jsxs(Tt,{children:[e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Deposited TLM"}),e.jsxs(b,{children:[(N((B=t==null?void 0:t.HqMember)==null?void 0:B.deposit)+((t==null?void 0:t.tlm_deposit)??0)/1e4).toFixed(4),e.jsx(v,{})]})]}),e.jsx(x,{rounded:!1,color:"solidBlue",isLoading:o.withdrawTLM,disabled:N((P=t==null?void 0:t.HqMember)==null?void 0:P.deposit)+((t==null?void 0:t.tlm_deposit)??0)/1e4===0,onClick:()=>Y((t==null?void 0:t.tlm_deposit)??0),children:"Withdraw"}),e.jsxs(_,{children:[e.jsx(h,{}),e.jsx(p,{children:"Deposits are currently unused"})]})]}),e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Alien Worlds Mining Rewards"}),e.jsxs(b,{children:[(r==null?void 0:r.amount.replace(" TLM",""))??"0.0000"," ",e.jsx(v,{})]})]}),e.jsx(x,{isLoading:o.claimMines,disabled:((r==null?void 0:r.amount)??0)===0||D(A,j),onClick:Z,rounded:!1,color:"solidBlue",children:D(A,j)?G:"Claim"}),e.jsxs(_,{children:[e.jsx(h,{}),e.jsxs(p,{children:["Earned by mining in Alien Worlds",D(A,j)&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),`Available on ${new Date(`${q(j)}.000Z`).toLocaleString()}`]})]})]})]}),e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Alien Worlds Land Commission"}),e.jsxs(b,{children:[(l==null?void 0:l.comms.replace(" TLM",""))??"0.0000"," ",e.jsx(v,{})]})]}),e.jsx(x,{isLoading:o.claimComms,disabled:((l==null?void 0:l.comms)??0)===0,onClick:J,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(_,{children:[e.jsx(h,{}),e.jsx(p,{children:"Rewarded when others mine your land"})]})]}),e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Alien Worlds DTAL"}),e.jsxs(b,{children:[(f==null?void 0:f.payoutAmount.replace(" TLM",""))??"0.0000"," ",e.jsx(v,{})]})]}),e.jsx(x,{isLoading:o.claimPay,disabled:((f==null?void 0:f.payoutAmount)??0)===0,onClick:K,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(_,{children:[e.jsx(h,{}),e.jsx(p,{children:"Earned daily by owning lands in Alien Worlds"})]})]}),e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Mission Control Weekly Rewards"}),e.jsxs(b,{children:[$.total.toFixed(4)," ",e.jsx(v,{})]})]}),e.jsx(x,{isLoading:o.weekReward,disabled:$.total===0,onClick:X,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(_,{children:[e.jsx(h,{}),e.jsxs(p,{children:["Earned by playing Mission Control, costs ",e.jsx(At,{})," to claim"]})]})]}),e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(T,{children:"Reward Point Deposit"}),e.jsxs(b,{onClick:nt,children:[t==null?void 0:t.score_nft," ",e.jsx(zt,{})]})]}),e.jsxs(F,{children:[e.jsxs(Q,{children:[e.jsx(x,{isLoading:o.weekReward,onClick:tt,rounded:!1,color:"solidBlue",children:"Withdraw"}),e.jsx(k,{dir:"rtl",type:"number",defaultValue:0,ref:u,label:""})]}),e.jsxs(Q,{children:[e.jsx(x,{isLoading:o.weekReward,onClick:et,rounded:!1,color:"solidBlue",children:"Deposit"}),e.jsx(k,{dir:"rtl",type:"number",defaultValue:((O=t==null?void 0:t.userWeekly)==null?void 0:O.total_quest_points)??0,ref:C,label:""})]})]}),e.jsx(_,{children:e.jsxs(F,{children:[e.jsxs(H,{children:[e.jsx(h,{}),e.jsx(p,{children:"Reward Points you deposited at an earlier date"})]}),e.jsxs(H,{children:[e.jsx(h,{}),e.jsx(p,{children:"Deposit Reward Points for later use. There is a 10% fee when depositing."})]})]})})]})]})]})};export{Jt as default};

import{g as M,S as w,T as $,a as P,Q as y,b as E,q as C,am as R,e as O,s,u as N,j as t,F as I,R as U,an as W,f as l,d as T,i as B,ae as _,m as k,p as L,B as F}from"./index-2923b243.js";import{i as A}from"./index-bfd6fc59.js";const Y=async n=>await M({options:{code:w.GAME_MC,index_position:1,limit:"10000",scope:w.GAME_MC,table:$.PLAYERS,lower_bound:n,upper_bound:n}}),D=[{label:"prodone",value:0},{label:"prodtwo",value:1},{label:"prodthree",value:2},{label:"prodfour",value:3},{label:"prodfive",value:4},{label:"prodsix",value:5}],z=()=>P({queryKey:[y.MCP_PLAYERS],queryFn:()=>H(),staleTime:1e3*60*60,enabled:!!E.getState().user});async function G(){return C.removeQueries(y.MCP_PLAYERS),await C.invalidateQueries(y.MCP_PLAYERS)}async function H(){const n=E.getState().user;if(!n)return null;try{const r=await Y(n.name);return r?q(r):null}catch(r){return console.log(r),null}}async function q(n){var x,c;const r=(c=(x=n==null?void 0:n[0])==null?void 0:x.buildings)==null?void 0:c.sort((d,p)=>D.findIndex(i=>i.label===d.buildingid)-D.findIndex(i=>i.label===p.buildingid)),{getAssetByAssetId:e}=R,u=await Promise.all(r.map(async d=>({...d,staked_asset_ids:await Promise.all(d.staked_asset_ids.map(async p=>{var S;const i=await e(p);return{...i,img:`https://ipfs.alienworlds.io/ipfs/${(S=i==null?void 0:i.data)==null?void 0:S.img}`}}))})));return{...n[0],buildings:u}}const Q=O({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),K=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),V=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),J=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Z=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),X=s("h2",{d:"flex",align:"center",justify:"center",my:"40px",textAlign:"center",color:"$white500",fs:"30px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),ee=s("div",{d:"flex",align:"flex-start",justify:"center",gap:"0px",padding:"50px",bg:"rgba(0, 0, 0, 0.26)",w:"100%",img:{width:"100%",maxW:"510px"},"@sm":{flexWrap:"wrap"}}),te=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"0px",w:"100%",button:{h:"50px",w:"300px",div:{fs:"18px",border:"none"}},"@sm":{mt:"20px"}}),ne=s("div",{d:"flex",align:"center",justify:"center",position:"relative",w:"100%",maxW:"400px",mb:"30px",color:"$white500",fs:"30px",fw:"bold",ff:"$heading",textAlign:"center",gap:"10px"}),se=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",ff:"$body",gap:"10px"}),ae=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",fw:"bold",ff:"$body",gap:"10px"});s("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${Q} 1.2s ease-in-out infinite`});const ie=async()=>await M({options:{code:w.GAME_MC,index_position:1,limit:"10000",scope:w.GAME_MC,table:$.SEASON}}),re=()=>P({queryKey:[y.SEASON],queryFn:()=>oe(),staleTime:1e3*60*60});async function oe(){try{const n=await ie();return n||null}catch(n){return console.log(n),null}}async function le(n){const{executeTransaction:r}=N(),e=ce(n);return!!await r(e)}function ce(n){return{actions:[{account:w.GAME_MC,name:"regplayer",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name}}]}}O({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}});const de=s("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)","@sm":{padding:"0 15px"}}),ue=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),xe=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),pe=s("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),v=()=>t.jsxs(de,{children:[t.jsxs(ue,{children:[t.jsx(xe,{children:"Outpost Builder"}),t.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),t.jsx(pe,{children:t.jsx(I,{size:"lg",colorSchema:"light"})})]}),fe=U.lazy(()=>W(()=>import("./index-140363df.js").then(n=>n.i),["assets/index-140363df.js","assets/index-2923b243.js","assets/index-55fec1ff.css","assets/info-builder-84cc6b86.js","assets/index-f34d886c.js","assets/index-0a924a23.js","assets/index-6e664479.js"])),ge=()=>{const{data:n,isLoading:r}=z(),{data:e}=re(),u=E(a=>a.user),[x,c]=l.useState({title:"",nextSeason:t.jsx("br",{}),disabled:!1}),[d,p]=l.useState(!1),i=l.useCallback(()=>{var f,g;if(!(e!=null&&e[0]))return;const a=new Date,o=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());if(A(new Date(o),new Date(e[0].season_start))){const{days:m,hours:b,minutes:h}=T(new Date((f=e==null?void 0:e[0])==null?void 0:f.season_start));c({title:"NEW SEASON STARTING SOON",nextSeason:`Next season starting in ${m} days ${b} hours and ${h} minutes`,disabled:!0});return}if(B(new Date(o),new Date(e[0].season_end))){c({title:"WE ARE WRAPPING UP THE PREVIOUS SEASON. RETURNING NFTS, SENDING PRIZES, ....",nextSeason:t.jsx("br",{}),disabled:!0});return}if(_(new Date(o),{start:new Date(e[0].season_start),end:new Date(e[0].season_end)})){const{days:m,hours:b,minutes:h,seconds:j}=T(new Date((g=e==null?void 0:e[0])==null?void 0:g.season_end));c({title:`SEASON ENDS IN ${m} DAYS ${b} HOURS ${h} MINUTES ${j} SECONDS`,nextSeason:t.jsx("br",{}),disabled:!1});return}},[e]),S=l.useCallback(async()=>{if(u){p(!0);try{await le(u)&&(await k(6e3),G())}catch(a){console.log(a)}finally{p(!1)}}},[u]);return l.useEffect(()=>{i()},[i]),l.useEffect(()=>{if(!(e!=null&&e[0]))return;const a=setInterval(()=>{var g;const o=new Date,f=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());if(A(new Date(f),new Date(e[0].season_start))){const{days:m,hours:b,minutes:h}=T(new Date((g=e==null?void 0:e[0])==null?void 0:g.season_start));c(j=>({...j,nextSeason:`Next season starting in ${m} days ${b} hours and ${h} minutes`})),_(new Date(f),{start:new Date(e[0].season_start),end:new Date(e[0].season_end)})&&(i(),clearInterval(a))}},1e3);return()=>clearInterval(a)},[e,i]),r?t.jsx(v,{}):n&&e&&_(new Date(L),{start:new Date(e[0].season_start),end:new Date(e[0].season_end)})?t.jsx(l.Suspense,{fallback:t.jsx(v,{}),children:t.jsx(fe,{season:e[0]})}):t.jsx(l.Suspense,{fallback:t.jsx(v,{}),children:t.jsxs(K,{children:[t.jsxs(V,{children:[t.jsx(J,{children:"Outpost Builder"}),t.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),t.jsxs(Z,{children:[t.jsx(X,{children:x.title}),t.jsxs(ee,{children:[t.jsx("img",{src:"/assets/mcp/mcp-builder.png",alt:""}),t.jsxs(te,{children:[t.jsxs(ne,{children:["WELCOME TO ",t.jsx("br",{})," OUTPOST BUILDER"]}),t.jsxs(se,{children:["Mission Control needs YOU to help gain more resources. Build an outpost on a remote planet in this seasonal idle building game. Ramp up your production and deliver resources to Mission Control in exchange for McPoints.",t.jsx("br",{})," ",t.jsx("br",{}),"Who will manage to to deliver the most resources to Mission Control? Who will take up the challenge for the top of the leaderboard this season?",t.jsx("br",{})," ",t.jsx("br",{}),"Ready? Then what are you waiting for?"]}),t.jsx(ae,{children:x.nextSeason}),t.jsx(F,{isLoading:d,color:"solidBlue",disabled:d||x.disabled,rounded:!1,onClick:S,children:"START NOW !"})]})]})]})]})})},he=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{v as L,re as a,D as b,he as i,G as o,z as u};

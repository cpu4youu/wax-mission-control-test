import{e as xe,s as i,c as Le,g as J,S as j,T as X,b as E,a as le,Q as N,u as re,q as ie,f as Ne,p as _e,d as Ae,ab as Fe,h as k,j as e,B as I,k as ae,l as oe,aj as Se,K as $e}from"./index-a0bfb841.js";import{S}from"./index-5b7c43ad.js";import{I as Me,a as Ve}from"./index.esm-ceb9e133.js";import{a as Be}from"./index.esm-80a4472d.js";import{T as We}from"./index-5d25f3f2.js";import{a as ve}from"./index.esm-e0d51897.js";import{C as Oe}from"./check-0acb1f55.js";import{N as y}from"./index-c68f839f.js";import"./index.esm-c14da48d.js";import"./index-fac4aada.js";import"./index-7694250d.js";import"./index-b42ad6d4.js";import"./gradient-border-b461fcf1.js";import"./index.esm-4c54e350.js";const we=xe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),De=i("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",minH:"calc(100vh - 80px)",bg:"$blue700","@sm":{".select":{w:"100%",button:{minW:"100%"}}}}),qe=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",mt:"-20px",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",inset:0}}),Pe=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{mt:"0px",fs:"26px"}}),Ie=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"0px",w:"100%",maxW:"1121px"}),ge=i("h2",{d:"flex",align:"center",justify:"flex-start",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"20px",w:"100%",m:"30px 0 10px","@sm":{fs:"26px"}}),ze=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"20px",flexWrap:"wrap",w:"100%","@sm":{gap:"10px",my:"20px",direction:"column",".select":{m:"0"}}}),Ue=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",mt:"20px",padding:"10px 15px",br:"10px",border:"3px solid #D32C54",background:"rgba(255, 255, 255, 0.03)"}),He=i("span",{color:"$white500",fs:"20px",fw:"bold"}),Ge=i("span",{color:"$white500",fs:"20px",">span":{fontWeight:"bold",cursor:"pointer"}}),Ze=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"20px",w:"100%","@sm":{justify:"center",padding:"0 10px",flexWrap:"wrap",gap:"10px"}}),Ke=i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",span:{color:"$white500",ff:"$heading","&:first-child":{textTransform:"capitalize"},"&:last-child":{fw:"700",padding:"2px 5px",mt:"-20px",bg:"#D9D9D9",br:"5px",border:"1px solid #FFF",color:"$black500"}},img:{w:"100px",h:"100px"}}),Qe=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%",">button":{minW:"unset",div:{borderWidth:"2px",px:"30px",h:"45px"}},"@sm":{padding:"0 10px",flexWrap:"wrap",gap:"10px"},"@xsm":{">button":{minW:"100%"}}}),Ye=i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"20px",w:"100%","@sm":{my:"10px",">button":{order:-1}}}),Je=i("div",{d:"flex",align:"center",justify:"space-between",direction:"column",position:"relative",overflow:"hidden",mt:"10px",w:"100%",maxW:"1121px",br:"10px",background:"rgba(255, 255, 255, 0.06)",">img":{w:"130px",h:"130px",m:"auto"},variants:{status:{false:{opacity:.5},true:{}}},"@sm":{padding:"5px",my:"10px",">img":{d:"none"}}}),Xe=i("div",{d:"flex",align:"center",justify:"center",position:"absolute",w:"200px",top:"30px",right:"-55px",transform:"rotate(45deg)",py:"10px",bg:"#65B5FF",color:"#fff",fs:"18px",ff:"$heading"}),et=i("div",{d:"flex",align:"center",justify:"space-between",w:"100%",padding:"20px 40px 20px 20px",">img":{w:"130px",h:"130px"},"@sm":{padding:"5px",">img":{d:"none"}}}),W=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column"}),tt=i("div",{d:"flex",align:"center",justify:"space-between",gap:"10px",ml:"20px","@xsm":{order:-1,ml:"0px"}}),nt=i("div",{d:"flex",align:"flex-start",justify:"flex-start",w:"100%",gridArea:"title","@xsm":{direction:"column"}}),st=i("p",{gridArea:"description",w:"100%",mr:"auto",color:"$white500",ff:"$body",fs:"16px","@sm":{fw:"500",fs:"12px"}}),it=i("div",{gridArea:"buttons",d:"flex",align:"center",justify:"center",gap:"5px",m:"10px auto 10px 0",">button":{h:"42px",minH:"42px",w:"100px",minW:"110px",svg:{mr:"5px"},div:{justify:"flex-start",mx:"auto"},"&.loading":{div:{justify:"center"}},"&:last-child":{minW:"150px",div:{justify:"center"}}},"@sm":{fw:"500",fs:"12px",gap:"0px",w:"100%",">button":{h:"42px",minH:"42px",w:"100%",minW:"unset",svg:{mr:"10px"}}}}),at=i("div",{d:"grid",gridTemplateAreas:`
    "title title img"
    "description description img"
    "buttons buttons img"
  `,maxW:"840px",w:"100%",">img":{d:"none",gridArea:"img"},"@sm":{gridTemplateAreas:`
      "title title img"
      "description description img"
      "buttons buttons buttons"
    `,">img":{d:"flex",w:"130px",h:"130px"}}}),Ce=i("div",{d:"flex",align:"center",justify:"center",border:"1px solid #fff",w:"50px",h:"50px","@xsm":{w:"35px",h:"35px",mb:"10px"}}),ot=i("p",{w:"100%",color:"#CBCBCB",ff:"$heading",fs:"16px",fw:"700","@sm":{fs:"12px"}}),lt=i("p",{w:"100%",color:"#BEBEBE",ff:"$heading",fs:"16px",fw:"700",span:{color:"red"},variants:{status:{passed:{color:"#00BAFF"},failed:{color:"#D32C54"},active:{color:"#fff"}}},"@sm":{fs:"12px"}}),rt=i("p",{d:"flex",align:"center",justify:"flex-start",w:"100%",color:"$white500",ff:"$heading",fs:"20px",fw:"800",textAlign:"left","@sm":{justify:"space-between",fs:"18px",">img":{d:"flex",w:"60px",h:"60px"}}}),ct=i("div",{d:"grid",gridTemplateColumns:"repeat(7, 1fr)",gridGap:"1px",width:"100%","@xsm":{gridTemplateColumns:"repeat(4, 1fr)"}}),q=i("p",{d:"flex",align:"center",justify:"center",width:"100%",height:"40px",color:"$white500",textAlign:"center",ff:"$body",fs:"15px",mr:"auto",background:"rgba(217, 217, 217, 0.24)","@sm":{fs:"12px"}}),P=i("p",{d:"flex",align:"center",justify:"center",width:"100%",height:"40px",color:"$white500",textAlign:"center",ff:"$body",fs:"15px",mr:"auto",variants:{highlight:{true:{background:"rgba(217, 217, 217, 0.08)"}}},"@sm":{fs:"12px"}}),dt=i("div",{mt:"10px",w:"100px",height:"100px",background:"linear-gradient( -90deg, rgba(255, 255, 244, 0.40), rgba(3, 16, 32, 0.75) ,rgba(255, 255, 244, 0.40))",br:"999px",backgroundSize:"400% 400%",animation:`${we} 1.2s ease-in-out infinite`}),pt=i("div",{mt:"10px",w:"100%",maxW:"1121px",height:"100px",background:"linear-gradient( -90deg, rgba(255, 255, 244, 0.40), rgba(3, 16, 32, 0.75) ,rgba(255, 255, 244, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${we} 1.2s ease-in-out infinite`}),ut=i("div",{mt:"10px",w:"100%",maxW:"1121px",height:"200px",background:"linear-gradient( -90deg, rgba(255, 255, 244, 0.40), rgba(3, 16, 32, 0.75) ,rgba(255, 255, 244, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${we} 1.2s ease-in-out infinite`}),xt=xe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),ft=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",bg:"$blue700","@sm":{".select":{w:"100%",button:{minW:"100%"}}}}),mt=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",mt:"-20px",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",inset:0}}),gt=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{mt:"0px",fs:"26px"}}),ht=i("form",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",padding:"20px 50px",w:"100%",maxW:"1121px",">div":{w:"100%",label:{w:"100%",m:"0px",justify:"flex-start",fs:"22px"},">div":{br:"10px",bg:"rgba(255, 255, 255, 0.54)",borderWidth:"3px",borderColor:"#FFCE1F","&:hover":{borderColor:"#FFCE1F"},"&:not(:has(input:placeholder-shown))":{borderColor:"#FFCE1F"}},textarea:{br:"10px",bg:"rgba(255, 255, 255, 0.54)",borderWidth:"3px",borderColor:"#FFCE1F","&:hover":{borderColor:"#FFCE1F"},"&:not(:has(input:placeholder-shown))":{borderColor:"#FFCE1F"}}},".textarea":{br:"10px",minH:"500px",maxW:"100%",minW:"100%",bg:"rgba(255, 255, 255, 0.54)",borderWidth:"3px",borderColor:"#FFCE1F"},">button":{w:"360px",minH:"35px",div:{h:"35px"}},"@md":{padding:"20px ",">div":{maxW:"100%",label:{fs:"16px"}},">button":{w:"100%",minW:"100%"}}}),bt=i("div",{d:"flex",align:"center",justify:"flex-start",position:"relative",input:{opacity:0,zIndex:1,w:"25px",h:"25px","& ~ div svg":{d:"none"}},"input:checked ~ div":{bg:"#FF9D0A",svg:{d:"flex"}},span:{color:"$white500",ml:"10px"},a:{color:"#FF9D0A"},"@sm":{img:{w:"55px"}}}),vt=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"absolute",top:"0px",left:"0px",w:"25px",h:"25px",bg:"#fff",border:"3px solid #5A5A5A",borderRadius:"6px",svg:{w:"15px",h:"15px",path:{fill:"white"}}}),wt=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"20px",flexWrap:"wrap",".select":{bg:"transparent"},w:"100%","@sm":{gap:"10px",my:"20px",direction:"column",".select":{m:"0"}}});i("div",{d:"flex",align:"center",justify:"center",gap:"20px",w:"100%","@sm":{padding:"0 10px",flexWrap:"wrap",gap:"10px"}});i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"10px",span:{color:"$white500",ff:"$heading","&:last-child":{fw:"700",padding:"2px 5px",mt:"-20px",bg:"#D9D9D9",br:"5px",border:"1px solid #FFF",color:"$black500"}}});i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"20px",w:"100%","@sm":{my:"10px",">button":{order:-1}}});i("div",{d:"flex",align:"center",justify:"space-between",w:"100%",maxW:"1121px",padding:"20px",br:"10px",background:"rgba(255, 255, 255, 0.06)",">img":{w:"130px",h:"130px",m:"auto"},variants:{status:{passed:{border:"4px solid #00BAFF"},failed:{border:"4px solid #D32C54"},active:{border:"4px solid #fff"}}},"@sm":{my:"10px",">img":{d:"none"}}});i("p",{d:"flex",align:"center",justify:"center",direction:"column",maxW:"840px"});i("p",{w:"100%",color:"#CBCBCB",ff:"$heading",fs:"16px",fw:"700","@sm":{fs:"12px"}});i("p",{w:"100%",color:"#BEBEBE",ff:"$heading",fs:"16px",fw:"700",span:{color:"red"},variants:{status:{passed:{color:"#00BAFF"},failed:{color:"#D32C54"},active:{color:"#fff"}}},"@sm":{fs:"12px"}});i("p",{d:"flex",align:"center",justify:"center",w:"100%",color:"$white500",ff:"$heading",fs:"32px",fw:"800",">img":{d:"none"},"@sm":{fs:"18px",">img":{d:"flex",w:"60px",h:"60px"}}});i("p",{w:"100%",mr:"auto",color:"$white500",ff:"$body",fs:"16px","@sm":{fw:"500",fs:"12px"}});i("div",{d:"flex",align:"center",justify:"center",gap:"5px",m:"10px auto 10px 0",">button":{minH:"42px",h:"42px",w:"100px",minW:"110px",svg:{mr:"10px"}},"@sm":{fw:"500",fs:"12px"}});i("p",{color:"$white500",textAlign:"center",ff:"$body",fs:"16px",mr:"auto","@sm":{p:{fs:"18px"}}});i("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${xt} 1.2s ease-in-out infinite`});const fe=[{label:"Eyeke",value:"eyeke"},{label:"Kavian",value:"kavian"},{label:"Magor",value:"magor"},{label:"Naron",value:"naron"},{label:"Neri",value:"nerix"},{label:"Veles",value:"veles"}],Ee=[{label:"Active",value:"active"},{label:"Completed",value:"completed"}],pe=[{label:"All",value:"all"},{label:"Token",value:"token"},{label:"Account",value:"account"}],ue=[{label:"All",value:"all"},{label:"Opinion",value:"opinion"},{label:"Semi-Binding",value:"semibinding"}],g=Le((t,s)=>({selectedPage:"referendums",filter:{planet:fe[0],status:Ee[0],votingType:pe[0],referendumType:ue[0]}})),yt=async t=>await J({options:{code:j.REF_WORLDS,index_position:1,limit:"10000",scope:t,key_type:"i64",table:X.CONFIG}}),ye=()=>{const t=g.getState().filter.planet,s=E.getState().user;return le({queryKey:[N.REFERENDUMS_CONFIG,t],queryFn:()=>jt(),staleTime:1e3*60*60,enabled:!!s})};async function jt(){const t=g.getState().filter.planet;try{const s=await yt(t.value);return s?s[0]:null}catch(s){return console.log(s),null}}async function Ct(t){const{executeTransaction:s,serializeActions:a}=re();let o=[];t.type!=="opinion"&&(o=await a([{account:j.ALIEN_WORLDS,name:"transfer",authorization:[{actor:`${t.dac_id}.dac`,permission:"active"}],data:{from:`${t.dac_id}.dac`,to:t.wallet_receive_tlm,quantity:t.requested_tlm,memo:t.memo_tlm_transfer}}]));const c=await Tt(t,o);return!!await s(c)}async function Tt(t,s){return{actions:[{account:j.ALIEN_WORLDS,name:"transfer",authorization:[{actor:t.user.name,permission:t.user.requestPermission}],data:{from:t.user.name,memo:"",quantity:t.fee.quantity,to:"ref.worlds"}},{account:j.REF_WORLDS,name:"propose",authorization:[{actor:t.user.name,permission:t.user.requestPermission}],data:{proposer:t.user.name,type:t.type,voting_type_name:t.voting_type_name,title:t.title,content:t.content,dac_id:t.dac_id,acts:t.type!=="opinion"?s:t.acts}}]}}const _t=async t=>await J({options:{code:j.REF_WORLDS,index_position:1,limit:"10000",scope:t,key_type:"i64",table:X.REFERENDUMS}}),Ft=()=>{const t=g.getState().filter.planet;return le({queryKey:[N.REFERENDUMS,t],queryFn:()=>St(),staleTime:1e3*60*60})};async function be(){return ie.removeQueries([N.REFERENDUMS]),await ie.invalidateQueries([N.REFERENDUMS])}async function St(){const t=g.getState().filter.planet;try{const s=await _t(t.value);return s?await Promise.all(s.map(async o=>{const c=await Et(o.content_ref),p=Ne(new Date(o.expires),_e)||o.status!=="executed",v=(o.voting_type==="token"?o.token_votes.reverse():o.account_votes.reverse()).map(d=>({...d,value:o.voting_type==="token"?d.value/1e4:d.value}));return{...o,description:c,votes:v,totalVotes:v[1].value+v[0].value,expiration:Ae(new Date(o.expires)),isActive:p}})):null}catch(s){return console.log(s),null}}const Te=["wax.eosdac.io","api.waxsweden.org","wax.cryptolions.io","wax.api.eosnation.io","wax.greymass.com","api.wax.bountyblok.io"];async function Et(t){var c,p,x;let s=0,a=!1,o="";do try{const{data:v}=await Fe(`https://${Te[s]}/v2/history/get_transaction?id=${t}`);return o=((x=(p=(c=v==null?void 0:v.actions.find(({act:d})=>{var R;return!!((R=d==null?void 0:d.data)!=null&&R.content)}))==null?void 0:c.act)==null?void 0:p.data)==null?void 0:x.content)??"",o||(a=!0,s++),o}catch{a=!0,s++}while(!a||s<Te.length);return o}const Rt=()=>{const{data:t}=ye(),s=E(r=>r.user),a=g(r=>r.filter),[o,c]=k.useState(!1),[p,x]=k.useState(!1);function v(r,l){r&&g.setState(h=>({...h,filter:{...h.filter,[l]:r}}))}function d(){g.setState(r=>({...r,selectedPage:"referendums"}))}async function R(r){var L,A,O,D,$,B,n,f,u,T;if(r.preventDefault(),!s||!(t!=null&&t.fee[1].value))return;c(!0);const l=(A=(L=r.target)==null?void 0:L.title)==null?void 0:A.value,h=(D=(O=r.target)==null?void 0:O.content)==null?void 0:D.value,w=(B=($=r.target)==null?void 0:$.requested_tlm)==null?void 0:B.value,C=(f=(n=r.target)==null?void 0:n.wallet_receive_tlm)==null?void 0:f.value,b=(T=(u=r.target)==null?void 0:u.memo_tlm_transfer)==null?void 0:T.value,V={user:s,type:a.referendumType.value,voting_type_name:a.votingType.value,title:l,content:h,acts:[],dac_id:a.planet.value,fee:t==null?void 0:t.fee[1].value,requested_tlm:`${w}.0000 TLM`,wallet_receive_tlm:C,memo_tlm_transfer:b};try{await Ct(V)&&(await ae(5e3),await be(),oe.success("Propose successfully registered"),d())}catch(M){console.error("error",M)}finally{c(!1)}}return k.useEffect(()=>{const r=a.votingType.value==="all"?pe.slice(1)[0]:a.votingType,l=a.referendumType.value==="all"?ue.slice(1)[0]:a.referendumType;g.setState(h=>({...h,filter:{...h.filter,votingType:r,referendumType:l}}))},[]),e.jsxs(ft,{children:[e.jsxs(mt,{children:[e.jsx(gt,{children:"Referendums"}),e.jsx("img",{src:"/assets/background/bg-referendums.jpeg",alt:""})]}),e.jsxs(ht,{onSubmit:R,children:[e.jsx(ve,{size:30,color:"#fff",onClick:d}),e.jsxs(wt,{children:[e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"PLANET",className:"select",title:"",selected:a.planet,options:fe,onSelected:r=>v(r,"planet")}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"VOTING TYPE",className:"select",title:"",selected:a.votingType,options:pe.slice(1),onSelected:r=>v(r,"votingType")}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"REFERENDUM TYPE",className:"select",title:"",selected:a.referendumType,options:ue.slice(1),onSelected:r=>v(r,"referendumType")})]}),e.jsx(y,{label:"TITLE",id:"title",className:"input"}),e.jsx(We,{label:"DESCRIPTION",id:"content",className:"textarea"}),a.referendumType.value!=="opinion"&&e.jsx(y,{required:!0,type:"number",label:"REQUESTED TLM",id:"requested_tlm",className:"input"}),a.referendumType.value!=="opinion"&&e.jsx(y,{required:!0,label:"WALLET TO RECEIVE THE TLM",id:"wallet_receive_tlm",className:"input"}),a.referendumType.value!=="opinion"&&e.jsx(y,{required:!0,label:"MEMO FOR TLM TRANSFER",id:"memo_tlm_transfer",className:"input"}),e.jsxs(bt,{children:[e.jsx("input",{type:"checkbox",checked:p,onChange:r=>{var l;return x((l=r.target)==null?void 0:l.checked)},required:!0}),e.jsx(vt,{children:e.jsx(Oe,{})}),e.jsxs("span",{children:["I have read and agree to the latest"," ",e.jsx("a",{href:`https://play.alienworlds.io/syndicates/${a.planet.value}/memberTerms`,target:"_blank",rel:"noreferrer",children:"DAO Membership Terms"})]})]}),e.jsxs(I,{isLoading:o,disabled:o||!p,rounded:!1,color:"gradientYellow",type:"submit",children:["PROPOSE FOR ",t==null?void 0:t.fee[1].value.quantity]})]})]})},kt=async t=>await J({options:{code:j.REF_WORLDS,index_position:1,limit:"10000",scope:t,key_type:"i64",table:X.REFERENDUMS_VOTES}}),Lt=()=>{const t=g.getState().filter.planet,s=E.getState().user;return le({queryKey:[N.REFERENDUMS_VOTE,t],queryFn:()=>At(),staleTime:1e3*60*60,enabled:!!s})};async function Nt(){return await ie.invalidateQueries([N.REFERENDUMS_VOTE])}async function At(){const t=g.getState().filter.planet,s=E.getState().user;try{const a=await kt(t.value);if(!a||!s)return null;const o=a.find(c=>c.voter===s.name);return o||null}catch(a){return console.log(a),null}}const $t=async t=>{const s=E.getState().user;return await J({options:{code:j.TOKEN_WORLDS,index_position:1,limit:"1",scope:t,key_type:"i64",table:X.STAKES,lower_bound:s==null?void 0:s.name,upper_bound:s==null?void 0:s.name}})},he={EYE:"eyeke",MAG:"magor",VEL:"veles",NAR:"naron",NER:"nerix",KAV:"kavian"},Mt=()=>{const t=E.getState().user;return le({queryKey:[N.REFERENDUMS_PLANETS],queryFn:()=>Bt(),staleTime:1e3*60*60,enabled:!!t})};async function Vt(){return await ie.invalidateQueries([N.REFERENDUMS_PLANETS])}async function Bt(){if(!E.getState().user)return null;try{return await Promise.all(Object.values(he).flatMap(async a=>{const o=await $t(a);if(!o)return{name:a,img:`/assets/planets/${a}.png`,balance:"0"};const c=o==null?void 0:o.stake.replace(/.*(\ )/g,""),p=Number(o==null?void 0:o.stake.replace(/(\ ).*/,"")),x=Se(p);return{name:he[c],img:`/assets/planets/${he[c]}.png`,balance:x}}))}catch(s){return console.log(s),null}}async function Wt(t,s,a,o){const{executeTransaction:c}=re(),p=Ot(t,s,a,o);return!!await c(p)}function Ot(t,s,a,o){return{actions:[{account:j.REF_WORLDS,name:"clean",authorization:[{actor:t.name,permission:t.requestPermission}],data:{account:t.name,dac_id:o}},{account:j.REF_WORLDS,name:"vote",authorization:[{actor:t.name,permission:t.requestPermission}],data:{voter:t.name,referendum_id:s,vote:a,dac_id:o}}]}}const Dt=xe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),qt=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",bg:"$blue700","@sm":{".select":{w:"100%",button:{minW:"100%"}}}}),Pt=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",mt:"-20px",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",inset:0}}),It=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{mt:"0px",fs:"26px"}}),zt=i("form",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",padding:"20px 50px",w:"100%",maxW:"1180px",">button":{w:"370px",minH:"60px",div:{h:"60px",fs:"16px"}},"@md":{">div":{maxW:"100%"}},"@sm":{padding:"20px 5px"}}),Ut=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"20px",".select":{bg:"transparent"},w:"100%","@sm":{gap:"10px",my:"20px",direction:"column",".select":{m:"0"}}}),Ht=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",">div":{w:"300px",maxW:"unset"},label:{fs:"20px"},input:{fs:"20px",fw:"bold"},button:{w:"300px"},"@sm":{w:"100%",">div":{w:"100%"}}}),Gt=i("div",{d:"flex",align:"center",justify:"center",h:"150px",br:"8px",color:"$white500",bg:"rgba(255, 255, 255, 0.05)",textAlign:"center",fs:"20px"}),G=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",mt:"20px"}),Z=i("div",{d:"flex",align:"flex-start",justify:"flex-start",color:"$white500",fs:"20px",ff:"$heading",fw:"400"}),K=i("div",{d:"flex",align:"flex-start",justify:"flex-start",color:"$white500",fs:"20px",fw:"400"}),Q=i("div",{d:"grid",gridTemplateColumns:"1fr",gridGap:"5px",w:"100%"}),Y=i("div",{d:"flex",gridGap:"10px",w:"100%",span:{w:"250px",color:"#767676",fs:"20px",fw:"400"},"@md":{span:{w:"200px","&:first-child":{w:"250px"}}},"@sm":{span:{d:"none"}}}),_=i("div",{d:"flex",gap:"10px",w:"100%",h:"60px",br:"8px",bg:"rgba(255, 255, 255, 0.05)",">div":{d:"flex",align:"center",justify:"center",w:"100%",maxW:"250px",span:{color:"$black500",fw:"bold"}},">span":{d:"flex",align:"center",justify:"flex-start",w:"240px",pl:"15px",color:"$white500",fs:"20px",fw:"400"},label:{d:"none"},"@md":{">div":{maxW:"210px"}},"@sm":{padding:"10px",mt:"15px",h:"unset",direction:"column",label:{d:"flex"},">div":{w:"100%",maxW:"100%"}}});i("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${Dt} 1.2s ease-in-out infinite`});async function Zt(t){const{executeTransaction:s,serializeActions:a}=re(),o=await a([{account:j.REF_WORLDS,name:"updateconfig",authorization:[{actor:`${t.dac_id}.dac`,permission:t.user.requestPermission}],data:{config:t.config,dac_id:t.dac_id}}]),c=Kt(t,o);return!!await s(c)}function Kt(t,s){return{actions:[{account:j.MSIG_WORLDS,name:"propose",authorization:[{actor:t.user.name,permission:t.user.requestPermission}],data:{proposer:t.user.name,proposal_name:Math.random().toString(36).replace(/[^a-z1-5]+/g,"").substring(0,12),requested:[{actor:`${t.dac_id}.dac`,permission:"active"}],dac_id:t.dac_id,metadata:[{key:"title",value:"Referendum Config Update"},{key:"description",value:"testing a new feature"}],trx:{expiration:$e(_e,7),ref_block_num:0,ref_block_prefix:0,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:s,transaction_extensions:[]}}}]}}const F=[{label:"Allowed",value:"allowed"},{label:"Not Allowed",value:"not-allowed"}],Qt=()=>{const{data:t}=ye(),s=E(l=>l.user),a=g(l=>l.filter),[o,c]=k.useState(!1),[p,x]=k.useState({allow_per_account_voting:[{key:"binding",value:!1},{key:"opinion",value:!0},{key:"semibinding",value:!0}],allow_vote_type:[{key:"binding",value:!1},{key:"opinion",value:!0},{key:"semibinding",value:!0}]});function v(l,h){l&&g.setState(w=>({...w,filter:{...w.filter,[h]:l}}))}function d(l,h,w){l&&x({...p,[w]:p[w].map(C=>C.key===h?{...C,value:l.value==="allowed"}:C)})}function R(){g.setState(l=>({...l,selectedPage:"referendums"}))}async function r(l){var h,w,C,b,V,L,A,O,D,$,B,n,f,u,T,M,z,U,ee,te,ne,se;if(l.preventDefault(),!!s)try{c(!0);const H=(((w=(h=l.target)==null?void 0:h.duration)==null?void 0:w.value)||0)*86400,ce=[{key:"binding",value:{contract:"alien.worlds",quantity:"1000.0000 TLM"}},{key:"semibinding",value:{contract:(b=(C=l.target)==null?void 0:C["fee-contract-semibinding"])==null?void 0:b.value,quantity:(L=(V=l.target)==null?void 0:V["fee-semibinding"])==null?void 0:L.value}},{key:"opinion",value:{contract:(O=(A=l.target)==null?void 0:A["fee-contract-opinion"])==null?void 0:O.value,quantity:($=(D=l.target)==null?void 0:D["fee-opinion"])==null?void 0:$.value}}],de=[{key:"binding",value:100*100},{key:"semibinding",value:(((n=(B=l.target)==null?void 0:B["rate-semibinding"])==null?void 0:n.value)||0)*100},{key:"opinion",value:(((u=(f=l.target)==null?void 0:f["rate-opinion"])==null?void 0:u.value)||0)*100}],m=[{key:"binding",value:1e5},{key:"semibinding",value:+((M=(T=l.target)==null?void 0:T["min-account-semibinding"])==null?void 0:M.value)},{key:"opinion",value:+((U=(z=l.target)==null?void 0:z["min-account-opinion"])==null?void 0:U.value)}],me=[{key:"binding",value:1e11},{key:"semibinding",value:+((te=(ee=l.target)==null?void 0:ee["min-token-semibinding"])==null?void 0:te.value)},{key:"opinion",value:+((se=(ne=l.target)==null?void 0:ne["min-token-opinion"])==null?void 0:se.value)}],Re=p.allow_per_account_voting,ke=p.allow_vote_type,je={user:s,config:{duration:H,fee:ce,pass:de,quorum_account:m,quorum_token:me,allow_per_account_voting:Re,allow_vote_type:ke},dac_id:a.planet.value};console.log(je),await Zt(je)&&(await ae(1e3),await Vt(),oe.success("Configuration successfully updated"),R())}catch(H){console.error(H)}finally{c(!1)}}return k.useEffect(()=>{var l,h;t&&x({allow_vote_type:(l=t==null?void 0:t.allow_vote_type)==null?void 0:l.map(w=>w),allow_per_account_voting:(h=t==null?void 0:t.allow_per_account_voting)==null?void 0:h.map(w=>w)})},[t]),e.jsxs(qt,{children:[e.jsxs(Pt,{children:[e.jsx(It,{children:"Referendums"}),e.jsx("img",{src:"/assets/background/bg-referendums.jpeg",alt:""})]}),e.jsxs(zt,{onSubmit:r,children:[e.jsx(ve,{size:30,color:"#fff",onClick:R}),e.jsxs(Ut,{children:[e.jsxs(Ht,{children:[e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"PLANET",className:"select",title:"",selected:a.planet,options:fe,onSelected:l=>v(l,"planet")}),e.jsx(y,{textAfterInside:"days",label:"REFERENDUM DURATION",id:"duration",defaultValue:((t==null?void 0:t.duration)||0)/86400,required:!0,className:"input"})]}),e.jsx(Gt,{children:"Custodians can create a proposal to their DAO to change the configuration for the referendums on their planet."})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"CREATION FEE"}),e.jsx(K,{children:"This is the fee a player has to pay in order to create a referendum on this planet"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Token"}),e.jsx("span",{children:"Token Contract"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(y,{label:"Token",id:"fee-opinion",className:"input",defaultValue:t==null?void 0:t.fee[1].value.quantity,required:!0}),e.jsx(y,{required:!0,defaultValue:"alien.worlds",label:"Token Contract",id:"fee-contract-opinion",className:"input"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(y,{label:"Token",id:"fee-semibinding",className:"input",defaultValue:t==null?void 0:t.fee[2].value.quantity,required:!0}),e.jsx(y,{required:!0,defaultValue:"alien.worlds",label:"Token Contract",id:"fee-contract-semibinding",className:"input"})]})]})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"MINIMUM APPROVAL RATE"}),e.jsx(K,{children:"The minimum approval rate which need to be reached in order for a referendum to pass"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Approval Percentage"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(y,{required:!0,type:"number",label:"",textAfterInside:"%",id:"rate-opinion",className:"input",defaultValue:(Number(t==null?void 0:t.pass[1].value)||0)/100})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(y,{required:!0,type:"number",label:"",textAfterInside:"%",id:"rate-semibinding",className:"input",defaultValue:(Number(t==null?void 0:t.pass[2].value)||0)/100})]})]})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"MINIMUM VOTES (UNIQUE WALLETS)"}),e.jsx(K,{children:"The minimum unique wallets that need to vote on this referendum in order for a referendum to pass"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Wallet Amount"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(y,{required:!0,type:"number",label:"",id:"min-account-opinion",className:"input",defaultValue:Number(t==null?void 0:t.quorum_account[1].value)||0})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(y,{required:!0,type:"number",label:"",id:"min-account-semibinding",className:"input",defaultValue:Number(t==null?void 0:t.quorum_account[2].value)||0})]})]})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"MINIMUM VOTES (TOKENS)"}),e.jsx(K,{children:"The minimum total amount of tokens that need to vote on this referendum in order for a referendum to pass"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Token Amount"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(y,{required:!0,type:"number",label:"",id:"min-token-opinion",className:"input",defaultValue:Number(t==null?void 0:t.quorum_token[1].value)||0})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(y,{required:!0,type:"number",label:"",id:"min-token-semibinding",className:"input",defaultValue:Number(t==null?void 0:t.quorum_token[2].value)||0})]})]})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"ALLOW REFERENDUMS OF VOTING TYPE: UNIQUE WALLETS"}),e.jsx(K,{children:"The minimum total amount of tokens that need to vote on this referendum in order for a referendum to pass"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Unique Wallet Voting"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"",className:"select",title:"",selected:p.allow_per_account_voting[1].value?F[0]:F[1],options:F,onSelected:l=>d(l,"opinion","allow_per_account_voting")})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"",className:"select",title:"",selected:p.allow_per_account_voting[2].value?F[0]:F[1],options:F,onSelected:l=>d(l,"semibinding","allow_per_account_voting")})]})]})]}),e.jsxs(G,{children:[e.jsx(Z,{children:"ALLOW REFERENDUMS OF VOTING TYPE: TOKEN"}),e.jsx(K,{children:"The minimum total amount of tokens that need to vote on this referendum in order for a referendum to pass"}),e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Token Voting"})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Opinion"}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"",className:"select",title:"",selected:p.allow_vote_type[1].value?F[0]:F[1],options:F,onSelected:l=>d(l,"opinion","allow_vote_type")})]}),e.jsxs(_,{children:[e.jsx("span",{children:"Semi-Binding"}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",label:"",className:"select",title:"",selected:p.allow_vote_type[2].value?F[0]:F[1],options:F,onSelected:l=>d(l,"semibinding","allow_vote_type")})]})]})]}),e.jsx(I,{isLoading:o,disabled:o,rounded:!1,color:"gradientYellow",type:"submit",children:"Propose to DAO"})]})]})},Yt=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38",viewBox:"0 0 38 38",fill:"none",children:[e.jsx("path",{d:"M19.0002 3.80005C16.9015 3.80005 15.2002 5.50136 15.2002 7.60005V30.4C15.2002 32.4988 16.9015 34.2 19.0002 34.2C21.0989 34.2 22.8002 32.4988 22.8002 30.4V7.60005C22.8002 5.50136 21.0989 3.80005 19.0002 3.80005Z",fill:"white"}),e.jsx("path",{d:"M7.5998 19C5.50112 19 3.7998 20.7013 3.7998 22.8V30.4C3.7998 32.4987 5.50112 34.2 7.5998 34.2C9.69848 34.2 11.3998 32.4987 11.3998 30.4V22.8C11.3998 20.7013 9.69848 19 7.5998 19Z",fill:"white"}),e.jsx("path",{d:"M30.3996 11.4C28.3009 11.4 26.5996 13.1013 26.5996 15.2V30.4C26.5996 32.4988 28.3009 34.2 30.3996 34.2C32.4983 34.2 34.1996 32.4988 34.1996 30.4V15.2C34.1996 13.1013 32.4983 11.4 30.3996 11.4Z",fill:"white"})]}),Jt=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38",viewBox:"0 0 38 38",fill:"none",children:[e.jsx("path",{d:"M19.0003 19C22.4981 19 25.3337 16.1645 25.3337 12.6667C25.3337 9.1689 22.4981 6.33337 19.0003 6.33337C15.5025 6.33337 12.667 9.1689 12.667 12.6667C12.667 16.1645 15.5025 19 19.0003 19Z",fill:"white"}),e.jsx("path",{d:"M31.6663 30.0834V31.6667C31.6663 32.0866 31.4995 32.4894 31.2026 32.7863C30.9057 33.0832 30.5029 33.25 30.083 33.25H7.91634C7.49641 33.25 7.09369 33.0832 6.79676 32.7863C6.49982 32.4894 6.33301 32.0866 6.33301 31.6667V30.0834C6.33301 27.5638 7.3339 25.1475 9.11549 23.3659C10.8971 21.5843 13.3134 20.5834 15.833 20.5834H22.1663C24.6859 20.5834 27.1023 21.5843 28.8838 23.3659C30.6654 25.1475 31.6663 27.5638 31.6663 30.0834Z",fill:"white"})]}),Xt=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",children:[e.jsx("path",{d:"M0.5 4C0.5 2.067 2.067 0.5 4 0.5H46C47.933 0.5 49.5 2.067 49.5 4V46C49.5 47.933 47.933 49.5 46 49.5H4C2.067 49.5 0.5 47.933 0.5 46V4Z",fill:"#D9D9D9",fillOpacity:"0.05",stroke:"white"}),e.jsx("path",{d:"M25.5325 13C16.3237 13 7 15.8651 7 21.3396C7 26.8141 16.3237 29.6793 25.5325 29.6793C34.7432 29.6793 44.065 26.8141 44.065 21.3396C44.065 15.8651 34.7432 13 25.5325 13ZM16.2663 31.4176V36.9774C18.5587 37.5315 21.094 37.8707 23.6793 37.98V32.4202C21.182 32.323 18.6997 31.9872 16.2663 31.4176ZM27.3858 32.4184V37.9781C29.8832 37.8828 32.3657 37.5471 34.7988 36.9755V31.4158C32.3657 31.9873 29.8832 32.3231 27.3858 32.4184ZM38.5053 30.2297V35.7895C41.843 34.3902 44.065 32.348 44.065 29.6793V24.1195C44.065 26.7882 41.843 28.8305 38.5053 30.2297ZM12.5598 35.7895V30.2297C9.2239 28.8305 7 26.7864 7 24.1195V29.6793C7 32.3461 9.2239 34.3902 12.5598 35.7895Z",fill:"white"})]}),en=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"43",height:"43",viewBox:"0 0 43 43",fill:"none",children:e.jsx("path",{d:"M33.8449 6.61128C32.5435 5.86128 31.0316 5.56021 29.5422 5.75448C28.0528 5.94875 26.6686 6.62757 25.6032 7.68628L22.0199 11.2696C20.9611 12.3351 20.2823 13.7192 20.0881 15.2086C19.8938 16.698 20.1949 18.2099 20.9449 19.5113L19.5115 20.9446C18.2102 20.1946 16.6982 19.8935 15.2088 20.0878C13.7194 20.2821 12.3353 20.9609 11.2699 22.0196L7.68652 25.6029C6.62781 26.6684 5.94899 28.0525 5.75472 29.5419C5.56045 31.0313 5.86153 32.5432 6.61152 33.8446L2.31152 38.1446L4.83777 40.6709L9.13777 36.3709C10.4366 37.1299 11.9506 37.4362 13.4423 37.2416C14.934 37.047 16.3188 36.3626 17.3794 35.2959L20.9628 31.7125C22.0215 30.6471 22.7003 29.263 22.8946 27.7736C23.0888 26.2842 22.7878 24.7722 22.0378 23.4709L23.4711 22.0375C24.7699 22.7966 26.2839 23.1028 27.7756 22.9083C29.2673 22.7137 30.6521 22.0293 31.7128 20.9625L35.2961 17.3792C36.3548 16.3138 37.0336 14.9296 37.2279 13.4402C37.4222 11.9508 37.1211 10.4389 36.3711 9.13753L40.6711 4.83753L38.1449 2.31128L33.8449 6.61128ZM18.4365 29.1863L14.8532 32.7696C14.4665 33.1528 13.9906 33.4338 13.4682 33.587C12.9458 33.7403 12.3935 33.7611 11.8611 33.6475L13.7961 31.7125L11.2699 29.1863L9.33486 31.1213C9.22129 30.5889 9.24208 30.0366 9.39535 29.5142C9.54862 28.9918 9.82955 28.5158 10.2128 28.1292L13.7961 24.5459C14.1809 24.1599 14.6567 23.8771 15.1797 23.7237C15.7027 23.5702 16.2559 23.5511 16.7882 23.6679L14.8532 25.6029L17.3794 28.1292L19.3144 26.1942C19.428 26.7266 19.4072 27.2789 19.2539 27.8013C19.1007 28.3237 18.8198 28.7996 18.4365 29.1863ZM32.7699 14.8529L29.1865 18.4363C28.7999 18.8195 28.3239 19.1004 27.8015 19.2537C27.2792 19.407 26.7269 19.4278 26.1944 19.3142L28.1294 17.3792L25.6032 14.8529L23.6682 16.7879C23.5546 16.2555 23.5754 15.7032 23.7287 15.1809C23.882 14.6585 24.1629 14.1825 24.5461 13.7959L28.1294 10.2125C28.5142 9.82656 28.9901 9.54379 29.513 9.39034C30.036 9.2369 30.5892 9.21773 31.1215 9.33461L29.1865 11.2696L31.7128 13.7959L33.6478 11.8609C33.7613 12.3933 33.7405 12.9456 33.5873 13.468C33.434 13.9903 33.1531 14.4663 32.7699 14.8529Z",fill:"white"})}),tn=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"36",height:"35",viewBox:"0 0 36 35",fill:"none",children:[e.jsx("path",{d:"M20 10.0068C20.0012 8.20795 19.5172 6.44205 18.5989 4.89522C17.6806 3.34838 16.3621 2.07789 14.7822 1.21762C13.2024 0.357359 11.4198 -0.0608247 9.62218 0.00714168C7.82459 0.075108 6.07861 0.626707 4.56824 1.60381C3.05787 2.58092 1.83904 3.94735 1.04018 5.55911C0.241317 7.17087 -0.107988 8.96827 0.0290718 10.7619C0.166132 12.5556 0.784481 14.279 1.81896 15.7507C2.85344 17.2224 4.26574 18.3877 5.90703 19.124V24.8967H14.093V19.124C15.8518 18.3357 17.3452 17.0556 18.3932 15.438C19.4413 13.8204 19.9993 11.9343 20 10.0068ZM10 16.6006C8.69585 16.6007 7.42094 16.2141 6.3365 15.4897C5.25206 14.7653 4.4068 13.7355 3.90761 12.5307C3.40843 11.3258 3.27774 10 3.53207 8.72093C3.7864 7.44181 4.41434 6.26685 5.33646 5.34462C6.25858 4.42239 7.43347 3.79431 8.71255 3.53983C9.99164 3.28534 11.3175 3.41588 12.5224 3.91492C13.7273 4.41396 14.7571 5.2591 15.4817 6.34345C16.2062 7.42781 16.593 8.70267 16.593 10.0068C16.593 11.7555 15.8984 13.4325 14.662 14.669C13.4256 15.9056 11.7486 16.6004 10 16.6006Z",fill:"white"}),e.jsx("path",{d:"M35.625 17.4827C35.6258 16.2235 35.287 14.9874 34.6442 13.9047C34.0014 12.8219 33.0784 11.9326 31.9725 11.3305C30.8667 10.7283 29.6189 10.4356 28.3606 10.4831C27.1023 10.5307 25.8802 10.9168 24.8229 11.6007C23.7657 12.2847 22.9125 13.2411 22.3532 14.3693C21.794 15.4974 21.5495 16.7556 21.6453 18.0111C21.7412 19.2666 22.1739 20.473 22.898 21.5032C23.622 22.5334 24.6105 23.3492 25.7594 23.8647V27.9053H31.4898V23.8647C32.7211 23.3129 33.7665 22.4168 34.5001 21.2845C35.2338 20.1522 35.6244 18.8319 35.625 17.4827ZM28.625 22.0975C27.7123 22.0975 26.82 21.8269 26.0611 21.3198C25.3022 20.8127 24.7107 20.092 24.3614 19.2487C24.0122 18.4055 23.9208 17.4776 24.0988 16.5824C24.2769 15.6872 24.7164 14.8649 25.3618 14.2195C26.0072 13.5741 26.8295 13.1346 27.7247 12.9565C28.6199 12.7784 29.5478 12.8698 30.391 13.2191C31.2343 13.5684 31.955 14.1599 32.4621 14.9188C32.9692 15.6777 33.2398 16.57 33.2398 17.4827C33.2398 18.7066 32.7536 19.8804 31.8882 20.7459C31.0227 21.6113 29.8489 22.0975 28.625 22.0975Z",fill:"white"}),e.jsx("path",{d:"M23.368 34.2123H15.257C13.4842 34.2102 11.7846 33.5051 10.5311 32.2515C9.27754 30.9979 8.57238 29.2984 8.57031 27.5256V23.1068H11.4305V27.5256C11.4305 28.0283 11.5295 28.5261 11.7219 28.9905C11.9142 29.455 12.1962 29.877 12.5517 30.2325C12.9072 30.5879 13.3292 30.8699 13.7936 31.0623C14.2581 31.2547 14.7559 31.3537 15.2586 31.3537H23.368C23.8707 31.3537 24.3685 31.2547 24.8329 31.0623C25.2974 30.8699 25.7194 30.5879 26.0749 30.2325C26.4303 29.877 26.7123 29.455 26.9047 28.9905C27.0971 28.5261 27.1961 28.0283 27.1961 27.5256H30.0547C30.0526 29.2984 29.3475 30.9979 28.0939 32.2515C26.8404 33.5051 25.1408 34.2102 23.368 34.2123Z",fill:"white"}),e.jsx("path",{d:"M11.3777 20.1983C11.3777 19.9259 11.297 19.6596 11.1456 19.4331C10.9943 19.2066 10.7792 19.03 10.5275 18.9258C10.2758 18.8215 9.99886 18.7942 9.73169 18.8474C9.46451 18.9005 9.21909 19.0317 9.02646 19.2243C8.83384 19.417 8.70266 19.6624 8.64951 19.9296C8.59637 20.1967 8.62364 20.4737 8.72789 20.7254C8.83214 20.977 9.00868 21.1921 9.23518 21.3435C9.46168 21.4948 9.72798 21.5756 10.0004 21.5756C10.1813 21.5757 10.3604 21.5402 10.5276 21.471C10.6948 21.4018 10.8466 21.3003 10.9745 21.1724C11.1025 21.0445 11.2039 20.8926 11.2731 20.7255C11.3423 20.5583 11.3778 20.3792 11.3777 20.1983Z",fill:"white"}),e.jsx("path",{d:"M10.7434 20.1991H9.25586V23.1069H10.7434V20.1991Z",fill:"white"}),e.jsx("path",{d:"M29.4822 25.7279H27.7666V27.5256H29.4822V25.7279Z",fill:"white"})]}),nn=async t=>await J({options:{code:j.TOKEN_WORLDS,index_position:1,limit:"1",scope:t,key_type:"i64",reverse:!0,table:X.MEMBERS_TERMS}}),sn=async t=>{const s=E.getState().user;return await J({options:{code:j.TOKEN_WORLDS,index_position:1,limit:"1",scope:t,key_type:"i64",reverse:!0,lower_bound:s==null?void 0:s.name,upper_bound:s==null?void 0:s.name,table:X.MCP_MEMBERS}})},an=()=>{const t=g.getState().filter.planet,s=E.getState().user;return le({queryKey:[N.MEMBER_TERM,t],queryFn:()=>ln(),staleTime:1e3*60*60,enabled:!!s})};async function on(){return await ie.invalidateQueries([N.MEMBER_TERM])}async function ln(){const t=g.getState().filter.planet;try{const s=await nn(t.value),a=await sn(t.value);return s?{terms:s,members:a||void 0}:null}catch(s){return console.log(s),null}}const rn=xe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),cn=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",minH:"calc(100vh - 80px)",bg:"$blue700",">button":{d:"flex",align:"flex-start",justify:"flex-start",w:"100%",maxW:"1121px",mx:"auto",my:"20px"},"@sm":{".select":{w:"100%",button:{minW:"100%"}}}}),dn=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",mt:"-20px",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",inset:0}}),pn=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{mt:"0px",fs:"26px"}}),un=i("pre",{wordWrap:"break-word",whiteSpace:"pre-wrap",color:"$white500",mx:"auto",w:"100%",maxW:"1121px",">button":{minW:"unset",my:"20px",div:{borderWidth:"2px",px:"30px",h:"45px"}}});i("div",{mt:"10px",w:"100%",maxW:"1121px",height:"200px",background:"linear-gradient( -90deg, rgba(255, 255, 244, 0.40), rgba(3, 16, 32, 0.75) ,rgba(255, 255, 244, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${rn} 1.2s ease-in-out infinite`});async function xn(t,s,a){const{executeTransaction:o}=re(),c=fn(t,s,a);return!!await o(c)}function fn(t,s,a){return{actions:[{account:j.TOKEN_WORLDS,name:"memberreg",authorization:[{actor:t.name,permission:t.requestPermission}],data:{sender:t.name,agreedterms:s,dac_id:a}}]}}const mn=({terms:t})=>{const[s,a]=k.useState(!1),[o,c]=k.useState(""),p=E(r=>r.user),x=g(r=>r.filter);async function v(){const{data:r}=await Fe.get(`https://ipfs.alienworlds.io/ipfs/${t.terms}`);c(r)}async function d(){try{if(a(!0),!p)return;await xn(p,t.hash,x.planet.value)&&(await ae(5e3),await on(),oe.success("Success"),g.setState(l=>({...l,selectedPage:"referendums"})))}catch(r){console.error("error",r)}finally{a(!1)}}function R(){g.setState(r=>({...r,selectedPage:"referendums"}))}return k.useEffect(()=>{v()},[t.terms]),e.jsxs(cn,{children:[e.jsxs(dn,{children:[e.jsx(pn,{children:"Referendums"}),e.jsx("img",{src:"/assets/background/bg-referendums.jpeg",alt:""})]}),e.jsx("button",{onClick:R,children:e.jsx(ve,{size:30,color:"#fff"})}),e.jsxs(un,{children:[o,e.jsx(I,{isLoading:s,disabled:s,rounded:!1,color:"solidBlue",onClick:()=>d(),children:"Sign Membership Terms"})]})]})};async function gn(t,s,a){const{executeTransaction:o}=re(),c=hn(t,s,a);return!!await o(c)}function hn(t,s,a){return{actions:[{account:j.REF_WORLDS,name:"exec",authorization:[{actor:t.name,permission:t.requestPermission}],data:{referendum_id:s,dac_id:a}}]}}const $n=()=>{var B;const{data:t,isLoading:s}=Ft(),{data:a,isLoading:o}=Mt(),{data:c,isLoading:p}=Lt(),{data:x,isLoading:v}=ye(),{data:d,isLoading:R}=an(),[r,l]=k.useState(!1),[h,w]=k.useState(!1),C=E(n=>n.user),b=g(n=>n.filter),V=g(n=>n.selectedPage);function L(n,f){n&&g.setState(u=>({...u,filter:{...u.filter,[f]:n}}))}function A(n){g.setState(f=>({...f,selectedPage:n}))}async function O(n,f){if(l(!0),!!C)try{await Wt(C,n,f,b.planet.value)&&(await ae(6e3),await Nt(),await be(),oe.success("Vote successfully registered"))}catch(u){console.log(u)}finally{l(!1)}}async function D(n){if(C)try{w(!0),await gn(C,n,b.planet.value)&&(await ae(6e3),await be(),oe.success("Proposal successfully created"))}catch(f){console.log(f)}finally{w(!1)}}if(d!=null&&d.terms&&V==="terms")return e.jsx(mn,{terms:d==null?void 0:d.terms});if(V==="create")return e.jsx(Rt,{});if(V==="configure")return e.jsx(Qt,{});const $=t==null?void 0:t.filter(n=>{const f=b.status.value==="active"?n.isActive:!n.isActive,u=b.votingType.value==="all"?!0:b.votingType.value===n.voting_type,T=b.referendumType.value==="all"?!0:b.referendumType.value===n.type;return f&&u&&T});return e.jsxs(De,{children:[e.jsxs(qe,{children:[e.jsx(Pe,{children:"Referendums"}),e.jsx("img",{src:"/assets/background/bg-referendums.jpeg",alt:""})]}),e.jsxs(Ie,{children:[e.jsx(ge,{children:"FILTER"}),e.jsxs(ze,{children:[e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",isLoading:s,disabled:s,className:"select",title:"",label:"Planet",selected:b.planet,options:fe,onSelected:n=>L(n,"planet")}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",isLoading:s,disabled:s,className:"select",title:"",label:"Status",selected:b.status,options:Ee,onSelected:n=>L(n,"status")}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",isLoading:s,disabled:s,className:"select",title:"",label:"Voting Type",selected:b.votingType,options:pe,onSelected:n=>L(n,"votingType")}),e.jsx(S,{borderColor1:"#FFB31F",borderColor2:"#FFB800",isLoading:s,disabled:s,className:"select",title:"",label:"Referendum Type",selected:b.referendumType,options:ue,onSelected:n=>L(n,"referendumType")})]}),R?e.jsx(pt,{}):((d==null?void 0:d.terms.version)||0)>(((B=d==null?void 0:d.members)==null?void 0:B.agreedtermsversion)??-1)&&e.jsxs(Ue,{children:[e.jsx(He,{children:"Become a DAO member"}),e.jsxs(Ge,{children:["To participate in voting or propose referendums, you are required to sign the latest"," ",e.jsx("span",{onClick:()=>A("terms"),children:"membership terms"})," of Narons DAO"]})]}),e.jsx(ge,{children:"YOUR VOTEPOWER FOR TOKEN REFERENDUMS"}),e.jsx(Ze,{children:o?Array.from({length:6},n=>n).map((n,f)=>e.jsx(dt,{},f)):a==null?void 0:a.map(n=>e.jsxs(Ke,{children:[e.jsx("span",{children:n.name}),e.jsx("img",{src:n.img,alt:""}),e.jsx("span",{children:n.balance})]},n.name))}),e.jsx(ge,{children:"REFERENDUMS"}),e.jsxs(Qe,{children:[e.jsx(I,{rounded:!1,color:"solidBlue",onClick:()=>A("create"),children:"Create Referendum"}),e.jsx(I,{rounded:!1,color:"solidBlue",onClick:()=>A("configure"),children:"Configure"})]}),e.jsx(Ye,{children:s?Array.from({length:3},n=>n).map((n,f)=>e.jsx(ut,{},f)):$==null?void 0:$.map((n,f)=>{var ee,te,ne,se,H,ce,de;const u=c==null?void 0:c.votes.find(m=>m.key===(n==null?void 0:n.referendum_id)),T=n.voting_type==="token"?(((ee=x==null?void 0:x.quorum_token.find(m=>m.key===(n==null?void 0:n.type)))==null?void 0:ee.value)??0)/1e4:(((te=x==null?void 0:x.quorum_account.find(m=>m.key===(n==null?void 0:n.type)))==null?void 0:te.value)??0)/1e4,M=n.votes.reduce((m,me)=>m+me.value,0),z=(((ne=x==null?void 0:x.pass.find(m=>m.key===(n==null?void 0:n.type)))==null?void 0:ne.value)??0)/100,U=((n==null?void 0:n.votes[0].value)??0)/((n==null?void 0:n.totalVotes)||1)*100;return e.jsxs(Je,{status:n==null?void 0:n.isActive,children:[U>=z&&M>=T&&e.jsx(Xe,{children:"IN FAVOR"}),e.jsxs(et,{children:[e.jsxs(at,{children:[e.jsxs(nt,{children:[e.jsxs(W,{children:[n!=null&&n.isActive?e.jsxs(ot,{children:["ends in ",(se=n==null?void 0:n.expiration)==null?void 0:se.days,"d"," ",(H=n==null?void 0:n.expiration)==null?void 0:H.hours,"h",(ce=n==null?void 0:n.expiration)==null?void 0:ce.minutes,"m"]}):e.jsxs(lt,{children:["ENDED",U>=z&&M>=T?" - IN FAVOR":" - AGAINST"]}),e.jsx(rt,{children:n==null?void 0:n.title})]}),e.jsxs(tt,{children:[e.jsxs(Ce,{children:[n.type==="opinion"&&e.jsx(Yt,{}),n.type==="binding"&&e.jsx(tn,{}),n.type==="semibinding"&&e.jsx(en,{})]}),e.jsxs(Ce,{children:[n.voting_type==="account"&&e.jsx(Jt,{}),n.voting_type==="token"&&e.jsx(Xt,{})]})]})]}),e.jsx(st,{children:n==null?void 0:n.description}),e.jsx("img",{src:`/assets/planets/${b.planet.value}.png`,alt:"medium image"}),e.jsxs(it,{children:[(de=n==null?void 0:n.votes)==null?void 0:de.map(m=>e.jsxs(I,{disabled:!(n!=null&&n.isActive),isLoading:p||r,rounded:!1,onClick:()=>O(n.referendum_id,m.key),color:(u==null?void 0:u.value)==="yes"&&(u==null?void 0:u.value)===m.key?"transparentBlue":(u==null?void 0:u.value)==="no"&&(u==null?void 0:u.value)===m.key?"transparentRed":"transparentWhite",children:[m.key==="yes"&&e.jsx(Me,{size:25,color:"#fff"}),m.key==="no"&&e.jsx(Ve,{size:25,color:"#fff"}),m.key==="abstain"&&e.jsx(Be,{size:25,color:"#fff"}),m.value>1e3?Se(m.value):m.value]},m.key)),(n==null?void 0:n.isActive)&&(n==null?void 0:n.votes[0].value)>=T&&e.jsx(I,{disabled:h,isLoading:h,rounded:!1,color:"solidBlue",onClick:()=>D(n==null?void 0:n.referendum_id),children:"Create Proposal"})]})]}),e.jsx("img",{src:`/assets/planets/${b.planet.value}.png`,alt:"medium image"})]}),e.jsxs(ct,{children:[e.jsxs(W,{children:[e.jsx(q,{children:"Planet"}),e.jsx(P,{children:b.planet.label})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Voting Type"}),e.jsx(P,{highlight:!0,children:n.voting_type})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Referendum Type"}),e.jsx(P,{highlight:!0,children:n.type})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Required Votes"}),e.jsx(P,{children:T.toLocaleString()})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Current Votes"}),e.jsx(P,{children:M.toLocaleString()})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Required Approval Rate"}),e.jsxs(P,{children:[z," %"]})]}),e.jsxs(W,{children:[e.jsx(q,{children:"Current Approval Rate"}),e.jsxs(P,{children:[U," % "]})]})]})]},f)})})]})]})};export{$n as default};

import{g as u,S as o,T as l,r as S,a as M,q as _,Q as c}from"./index-7865b61a.js";const p=async()=>await u({options:{code:o.USPTS_WORLDS,index_position:1,limit:"10000",reverse:!0,key_type:"i64",scope:o.USPTS_WORLDS,table:l.LEVEL_OFFERS}}),E=async t=>{var s,i;let r=!1,e;const a=[];for(;!r;){const n=await S.get_table_rows({code:o.MEMBERS_MC,index_position:1,limit:"10000",key_type:"i64",scope:o.MEMBERS_MC,table:l.MEMBERS,lower_bound:t??e,upper_bound:t,json:!0});r=!n.more,a.push(...n.rows.slice(0,-1)),e=((i=(s=n.rows)==null?void 0:s[n.rows.length-1])==null?void 0:i.wallet)??""}return a},y=()=>M({queryKey:[c.NEWS_MEMBERS],queryFn:()=>m(),staleTime:1e3*60*60});async function b(){return await _.invalidateQueries(c.NEWS_MEMBERS)}async function m(){try{const t=await E(),r=await p();return!t||!r?null:w(t,r)}catch(t){return console.log(t),null}}function w(t,r){return t.sort((e,a)=>a.member_id-e.member_id).map(e=>{var a;return{...e,avatar:e.avatar.split(";")[0],avatarCollection:e.avatar.split(";")[1],newMemberLevel:((a=r.find(s=>e.mcp_start>=s.required))==null?void 0:a.level)??1}})}export{b as o,y as u};

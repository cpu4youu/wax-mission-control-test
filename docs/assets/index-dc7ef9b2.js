import{s as l,S as j,R as x,_ as E,b as $,r as v,j as e,B as m,m as tt,A as et,o as N,y as nt,c as mt,f as U,n as V}from"./index-2127d4ea.js";import{o as at,a as st,b as it,u as xt,c as ht,d as wt,f as Y,e as gt}from"./format-date-to-iso-4495b259.js";import{d as R,b as ot,e as jt}from"./use-transaction-7e3b2631.js";import{s as B}from"./sleep-da79c358.js";import{a as yt}from"./mineCooldown-87da4907.js";import{I as Z}from"./index-c84ea097.js";import{D as bt,a as Tt,b as _t,c as Mt}from"./index-4b06b059.js";import{i as z}from"./index-0f1288b4.js";import{i as Lt}from"./index-6b4ab597.js";import"./user-miners-query-64e208c0.js";import"./axios-43b00e28.js";import"./index-b4a14699.js";import"./index.esm-8e672b32.js";import"./iconBase-00b25216.js";import"./index-0d3b52e1.js";import"./index-3ee9b349.js";const Ct=l("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",w:"100%","@sm":{px:"0px"}}),vt=l("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),$t=l("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Rt=l("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"20px",w:"100%",maxWidth:"1330px",mt:"40px",px:"15px",bg:"rgba(3, 16, 32,  .55)",br:"22px",padding:"20px 35px","@sm":{padding:"20px"}}),T=l("div",{d:"grid",gridTemplateColumns:"2fr 1fr 2fr",gap:"15px",w:"100%",padding:"10px 40px ",br:"10px",bg:"rgba(255,255,255,0.03)","@sm":{d:"flex",align:"center",justify:"center",direction:"column",padding:"10px 10px ",maxH:"100%",button:{h:"30px",minW:"100%",maxW:"100%"}}}),_=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),J=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"25px",h:"100%",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),K=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"5px",color:"$white500",mr:"auto",">div":{mx:"auto",w:"95%",bg:"rgba(255,255,255)",br:"10px"},input:{color:"black",ff:"$heading",textAlign:"right",mr:"5px"},button:{h:"50px"},"@sm":{w:"100%",justify:"space-between"}}),M=l("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"14px",w:"100%","@md":{fs:"12px"},"@sm":{fs:"11px",fw:"$bold"}}),L=l("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"24px",w:"100%",svg:{m:"auto 5px",w:"20px",h:"20px"},"@md":{fs:"18px"},"@sm":{justify:"space-between",w:"max-content",fw:"$bold",fs:"12px",svg:{w:"15px",h:"15px"}}}),C=l("div",{d:"flex",align:"center",justify:"center",gap:"10px",padding:"5px 20px 5px 10px",w:"100%",svg:{color:"$white500",w:"25px",h:"25px",mr:"auto"},"@sm":{d:"none"}}),w=l("span",{w:"100%",color:"$white500",fs:"18px",ff:"$heading",svg:{verticalAlign:"sub",w:"23px",h:"23px"},"@lg":{fs:"12px"},"@md":{fs:"10px"},"@sm":{}}),X=l("div",{w:"100%",h:"100%",d:"flex",align:"center",justify:"center",gap:"10px"});async function Dt(t){const{executeTransaction:i}=R(),o=St(t);return!!await i(o)}function St(t){return{actions:[{account:j.M__FEDERATION,name:"claimcomms",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{receiver:t.name}}]}}async function Wt(t){const{executeTransaction:i}=R(),o=Et(t);return!!await i(o)}function Et(t){return{actions:[{account:j.AWLNDRATINGS,name:"claimpay",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{receiver:t.name}}]}}async function At(t,i,o){const{executeTransaction:a}=R(),c=It(i,o,t);return!!await a(c)}function It(t,i,o){return{actions:i.map(c=>({account:j.MISSION_CONTROL,name:"claimweek",authorization:[{actor:o.name,permission:o.authorization.permission}],data:{wallet:o.name,week_id:c,boost_percentage:t}}))}}async function Pt(t,i){const{executeTransaction:o}=R(),a=zt(t,i);return!!await o(a)}function zt(t,i){return{actions:[{account:j.HQ_MU,name:"withdrawtlm",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name}},{account:j.MEMBERS_MC,name:"withdrawdepo",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,amount:i}}]}}async function Bt(t,i){const{executeTransaction:o}=R(),a=Ot(t,i);return!!await o(a)}function Ot(t,i){return{actions:[{account:j.MISSION_CONTROL,name:"withdrawqp",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,qp:i}}]}}const Vt=l("div",{d:"flex",align:"center",justify:"center",direction:"column",bg:"$dark_blue500",w:"80vw",maxW:"685px",h2:{ff:"$heading",fs:"22px",fw:"$bold",color:"$light_blue500"},">button":{mt:"20px",w:"100%",minW:"150px",h:"30px",fs:"16px",div:{border:"none"},svg:{w:"20px",h:"20px"}}}),qt=l("div",{d:"flex-inline",align:"flex-start",justify:"flex-start",my:"20px",color:"$white500",fs:"20px",fw:"$bold",ff:"$heading",w:"100%",svg:{mr:"5px"}});l("div",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"26px",fw:"$bold",mt:"15px",ml:"0px",textAlign:"center",color:"$white500",svg:{w:"30px",h:"30px"}});l("span",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"26px",fw:"$bold",mt:"15px",ml:"10px",textAlign:"center",color:"$white500",span:{color:"#EBB309"}});const Nt=l("span",{bg:"rgba(0,0,0,0.5)",padding:"10px",w:"100%",ff:"$heading",fs:"16px",fw:"$normal",mt:"15px",textAlign:"center",color:"$white500",span:{fw:"$bold"}});async function kt(t,i){const{executeTransaction:o}=R(),a=Qt(t,i);return!!await o(a)}function Qt(t,i){return{actions:[{account:j.MISSION_CONTROL,name:"storeqp",authorization:[{actor:t.name,permission:t.authorization.permission}],data:{wallet:t.name,qp:i}}]}}const q=x.lazy(()=>E(()=>import("./quest-4c78b6cb.js"),["assets/quest-4c78b6cb.js","assets/index-2127d4ea.js","assets/index-55fec1ff.css"])),Ft=({children:t,depositRewardPoints:i,defaultRewardPointsValue:o})=>{const a=$(u=>u.user),c=$(u=>u.updateMember),[p,r]=v.useState(!1),[d,A]=v.useState(!1),h=i||o;function I(u){A(u)}async function P(){if(!(a!=null&&a.name))return null;await B(2e3);const u=await et(a==null?void 0:a.name);$.setState(D=>({...D,user:D.user?{...D.user,userTlm:u}:null})),await c(),await N(),await nt(),await at(),await ot(),await st(),await it()}async function f(){if(a){r(!0);try{if(!await kt(a,h))throw new Error("Withdrawn TLM error from contract");await P(),await B(1e3),tt.success("Successfully deposited")}catch(u){console.log(u)}finally{r(!1),A(!1)}}}return e.jsxs(bt,{onOpenChange:I,open:d,children:[e.jsx(Tt,{children:t}),e.jsx(_t,{closeType:"primary",closePosition:"inside",children:e.jsxs(Vt,{children:[e.jsx(Mt,{children:"Deposit Reward Points"}),e.jsxs(qt,{children:["You are about to spend ",h," ",e.jsx(q,{})," ",e.jsx("br",{}),"A"," ",Math.ceil(h*.1)," ",e.jsx(q,{})," fee (10%) will be applied. ",e.jsx("br",{}),"Your vault will receive ",h-Math.ceil(h*.1)," ",e.jsx(q,{})]}),e.jsx(Nt,{children:"Reward Points in your vault will not be automatically converted into TLM rewards at the end of the week and allow you to use them at a later date."}),e.jsx(m,{isLoading:p,disabled:p,onClick:f,color:"solidBlue",rounded:!1,children:"Confirm"})]})})]})},Gt={addTLM:!1,withdrawTLM:!1,claimTLM:!1,claimMines:!1,claimComms:!1,claimPay:!1,weekReward:!1},g=x.lazy(()=>E(()=>import("./info-builder-90dc80ba.js"),["assets/info-builder-90dc80ba.js","assets/index-2127d4ea.js","assets/index-55fec1ff.css"])),W=x.lazy(()=>E(()=>import("./tlm-b6d550fb.js"),["assets/tlm-b6d550fb.js","assets/index-2127d4ea.js","assets/index-55fec1ff.css"])),Ht=x.lazy(()=>E(()=>import("./star-729e45cc.js"),["assets/star-729e45cc.js","assets/index-2127d4ea.js","assets/index-55fec1ff.css"])),Ut=x.lazy(()=>E(()=>import("./quest-4c78b6cb.js"),["assets/quest-4c78b6cb.js","assets/index-2127d4ea.js","assets/index-55fec1ff.css"])),ue=()=>{var k,Q,F,G,H;const t=$(n=>n.user),i=$(n=>n.updateMember),o=mt(n=>n.weeklies);xt();const{data:a}=jt(),{data:c}=ht(),{data:p}=wt(),[r,d]=x.useState(Gt),[A,h]=x.useState(""),[I,P]=x.useState(0),f=v.useRef(null),u=o==null?void 0:o.reduce((n,s)=>{const S=((s==null?void 0:s.initial_prize_pool_formatted)??0)*((s==null?void 0:s.total_quest_points)??1)/((s==null?void 0:s.total_quest_points_week)??1);return s.week_id&&s.total_quest_points_user_week>0&&z(new Date,new Date(s==null?void 0:s.expiresDate))&&Lt(new Date,new Date((s==null?void 0:s.end_date)??""))?{total:n.total+S,weeks:[...n.weeks,s.week_id]}:{total:n.total,weeks:[...n.weeks]}},{total:0,weeks:[]});async function D(){if(t){d({...r,claimMines:!0});try{if(!await gt(t))throw new Error("Claim Mines error from contract");await y()}catch(n){console.log(n)}finally{d({...r,claimMines:!1})}}}async function rt(){if(t){d({...r,claimComms:!0});try{if(!await Dt(t))throw new Error("Claim Comms error from contract");await y()}catch(n){console.log(n)}finally{d({...r,claimComms:!1})}}}async function lt(){if(t){d({...r,claimPay:!0});try{if(!await Wt(t))throw new Error("Claim Pay error from contract");await y()}catch(n){console.log(n)}finally{d({...r,claimPay:!1})}}}async function ct(){if(t){d({...r,weekReward:!1});try{if(!await At(t,0,u.weeks))throw new Error("Week Reward error from contract");await y(),await N()}catch(n){console.log(n)}finally{d({...r,weekReward:!1})}}}async function y(){if(!(t!=null&&t.name))return null;await B(500);const n=await et(t==null?void 0:t.name);$.setState(s=>({...s,user:s.user?{...s.user,userTlm:n}:null})),await i(),await at(),await ot(),await st(),await it()}async function dt(n){if(t){d({...r,withdrawTLM:!0});try{if(!await Pt(t,n))throw new Error("Withdrawn TLM error from contract");await y()}catch(s){console.log(s)}finally{d({...r,withdrawTLM:!1})}}}async function ut(){if(!(!t||!(f!=null&&f.current))){d({...r,withdrawTLM:!0});try{if(!await Bt(t,Number(f.current.value)))throw new Error("Withdrawn TLM error from contract");await B(1e3),await y(),await N(),await nt(),f.current.value="0",tt.success("Successfully withdrawn")}catch(n){console.log(n)}finally{d({...r,withdrawTLM:!1})}}}function ft(){f!=null&&f.current&&(f.current.value=((t==null?void 0:t.score_nft)??0).toString())}const pt=n=>{const s=n.days?`${n.days}d`:"",S=n.hours?`${n.hours}h`:"",O=n.minutes?`${n.minutes}m`:"";return`${s}${S}${O}${n.seconds}s`},b=v.useMemo(()=>new Date((a==null?void 0:a.timestamp)||new Date),[a==null?void 0:a.timestamp]);return v.useEffect(()=>{var n;P(((n=t==null?void 0:t.userWeekly)==null?void 0:n.total_quest_points)??0)},[(k=t==null?void 0:t.userWeekly)==null?void 0:k.total_quest_points]),v.useEffect(()=>{const n=setInterval(()=>{const s=new Date(`${Y(b)}`),S=yt(s),O=pt(S);h(O)},1e3);return()=>clearInterval(n)},[b]),e.jsxs(Ct,{children:[e.jsxs(vt,{children:[e.jsx($t,{children:"The Vault"}),e.jsx("img",{src:"/assets/background/bg-the-vault.webp",alt:""})]}),e.jsxs(Rt,{children:[e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Deposited TLM"}),e.jsxs(L,{children:[(U((Q=t==null?void 0:t.HqMember)==null?void 0:Q.deposit)+((t==null?void 0:t.tlm_deposit)??0)/1e4).toFixed(4),e.jsx(W,{})]})]}),e.jsx(m,{rounded:!1,color:"solidBlue",isLoading:r.withdrawTLM,disabled:U((F=t==null?void 0:t.HqMember)==null?void 0:F.deposit)+((t==null?void 0:t.tlm_deposit)??0)/1e4===0,onClick:()=>dt((t==null?void 0:t.tlm_deposit)??0),children:"Withdraw"}),e.jsxs(C,{children:[e.jsx(g,{}),e.jsx(w,{children:"Deposits are currently unused"})]})]}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Alien Worlds Mining Rewards"}),e.jsxs(L,{children:[(a==null?void 0:a.amount.replace(" TLM",""))??"0.0000"," ",e.jsx(W,{})]})]}),e.jsx(m,{isLoading:r.claimMines,disabled:((a==null?void 0:a.amount)??0)===0||z(V,b),onClick:D,rounded:!1,color:"solidBlue",children:z(V,b)?A:"Claim"}),e.jsxs(C,{children:[e.jsx(g,{}),e.jsxs(w,{children:["Earned by mining in Alien Worlds",z(V,b)&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),`Available on ${new Date(`${Y(b)}.000Z`).toLocaleString()}`]})]})]})]}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Alien Worlds Land Commission"}),e.jsxs(L,{children:[(c==null?void 0:c.comms.replace(" TLM",""))??"0.0000"," ",e.jsx(W,{})]})]}),e.jsx(m,{isLoading:r.claimComms,disabled:((c==null?void 0:c.comms)??0)===0,onClick:rt,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(C,{children:[e.jsx(g,{}),e.jsx(w,{children:"Rewarded when others mine your land"})]})]}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Alien Worlds DTAL"}),e.jsxs(L,{children:[(p==null?void 0:p.payoutAmount.replace(" TLM",""))??"0.0000"," ",e.jsx(W,{})]})]}),e.jsx(m,{isLoading:r.claimPay,disabled:((p==null?void 0:p.payoutAmount)??0)===0,onClick:lt,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(C,{children:[e.jsx(g,{}),e.jsx(w,{children:"Earned daily by owning lands in Alien Worlds"})]})]}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Mission Control Weekly Rewards"}),e.jsxs(L,{children:[u.total.toFixed(4)," ",e.jsx(W,{})]})]}),e.jsx(m,{isLoading:r.weekReward,disabled:u.total===0,onClick:ct,rounded:!1,color:"solidBlue",children:"Claim"}),e.jsxs(C,{children:[e.jsx(g,{}),e.jsxs(w,{children:["Earned by playing Mission Control, costs ",e.jsx(Ht,{})," to claim"]})]})]}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(M,{children:"Reward Point Deposit"}),e.jsxs(L,{onClick:ft,children:[t==null?void 0:t.score_nft," ",e.jsx(Ut,{})]})]}),e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx(m,{isLoading:r.withdrawTLM,onClick:ut,disabled:!(t!=null&&t.isMember)||r.withdrawTLM,rounded:!1,color:"solidBlue",children:"Withdraw"}),e.jsx(Z,{dir:"rtl",type:"number",defaultValue:0,ref:f,label:""})]}),e.jsxs(K,{children:[e.jsx(Ft,{depositRewardPoints:I,defaultRewardPointsValue:((G=t==null?void 0:t.userWeekly)==null?void 0:G.total_quest_points)??0,children:e.jsx(m,{disabled:!(t!=null&&t.isMember),isLoading:r.weekReward,rounded:!1,color:"solidBlue",children:"Deposit"})}),e.jsx(Z,{dir:"rtl",type:"number",defaultValue:((H=t==null?void 0:t.userWeekly)==null?void 0:H.total_quest_points)??0,label:"",value:I,onChange:n=>P(Number(n.target.value))})]})]}),e.jsx(C,{children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsx(g,{}),e.jsx(w,{children:"Reward Points you deposited at an earlier date"})]}),e.jsxs(X,{children:[e.jsx(g,{}),e.jsx(w,{children:"Deposit Reward Points for later use. There is a 10% fee when depositing."})]})]})})]})]})]})};export{ue as default};

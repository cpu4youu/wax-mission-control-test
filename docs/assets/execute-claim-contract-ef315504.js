import{S as s}from"./index-adc1ff3a.js";import{u as r,g as u}from"./showTlmValueFromMine-0577e0d0.js";import{s as f}from"./sleep-da79c358.js";import{u as m}from"./use-transaction-f145f4c1.js";async function l(t){const{executeTransaction:a}=m(),n=r.getState().nonce;if(!(n!=null&&n.rand_str))return await u(),!1;const e=n.rand_str,i=await _(t,e);if(!await a(i,{broadcast:!0,sign:!0}))return!1;await f(500);const o=r.getState().updateNonce;return o(void 0),!0}async function _(t,a){return{actions:[{account:s.M__FEDERATION,name:"mine",authorization:[{actor:t.name,permission:"active"}],data:{miner:t.name,nonce:a,notify:"notify.mc"}}]}}async function y(t,a){if(!a)return l(t);const{executeTransaction:n}=m(),e=r.getState().nonce;if(!(e!=null&&e.rand_str))return await u(),!1;const i=e.rand_str,c=await p(t,i,a),o=await n(c,{broadcast:!0,sign:!0});if(!o)return!1;await f(500);const d=r.getState().updateNonce;return d(void 0),!!o}async function p(t,a,n){return{max_net_usage_words:5e3,actions:[{account:s.M__FEDERATION,name:"setland",authorization:[{actor:t.name,permission:"active"}],data:{account:t.name,land_id:n}},{account:s.M__FEDERATION,name:"mine",authorization:[{actor:t.name,permission:"active"}],data:{miner:t.name,nonce:a,notify:"notify.mc"}}]}}export{y as a,l as e};

import{g as N,S as m,T as U,a as W,Q as w,b as A,q as P,am as L,e as k,s,u as z,j as e,C as G,R as h,_ as S,f as l,d as O,i as Y,ad as v,h as F,n as H,B as q}from"./index-abffc04f.js";import{i as R}from"./index-ff0ab016.js";const Q=async n=>await N({options:{code:m.GAME_MC,index_position:1,limit:"10000",scope:m.GAME_MC,table:U.PLAYERS,lower_bound:n,upper_bound:n}}),$=[{label:"prodone",value:0},{label:"prodtwo",value:1},{label:"prodthree",value:2},{label:"prodfour",value:3},{label:"prodfive",value:4},{label:"prodsix",value:5}],V=()=>W({queryKey:[w.MCP_PLAYERS],queryFn:()=>J(),staleTime:1e3*60*60,enabled:!!A.getState().user});async function K(){return P.removeQueries(w.MCP_PLAYERS),await P.invalidateQueries(w.MCP_PLAYERS)}async function J(){const n=A.getState().user;if(!n)return null;try{const i=await Q(n.name);return i?Z(i):null}catch(i){return console.log(i),null}}async function Z(n){var u,p;const i=(p=(u=n==null?void 0:n[0])==null?void 0:u.buildings)==null?void 0:p.sort((c,x)=>$.findIndex(r=>r.label===c.buildingid)-$.findIndex(r=>r.label===x.buildingid)),{getAssetByAssetId:t}=L,d=await Promise.all(i.map(async c=>({...c,staked_asset_ids:await Promise.all(c.staked_asset_ids.map(async x=>{var g;const r=await t(x);return{...r,img:`https://ipfs.alienworlds.io/ipfs/${(g=r==null?void 0:r.data)==null?void 0:g.img}`}}))})));return{...n[0],buildings:d}}const X=k({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),ee=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),te=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),ne=s("h2",{d:"flex",align:"center",justify:"center",my:"40px",textAlign:"center",color:"$white500",fs:"30px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),se=s("div",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%"}),I=s("button",{d:"flex",align:"flex-start",justify:"center",padding:"10px 20px",color:"$white500",ff:"$heading",fs:"18px",variants:{isActive:{true:{fw:"bold",bg:"rgba(0, 0, 0, 0.26)"}}},"@sm":{flexWrap:"wrap"}}),ae=s("div",{d:"flex",align:"flex-start",justify:"center",gap:"0px",padding:"50px",bg:"rgba(0, 0, 0, 0.26)",w:"100%",img:{width:"100%",maxW:"510px"},"@sm":{padding:"0px",flexWrap:"wrap"}}),re=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"0px",w:"100%",button:{h:"50px",w:"300px",div:{fs:"18px",border:"none"}},"@sm":{mt:"20px"}}),ie=s("div",{d:"flex",align:"center",justify:"center",position:"relative",w:"100%",maxW:"400px",mb:"30px",color:"$white500",fs:"30px",fw:"bold",ff:"$heading",textAlign:"center",gap:"10px"}),oe=s("div",{mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",ff:"$body",gap:"10px"}),le=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",fw:"bold",ff:"$body",gap:"10px"});s("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${X} 1.2s ease-in-out infinite`});const ce=async()=>await N({options:{code:m.GAME_MC,index_position:1,reverse:!0,limit:"10000",scope:m.GAME_MC,table:U.SEASON}}),de=()=>W({queryKey:[w.SEASON],queryFn:()=>ue(),staleTime:1e3*60*60});async function ue(){try{const n=await ce();return n||null}catch(n){return console.log(n),null}}async function pe(n){const{executeTransaction:i}=z(),t=xe(n);return!!await i(t)}function xe(n){return{actions:[{account:m.GAME_MC,name:"regplayer",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name}}]}}const fe=s("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)","@sm":{padding:"0 15px"}}),ge=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),be=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),me=s("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),E=()=>e.jsxs(fe,{children:[e.jsxs(ge,{children:[e.jsx(be,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(me,{children:e.jsx(G,{size:"lg",colorSchema:"light"})})]}),we=h.lazy(()=>S(()=>import("./index-9c658fc3.js").then(n=>n.i),["assets/index-9c658fc3.js","assets/index-abffc04f.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js","assets/index-904ea3a9.js","assets/index-f1dadc25.js","assets/index-01457c46.js","assets/index-548ab8a4.js"])),he=h.lazy(()=>S(()=>import("./index-03cba720.js"),["assets/index-03cba720.js","assets/index-abffc04f.js","assets/index-55fec1ff.css","assets/info-builder-4396f526.js"])),Se=h.lazy(()=>S(()=>import("./index-3034b2a3.js"),["assets/index-3034b2a3.js","assets/index-abffc04f.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js"])),_e=h.lazy(()=>S(()=>import("./star-94b17be9.js"),["assets/star-94b17be9.js","assets/index-abffc04f.js","assets/index-55fec1ff.css"])),ye=()=>{var C,D;const{data:n,isLoading:i}=V(),{data:t}=de(),d=A(a=>a.user),[u,p]=l.useState({title:"",nextSeason:e.jsx("br",{}),disabled:!1}),[c,x]=l.useState(!1),[r,g]=l.useState("newSeason"),b=l.useCallback(()=>{var f,M;if(!(t!=null&&t[0]))return;const a=new Date,o=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());if(R(new Date(o),new Date(t[0].season_start))){const{days:_,hours:y,minutes:j,seconds:T}=O(new Date((f=t==null?void 0:t[0])==null?void 0:f.season_start));p({title:"NEW SEASON STARTING SOON",nextSeason:`Next season starting in ${_} days ${y} hours and ${j} minutes ${T} seconds`,disabled:!0});return}if(Y(new Date(o),new Date(t[0].season_end))){p({title:"WE ARE WRAPPING UP THE PREVIOUS SEASON. RETURNING NFTS, SENDING PRIZES, ....",nextSeason:e.jsx("br",{}),disabled:!0});return}if(v(new Date(o),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})){const{days:_,hours:y,minutes:j,seconds:T}=O(new Date((M=t==null?void 0:t[0])==null?void 0:M.season_end));p({title:`SEASON ENDS IN ${_} DAYS ${y} HOURS ${j} MINUTES ${T} SECONDS`,nextSeason:e.jsx("br",{}),disabled:!1});return}},[t]),B=l.useCallback(async()=>{if(d){x(!0);try{await pe(d)&&(await F(6e3),K())}catch(a){console.log(a)}finally{x(!1)}}},[d]);return l.useEffect(()=>{b()},[b]),l.useEffect(()=>{if(!(t!=null&&t[0]))return;const a=setInterval(()=>{const o=new Date,f=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());R(new Date(f),new Date(t[0].season_start))&&b(),v(new Date(f),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})&&(console.log(f),b(),n&&t&&clearInterval(a))},1e3);return()=>clearInterval(a)},[t,n,b]),i?e.jsx(E,{}):n&&t&&v(new Date(H),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})?e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(we,{season:t[0]})}):e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs(ee,{children:[e.jsx(he,{}),e.jsxs(te,{children:[e.jsx(ne,{children:u.title}),e.jsxs(se,{children:[e.jsx(I,{onClick:()=>g("newSeason"),isActive:r==="newSeason",children:"New Season"}),(C=t==null?void 0:t[0])!=null&&C.new_season_prepared||(D=t==null?void 0:t[0])!=null&&D.ranking_cleared?e.jsx(I,{onClick:()=>g("prevSeason"),isActive:r==="prevSeason",children:"Previous Season"}):""]}),e.jsx(ae,{children:r==="prevSeason"?e.jsx(Se,{}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/assets/mcp/mcp-builder.png",alt:""}),e.jsxs(re,{children:[e.jsxs(ie,{children:["WELCOME TO ",e.jsx("br",{})," OUTPOST BUILDER"]}),e.jsxs(oe,{children:["Mission Control needs YOU to help gain more resources. Build an outpost on a remote planet in this seasonal idle building game. Ramp up your production and deliver resources to Mission Control in exchange for ",e.jsx(_e,{}),".",e.jsx("br",{})," ",e.jsx("br",{}),"Who will manage to to deliver the most resources to Mission Control? Who will take up the challenge for the top of the leaderboard this season?",e.jsx("br",{})," ",e.jsx("br",{}),"Ready? Then what are you waiting for?"]}),e.jsx(le,{children:u.nextSeason}),e.jsx(q,{isLoading:c,color:"solidBlue",disabled:c||u.disabled,rounded:!1,onClick:B,children:"START NOW !"})]})]})})]})]})})},ve=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{E as L,de as a,$ as b,ve as i,K as o,V as u};

import{s as i,g as A,S as M,T as I,a as L,Q as W,b as F,R as H,f as v,j as e}from"./index-acdde9c5.js";import{m as x,c as B}from"./index-a7c9e574.js";import{b as O}from"./index.esm-7a07e219.js";import{b,u as P}from"./index-6269e430.js";import"./info-builder-1eaeb245.js";import"./index-257e3be3.js";import"./index-6da53bd2.js";import"./index-7a1571dd.js";import"./index-c9a792bc.js";import"./index-5b74fc0e.js";const Q=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),Y=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),z=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),G=i("div",{d:"flex",align:"center",justify:"center",w:"100%",maxW:"1250px",mx:"auto",my:"20px",svg:{cursor:"pointer",mr:"auto"}}),N=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1250px","@md":{d:"flex",flexWrap:"wrap"}}),q=i("h2",{color:"$white500",fs:"24px",ff:"$heading",mr:"auto"}),D=i("div",{d:"grid",gap:"5px",mt:"20px",w:"100%",maxW:"1250px"}),K=i("div",{d:"grid",gap:"5px",maxH:"555px",overflowY:"auto",w:"100%",maxW:"1250px"}),U=i("div",{d:"grid",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",w:"100%",h:"37px",maxW:"1250px",bg:"rgba(0, 0, 0, 0.27)",px:"20px",span:{d:"flex",align:"center",justify:"flex-start",color:"#797979",fs:"16px",fw:"bold",ff:"$heading"},"@sm":{gridTemplateColumns:"0.5fr repeat(4, 1fr)",gap:"5x",pl:"10px",pr:"10px",span:{fs:"12px","&:last-child":{d:"none"}}}}),C=i("button",{d:"flex",align:"center",justify:"flex-start",color:"#797979",fs:"16px",fw:"bold",ff:"$heading","&:hover":{color:"$yellow500"},variants:{selected:{true:{color:"$yellow500"}}},"@sm":{fs:"12px","&:last-child":{d:"none"}}}),J=i("div",{d:"grid",alignItems:"center",justifyContent:"center",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",minH:"55px",w:"100%",maxW:"1250px",bg:"rgba(72, 150, 222, 0.27)",pl:"20px",pr:"10px",mb:"15px",span:{d:"flex",align:"center",justify:"flex-start",color:"white",fs:"16px",fw:"bold",ff:"$heading"},"@sm":{h:"unset",gridTemplateColumns:"0.5fr repeat(4, 1fr)",gridTemplateRows:"0.8fr 2fr",gap:"5px",pl:"10px",pr:"10px",span:{fs:"12px"}}}),V=i("div",{d:"grid",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",w:"100%",maxW:"1250px",bg:"rgba(0, 0, 0, 0.27)",pl:"20px",span:{d:"flex",align:"center",justify:"flex-start",color:"#797979",fs:"16px",fw:"bold",ff:"$heading"},"@sm":{h:"unset",gridTemplateColumns:"0.5fr repeat(4, 1fr)",gridTemplateRows:"0.8fr 2fr",gap:"5px",pl:"10px",pr:"10px",span:{fs:"12px"}}}),E=i("div",{d:"flex",flexWrap:"wrap",gap:"5px",py:"5px",">span":{d:"flex",gap:"5px"},"@sm":{gridColumnStart:1,gridColumnEnd:5,align:"center",justify:"center"}}),j=i("div",{d:"flex",align:"center",justify:"center",direction:"column",img:{objectFit:"cover",br:"10px",w:"37px",h:"37px"},span:{d:"flex",align:"center",justify:"flex-start",mt:"-10px",textShadow:"-1px 0 white, 0 1px white, 1px 0 white, 0 -1px white",color:"black !important",fs:"16px",fw:"bold",ff:"$heading"}}),X=async s=>await A({options:{code:M.GAME_MC,index_position:s,key_type:"i64",limit:"100",scope:M.GAME_MC,table:I.PLAYERS,reverse:!0}}),Z=s=>L({queryKey:[W.LeaderBoard,s],queryFn:()=>ee(s),staleTime:1e3*60*60});async function ee(s){try{const c=await X(s);return c?ne(c):null}catch(c){return console.log(c),null}}async function ne(s){return s==null?void 0:s.map(c=>{var l,w,g;(l=c.buildings)==null||l.sort((r,h)=>b.findIndex(a=>a.label===r.buildingid)-b.findIndex(a=>a.label===h.buildingid));const o=(w=c.buildings)==null?void 0:w.filter(r=>r.building_type==="production"),d=(g=c.buildings)==null?void 0:g.filter(r=>r.building_type!=="production");return{...c,buildings:{production:o,special:d}}})}const xe=()=>{var T,S,$,k,y;F(n=>n.user);const{data:s,isLoading:c}=P(),[o,d]=H.useState(3),{data:l,isLoading:w}=Z(o);function g(){B.setState(n=>({...n,selectedProduction:null}))}const r=v.useMemo(()=>{var f,u,t;if(!s)return;(f=s==null?void 0:s.buildings)==null||f.sort((m,R)=>b.findIndex(_=>_.label===m.buildingid)-b.findIndex(_=>_.label===R.buildingid));const n=(u=s.buildings)==null?void 0:u.filter(m=>m.building_type==="production"),p=(t=s.buildings)==null?void 0:t.filter(m=>m.building_type!=="production");return{...s,buildings:{production:n,special:p}}},[]),h=v.useMemo(()=>!l||!s?-1:l.findIndex(n=>n.wallet===s.wallet)+1,[l,s]),a=v.useCallback(n=>{switch(n){case"mcp":d(2);break;case"score":d(3);break;case"rMin":d(4);break;default:d(3)}},[]);return e.jsxs(Q,{children:[e.jsxs(Y,{children:[e.jsx(z,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(G,{children:e.jsx(O,{onClick:g,color:"white",size:30})}),e.jsxs(N,{children:[e.jsx(q,{children:"SEASON LEADERBOARD"}),e.jsxs(D,{children:[e.jsxs(U,{children:[e.jsx("span",{children:"Rank"}),e.jsx("span",{children:"Gamertag"}),e.jsx(C,{selected:o===3,onClick:()=>a("score"),children:"ScoreðŸ†"}),e.jsx(C,{selected:o===4,onClick:()=>a("rMin"),children:"Ð¯ / min"}),e.jsx(C,{selected:o===2,onClick:()=>a("mcp"),children:"MCP earned"}),e.jsx("span",{children:"Buildings"})]}),e.jsxs(J,{children:[e.jsx("span",{children:h===0?"> 100":h}),e.jsx("span",{children:r==null?void 0:r.gamertag}),e.jsx("span",{children:x((r==null?void 0:r.score_building)||0,3)}),e.jsx("span",{children:x((r==null?void 0:r.gamecurrency_per_minute)||0,3)}),e.jsx("span",{children:x((r==null?void 0:r.score_mcp)||0,3)}),e.jsxs(E,{children:[(S=(T=r==null?void 0:r.buildings)==null?void 0:T.production)==null?void 0:S.map(n=>e.jsxs(j,{children:[e.jsx("img",{src:`/assets/mcp/${n==null?void 0:n.buildingid}.png`,alt:""}),e.jsx("span",{children:n.building_level===0?"-":n.building_level})]},n.buildingid)),e.jsx("span",{children:(k=($=r==null?void 0:r.buildings)==null?void 0:$.special)==null?void 0:k.map(n=>e.jsxs(j,{children:[e.jsx("img",{src:`/assets/mcp/${n==null?void 0:n.buildingid}.png`,alt:""}),e.jsx("span",{children:n.building_level===0?"-":n.building_level})]},n.buildingid))})]})]}),e.jsx(K,{children:(y=l==null?void 0:l.sort((n,p)=>p.score_building-n.score_building||p.gamecurrency_per_minute-n.gamecurrency_per_minute))==null?void 0:y.map((n,p)=>{var f,u;return e.jsxs(V,{children:[e.jsx("span",{children:p+1}),e.jsx("span",{children:n.gamertag}),e.jsx("span",{children:x(n.score_building,3)}),e.jsx("span",{children:x((n==null?void 0:n.gamecurrency_per_minute)||0,3)}),e.jsx("span",{children:x((n==null?void 0:n.score_mcp)||0,3)}),e.jsxs(E,{children:[(f=n.buildings.production)==null?void 0:f.map(t=>e.jsxs(j,{children:[e.jsx("img",{src:`/assets/mcp/${t==null?void 0:t.buildingid}.png`,alt:""}),e.jsx("span",{children:t.building_level===0?"-":t.building_level})]},t.buildingid)),e.jsx("span",{children:(u=n.buildings.special)==null?void 0:u.map(t=>e.jsxs(j,{children:[e.jsx("img",{src:`/assets/mcp/${t==null?void 0:t.buildingid}.png`,alt:""}),e.jsx("span",{children:t.building_level===0?"-":t.building_level})]},t.buildingid))})]})]},n.wallet)})})]})]})]})};export{xe as default};

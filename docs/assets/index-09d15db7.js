import{s as i,e as E,j as t,C as Q,g as C,S as d,T as L,a as M,q as H,Q as g,u as V,R as y,_ as w,b as m,f as c,k as N,d as Z,B as G,l as $,m as K}from"./index-a78c3883.js";const Y=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%"}),J=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0},"@md":{h:"105px",img:{h:"105px"}},"@sm":{h:"65px",img:{h:"65px"}}}),X=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.8)",w:"100%","@sm":{fs:"24px"}}),ee=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1095px","@md":{px:"30px"},"@sm":{px:"15px"}}),te=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",mt:"48px"}),se=i("h3",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",color:"$white500",fs:"32px","@sm":{fs:"24px"}}),ne=i("p",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",maxW:"811px",mt:"18px",mr:"auto",fs:"16px",fw:"$thin",ff:"$body",color:"$white500","@sm":{mt:"10px",fs:"14px"}}),re=i("div",{d:"flex",align:"center",justify:"center",direction:"column",mt:"18px",w:"100%"}),ie=i("h3",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%",color:"$white500",fs:"18px",span:{fs:"32px"},"@sm":{fs:"16px",span:{fs:"28px"}}}),ae=i("div",{d:"flex",align:"center",justify:"flex-start",gap:"15px",flexWrap:"wrap",mt:"18px",w:"100%","@sm":{gap:"5px"}}),oe=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",w:"100%",maxW:"260px",h:"325px",pb:"5px",border:"3px solid rgba(255, 255, 255, 0.4)",img:{w:"100%",h:"100%",maxH:"135px",objectFit:"cover"},">button":{fs:"18px",padding:"0px",mt:"auto",mx:"auto",w:"95%",minW:"95%",maxW:"95%",minH:"35px",div:{minH:"35px"}},variants:{isSelected:{true:{">button":{color:"black"}}}},"@sm":{maxW:"49%",">button":{fs:"14px"}}}),ce=i("div",{d:"flex",align:"center",justify:"center",position:"absolute",top:"3px",left:"10px",color:"$white500",fs:"24px",fw:"$bold",ff:"$heading",svg:{w:"45px",h:"45px",ml:"-5px"},"@sm":{fs:"16px",left:"5px",top:"0px",svg:{w:"25px",h:"25px"}}}),le=i("h4",{d:"flex",align:"center",justify:"center",direction:"column",padding:"3px 5px",color:"$white500",fs:"18px",ff:"$heading","@sm":{fs:"14px"}}),pe=i("p",{w:"100%",my:"auto",pl:"5px",color:"$white500",fs:"13px",ff:"$body",svg:{verticalAlign:"sub",w:"16px",h:"16px",my:"auto",mr:"3px"},"@sm":{fs:"12px"}}),ue=i("p",{w:"100%",pl:"5px",color:"$white500",fs:"14px",ff:"$body",span:{display:"inline-flex",align:"center",gap:"3px"},svg:{verticalAlign:"sub",w:"16px",h:"16px",mr:"3px"},"@sm":{fs:"12px"}}),de=E({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),xe=i("div",{d:"flex",w:"100%",maxW:"260px",h:"325px",background:"linear-gradient( -90deg, rgba(255,255,255, .05), rgba(255,255,255, 0.07) ,rgba(255,255,255, .05))",br:"10px",backgroundSize:"400% 400%",animation:`${de} 1.2s ease-in-out infinite`,"@sm":{h:"215px",w:"100%"}});E({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}});const me=i("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)"}),fe=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),he=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),ge=i("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),ye=()=>t.jsxs(me,{children:[t.jsxs(fe,{children:[t.jsx(he,{children:"Zapp’s Zap Emporium"}),t.jsx("img",{src:"/assets/background/bg-emporium.webp",alt:""})]}),t.jsx(ge,{children:t.jsx(Q,{size:"lg",colorSchema:"light"})})]}),we=async()=>await C({options:{code:d.EMPORIUM,index_position:1,limit:"10000",scope:d.EMPORIUM,table:L.tasks}}),_e=()=>M({queryKey:[g.Tasks],queryFn:()=>je(),staleTime:1e3*60*60});async function be(){return await H.removeQueries([g.Tasks])}async function je(){try{const r=await we();return r||[]}catch(r){return console.log(r),[]}}const Te=async()=>{const r=await C({options:{code:d.EMPORIUM,index_position:1,limit:"10000",scope:d.EMPORIUM,table:L.CONFIG}});return r?r[0]:null},Se=()=>M({queryKey:[g.TasksConfig],queryFn:()=>ve(),staleTime:1e3*60*60});async function ve(){try{return await Te()}catch(r){return console.log(r),null}}async function $e(r,p,n,a){const{executeTransaction:f}=V(),h=await Pe(r,p,n,a);return!!await f(h,{broadcast:!0,sign:!0})}async function Pe(r,p,n,a){return a==="tlm"?{actions:[{account:d.ALIEN_WORLDS,name:"transfer",authorization:[{actor:r.name,permission:r.requestPermission}],data:{from:r.name,memo:`complete task,${p}`,quantity:`${(n/1e4).toFixed(4)} TLM`,to:"emporium.mc"}}]}:{actions:[{account:d.EMPORIUM,name:"finishtask",authorization:[{actor:r.name,permission:r.requestPermission}],data:{wallet:r.name,task_id:p,currency_amount:n}}]}}const P=y.lazy(()=>w(()=>import("./shards-406bac6c.js"),["assets/shards-406bac6c.js","assets/index-a78c3883.js","assets/index-55fec1ff.css"])),k=y.lazy(()=>w(()=>import("./tlm-38633f8e.js"),["assets/tlm-38633f8e.js","assets/index-a78c3883.js","assets/index-55fec1ff.css"])),ke=y.lazy(()=>w(()=>import("./star-34f68e8c.js"),["assets/star-34f68e8c.js","assets/index-a78c3883.js","assets/index-55fec1ff.css"])),De=()=>{const{data:r,isLoading:p}=_e(),{data:n}=Se(),a=m(e=>e.user),f=m(e=>e.updateMcPoints),h=m(e=>e.updateQuestPoints),_=m(e=>e.updateTLM),[u,I]=c.useState(void 0),[D,R]=c.useState(""),[b,j]=c.useState(!1);async function U(e){if(a){j(!0);try{const s=x(e);await $e(a,e.task_id,s,e.task_type)&&(await $(1500),e.task_type==="mcp"&&await f(),e.task_type==="tlm"&&await _(),e.task_type==="qp"&&await h(),K.success("Task completed successfully"))}catch(s){console.error(s)}finally{j(!1)}}}async function W(){await $(1e3),await be()}function q(e){if(e.task_id===u){U(e);return}I(e.task_id)}const T=c.useCallback(()=>{const e=new Date(new Date().toUTCString().substring(0,25)),s=(n==null?void 0:n.progressupdate_seconds)??0,o=Math.floor(e.getTime()/1e3);return new Date((Math.floor(o/s)*s+s)*1e3)},[n==null?void 0:n.progressupdate_seconds]),S=c.useCallback(e=>{const s=e.minutes>0?`${e.minutes>9?e.minutes:`0${e.minutes}`}`:"00",o=e.seconds>9?e.seconds:`0${e.seconds}`,l=e.hours>9?e.hours:`0${e.hours}`;return e.hours>0?`${l}:${s}:${o}`:`${s}:${o}`},[]),x=c.useCallback(e=>{const s=new Date(new Date().toUTCString().substring(0,25)),o=(n==null?void 0:n.progressupdate_seconds)??0,l=(n==null?void 0:n.tick_percent_decrease)??1,z=Math.floor(s.getTime()/1e3),B=Math.floor(new Date(e==null?void 0:e.timestamp_created).getTime()/1e3)/o*o,O=(z/o*o-B)/o,F=l*-1/100;return e.currency_start*Math.pow(1+F,O)},[n==null?void 0:n.progressupdate_seconds,n==null?void 0:n.tick_percent_decrease]),v=c.useCallback(e=>{switch(e){case"qp":return t.jsx(N,{});case"mcp":return t.jsx(ke,{});case"tlm":return t.jsx(k,{});default:return t.jsx(k,{})}},[]),A=c.useCallback((e,s)=>{var o,l;return e==="mcp"?((a==null?void 0:a.mcPoints)??0)<s:e==="tlm"?(Number((o=a==null?void 0:a.userTlm)==null?void 0:o.balance)??0)<s:e==="qp"?(((l=a==null?void 0:a.userWeekly)==null?void 0:l.total_quest_points)??0)<s:!0},[a]);return c.useEffect(()=>{const e=setInterval(()=>{const s=Z(T());R(S(s)),s.minutes===0&&s.seconds===1&&W()},1e3);return()=>clearInterval(e)},[n,S,T]),t.jsx(c.Suspense,{fallback:t.jsx(ye,{}),children:t.jsxs(Y,{children:[t.jsxs(J,{children:[t.jsx(X,{children:"Zapp’s Zap Emporium"}),t.jsx("img",{src:"/assets/background/bg-emporium.webp",alt:""})]}),t.jsxs(ee,{children:[t.jsxs(te,{children:[t.jsx(se,{children:"Zapps Tasks"}),t.jsx(ne,{children:"Zapp is currently trying to advance various customer orders. Assist him in completing these tasks, and he will reward you with shards. Since he consistently dedicates time to these tasks, each one becomes easier to complete over time. However, he only requires the assistance of one player per task."})]}),t.jsxs(re,{children:[t.jsxs(ie,{children:["Next Task Progress: ",t.jsx("span",{children:D})]}),t.jsx(ae,{children:p?Array.from({length:8}).map((e,s)=>t.jsx(xe,{},s)):r==null?void 0:r.map(e=>t.jsxs(oe,{isSelected:u===e.task_id,children:[t.jsxs(ce,{children:[e.shards.toLocaleString("en-US")," ",t.jsx(P,{})]}),t.jsx("img",{src:`/assets/tasks/${e.image}.webp`}),u!==e.task_id&&t.jsx(le,{children:e.title}),u===e.task_id?t.jsxs(pe,{children:["Are you sure you want to spend"," ",t.jsxs(t.Fragment,{children:[x(e).toLocaleString("en-US"),v(e.task_type)]}),"to complete the task and gain ",e.shards.toLocaleString("en-US"),t.jsx(P,{})," ?"]}):t.jsx(ue,{children:e.description.split("[currency]").flatMap(s=>[s,t.jsxs("span",{children:[x(e).toLocaleString("en-US"),v(e.task_type)]},s)]).slice(0,-1)}),t.jsx(G,{disabled:b||A(e.task_type,x(e)),isLoading:b,onClick:()=>q(e),color:u===e.task_id?"gradientYellow":"solidBlue",noBorder:!0,rounded:!1,children:u===e.task_id?"Confirm":e.button})]},e.task_id))})]})]})]})})};export{De as default};

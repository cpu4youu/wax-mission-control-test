import{g as $,S as m,T as I,a as N,Q as w,b as A,q as D,am as W,e as B,s,u as L,j as e,C as k,R as h,_ as S,f as l,d as M,i as z,ad as v,h as G,n as Y,B as F}from"./index-7865b61a.js";import{i as P}from"./index-e680be7a.js";const H=async n=>await $({options:{code:m.GAME_MC,index_position:1,limit:"10000",scope:m.GAME_MC,table:I.PLAYERS,lower_bound:n,upper_bound:n}}),O=[{label:"prodone",value:0},{label:"prodtwo",value:1},{label:"prodthree",value:2},{label:"prodfour",value:3},{label:"prodfive",value:4},{label:"prodsix",value:5}],q=()=>N({queryKey:[w.MCP_PLAYERS],queryFn:()=>V(),staleTime:1e3*60*60,enabled:!!A.getState().user});async function Q(){return D.removeQueries(w.MCP_PLAYERS),await D.invalidateQueries(w.MCP_PLAYERS)}async function V(){const n=A.getState().user;if(!n)return null;try{const i=await H(n.name);return i?K(i):null}catch(i){return console.log(i),null}}async function K(n){var u,x;const i=(x=(u=n==null?void 0:n[0])==null?void 0:u.buildings)==null?void 0:x.sort((c,p)=>O.findIndex(r=>r.label===c.buildingid)-O.findIndex(r=>r.label===p.buildingid)),{getAssetByAssetId:t}=W,d=await Promise.all(i.map(async c=>({...c,staked_asset_ids:await Promise.all(c.staked_asset_ids.map(async p=>{var g;const r=await t(p);return{...r,img:`https://ipfs.alienworlds.io/ipfs/${(g=r==null?void 0:r.data)==null?void 0:g.img}`}}))})));return{...n[0],buildings:d}}const J=B({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Z=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),X=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),ee=s("h2",{d:"flex",align:"center",justify:"center",my:"40px",textAlign:"center",color:"$white500",fs:"30px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),te=s("div",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%"}),R=s("button",{d:"flex",align:"flex-start",justify:"center",padding:"10px 20px",color:"$white500",ff:"$heading",fs:"18px",variants:{isActive:{true:{fw:"bold",bg:"rgba(0, 0, 0, 0.26)"}}},"@sm":{flexWrap:"wrap"}}),ne=s("div",{d:"flex",align:"flex-start",justify:"center",gap:"0px",padding:"50px",bg:"rgba(0, 0, 0, 0.26)",w:"100%",img:{width:"100%",maxW:"510px"},"@sm":{padding:"0px",flexWrap:"wrap"}}),se=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"0px",w:"100%",button:{h:"50px",w:"300px",div:{fs:"18px",border:"none"}},"@sm":{mt:"20px"}}),ae=s("div",{d:"flex",align:"center",justify:"center",position:"relative",w:"100%",maxW:"400px",mb:"30px",color:"$white500",fs:"30px",fw:"bold",ff:"$heading",textAlign:"center",gap:"10px"}),re=s("div",{mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",ff:"$body",gap:"10px"}),ie=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",fw:"bold",ff:"$body",gap:"10px"});s("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${J} 1.2s ease-in-out infinite`});const oe=async()=>await $({options:{code:m.GAME_MC,index_position:1,limit:"10000",scope:m.GAME_MC,table:I.SEASON}}),le=()=>N({queryKey:[w.SEASON],queryFn:()=>ce(),staleTime:1e3*60*60});async function ce(){try{const n=await oe();return n||null}catch(n){return console.log(n),null}}async function de(n){const{executeTransaction:i}=L(),t=ue(n);return!!await i(t)}function ue(n){return{actions:[{account:m.GAME_MC,name:"regplayer",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name}}]}}const xe=s("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)","@sm":{padding:"0 15px"}}),pe=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),fe=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),ge=s("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),E=()=>e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(fe,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(ge,{children:e.jsx(k,{size:"lg",colorSchema:"light"})})]}),be=h.lazy(()=>S(()=>import("./index-7dd5ac8d.js").then(n=>n.i),["assets/index-7dd5ac8d.js","assets/index-7865b61a.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js","assets/index-ca006991.js","assets/index-e9c2bb25.js","assets/index-409b26f7.js","assets/index-31d3c211.js"])),me=h.lazy(()=>S(()=>import("./index-1c6649eb.js"),["assets/index-1c6649eb.js","assets/index-7865b61a.js","assets/index-55fec1ff.css","assets/info-builder-7c3b1436.js"])),we=h.lazy(()=>S(()=>import("./index-cedd9717.js"),["assets/index-cedd9717.js","assets/index-7865b61a.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js"])),he=h.lazy(()=>S(()=>import("./star-952485b4.js"),["assets/star-952485b4.js","assets/index-7865b61a.js","assets/index-55fec1ff.css"])),Se=()=>{const{data:n,isLoading:i}=q(),{data:t}=le(),d=A(a=>a.user),[u,x]=l.useState({title:"",nextSeason:e.jsx("br",{}),disabled:!1}),[c,p]=l.useState(!1),[r,g]=l.useState("newSeason"),b=l.useCallback(()=>{var f,C;if(!(t!=null&&t[0]))return;const a=new Date,o=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());if(P(new Date(o),new Date(t[0].season_start))){const{days:_,hours:y,minutes:j,seconds:T}=M(new Date((f=t==null?void 0:t[0])==null?void 0:f.season_start));x({title:"NEW SEASON STARTING SOON",nextSeason:`Next season starting in ${_} days ${y} hours and ${j} minutes ${T} seconds`,disabled:!0});return}if(z(new Date(o),new Date(t[0].season_end))){x({title:"WE ARE WRAPPING UP THE PREVIOUS SEASON. RETURNING NFTS, SENDING PRIZES, ....",nextSeason:e.jsx("br",{}),disabled:!0});return}if(v(new Date(o),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})){const{days:_,hours:y,minutes:j,seconds:T}=M(new Date((C=t==null?void 0:t[0])==null?void 0:C.season_end));x({title:`SEASON ENDS IN ${_} DAYS ${y} HOURS ${j} MINUTES ${T} SECONDS`,nextSeason:e.jsx("br",{}),disabled:!1});return}},[t]),U=l.useCallback(async()=>{if(d){p(!0);try{await de(d)&&(await G(6e3),Q())}catch(a){console.log(a)}finally{p(!1)}}},[d]);return l.useEffect(()=>{b()},[b]),l.useEffect(()=>{if(!(t!=null&&t[0]))return;const a=setInterval(()=>{const o=new Date,f=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());P(new Date(f),new Date(t[0].season_start))&&b(),v(new Date(f),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})&&(console.log(f),b(),n&&t&&clearInterval(a))},1e3);return()=>clearInterval(a)},[t,n,b]),i?e.jsx(E,{}):n&&t&&v(new Date(Y),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})?e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(be,{season:t[0]})}):e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs(Z,{children:[e.jsx(me,{}),e.jsxs(X,{children:[e.jsx(ee,{children:u.title}),e.jsxs(te,{children:[e.jsx(R,{onClick:()=>g("newSeason"),isActive:r==="newSeason",children:"New Season"}),e.jsx(R,{onClick:()=>g("prevSeason"),isActive:r==="prevSeason",children:"Previous Season"})]}),e.jsx(ne,{children:r==="prevSeason"?e.jsx(we,{}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/assets/mcp/mcp-builder.png",alt:""}),e.jsxs(se,{children:[e.jsxs(ae,{children:["WELCOME TO ",e.jsx("br",{})," OUTPOST BUILDER"]}),e.jsxs(re,{children:["Mission Control needs YOU to help gain more resources. Build an outpost on a remote planet in this seasonal idle building game. Ramp up your production and deliver resources to Mission Control in exchange for ",e.jsx(he,{}),".",e.jsx("br",{})," ",e.jsx("br",{}),"Who will manage to to deliver the most resources to Mission Control? Who will take up the challenge for the top of the leaderboard this season?",e.jsx("br",{})," ",e.jsx("br",{}),"Ready? Then what are you waiting for?"]}),e.jsx(ie,{children:u.nextSeason}),e.jsx(F,{isLoading:c,color:"solidBlue",disabled:c||u.disabled,rounded:!1,onClick:U,children:"START NOW !"})]})]})})]})]})})},je=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{E as L,le as a,O as b,je as i,Q as o,q as u};

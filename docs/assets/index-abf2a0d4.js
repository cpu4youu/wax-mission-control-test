import{g as R,S,T as N,a as I,Q as j,b as C,q as M,al as W,e as B,s,u as L,j as e,C as k,R as A,_ as D,f as l,d as T,i as Y,ad as v,h as z,n as F,B as G}from"./index-efe891fb.js";import{i as P}from"./index-57fd1bdd.js";const H=async n=>await R({options:{code:S.GAME_MC,index_position:1,limit:"10000",scope:S.GAME_MC,table:N.PLAYERS,lower_bound:n,upper_bound:n}}),$=[{label:"prodone",value:0},{label:"prodtwo",value:1},{label:"prodthree",value:2},{label:"prodfour",value:3},{label:"prodfive",value:4},{label:"prodsix",value:5}],q=()=>I({queryKey:[j.MCP_PLAYERS],queryFn:()=>V(),staleTime:1e3*60*60,enabled:!!C.getState().user});async function Q(){return M.removeQueries(j.MCP_PLAYERS),await M.invalidateQueries(j.MCP_PLAYERS)}async function V(){const n=C.getState().user;if(!n)return null;try{const i=await H(n.name);return i?K(i):null}catch(i){return console.log(i),null}}async function K(n){var x,c;const i=(c=(x=n==null?void 0:n[0])==null?void 0:x.buildings)==null?void 0:c.sort((d,p)=>$.findIndex(r=>r.label===d.buildingid)-$.findIndex(r=>r.label===p.buildingid)),{getAssetByAssetId:t}=W,u=await Promise.all(i.map(async d=>({...d,staked_asset_ids:await Promise.all(d.staked_asset_ids.map(async p=>{var f;const r=await t(p);return{...r,img:`https://ipfs.alienworlds.io/ipfs/${(f=r==null?void 0:r.data)==null?void 0:f.img}`}}))})));return{...n[0],buildings:u}}const J=B({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Z=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),X=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),ee=s("h2",{d:"flex",align:"center",justify:"center",my:"40px",textAlign:"center",color:"$white500",fs:"30px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),te=s("div",{d:"flex",align:"center",justify:"flex-start",gap:"10px",w:"100%"}),O=s("button",{d:"flex",align:"flex-start",justify:"center",padding:"10px 20px",color:"$white500",ff:"$heading",fs:"18px",variants:{isActive:{true:{fw:"bold",bg:"rgba(0, 0, 0, 0.26)"}}},"@sm":{flexWrap:"wrap"}}),ne=s("div",{d:"flex",align:"flex-start",justify:"center",gap:"0px",padding:"50px",bg:"rgba(0, 0, 0, 0.26)",w:"100%",img:{width:"100%",maxW:"510px"},"@sm":{flexWrap:"wrap"}}),se=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"0px",w:"100%",button:{h:"50px",w:"300px",div:{fs:"18px",border:"none"}},"@sm":{mt:"20px"}}),ae=s("div",{d:"flex",align:"center",justify:"center",position:"relative",w:"100%",maxW:"400px",mb:"30px",color:"$white500",fs:"30px",fw:"bold",ff:"$heading",textAlign:"center",gap:"10px"}),re=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",ff:"$body",gap:"10px"}),ie=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",fw:"bold",ff:"$body",gap:"10px"});s("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${J} 1.2s ease-in-out infinite`});const oe=async()=>await R({options:{code:S.GAME_MC,index_position:1,limit:"10000",scope:S.GAME_MC,table:N.SEASON}}),le=()=>I({queryKey:[j.SEASON],queryFn:()=>ce(),staleTime:1e3*60*60});async function ce(){try{const n=await oe();return n||null}catch(n){return console.log(n),null}}async function de(n){const{executeTransaction:i}=L(),t=ue(n);return!!await i(t)}function ue(n){return{actions:[{account:S.GAME_MC,name:"regplayer",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name}}]}}const xe=s("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)","@sm":{padding:"0 15px"}}),pe=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),fe=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),ge=s("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),E=()=>e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(fe,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(ge,{children:e.jsx(k,{size:"lg",colorSchema:"light"})})]}),be=A.lazy(()=>D(()=>import("./index-88d9822f.js").then(n=>n.i),["assets/index-88d9822f.js","assets/index-efe891fb.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js","assets/index-884c14e0.js","assets/index-7b828179.js","assets/index-1a5f6bbf.js","assets/index-c3f2225f.js"])),me=A.lazy(()=>D(()=>import("./index-c5142233.js"),["assets/index-c5142233.js","assets/index-efe891fb.js","assets/index-55fec1ff.css","assets/info-builder-842bc998.js"])),we=A.lazy(()=>D(()=>import("./index-b8cb112c.js"),["assets/index-b8cb112c.js","assets/index-efe891fb.js","assets/index-55fec1ff.css","assets/mcpFormatNumber-1b3dda04.js","assets/atom-1a491c74.js"])),he=()=>{const{data:n,isLoading:i}=q(),{data:t}=le(),u=C(a=>a.user),[x,c]=l.useState({title:"",nextSeason:e.jsx("br",{}),disabled:!1}),[d,p]=l.useState(!1),[r,f]=l.useState("newSeason"),y=l.useCallback(()=>{var g,b;if(!(t!=null&&t[0]))return;const a=new Date,o=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());if(P(new Date(o),new Date(t[0].season_start))){const{days:m,hours:w,minutes:h}=T(new Date((g=t==null?void 0:t[0])==null?void 0:g.season_start));c({title:"NEW SEASON STARTING SOON",nextSeason:`Next season starting in ${m} days ${w} hours and ${h} minutes`,disabled:!0});return}if(Y(new Date(o),new Date(t[0].season_end))){c({title:"WE ARE WRAPPING UP THE PREVIOUS SEASON. RETURNING NFTS, SENDING PRIZES, ....",nextSeason:e.jsx("br",{}),disabled:!0});return}if(v(new Date(o),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})){const{days:m,hours:w,minutes:h,seconds:_}=T(new Date((b=t==null?void 0:t[0])==null?void 0:b.season_end));c({title:`SEASON ENDS IN ${m} DAYS ${w} HOURS ${h} MINUTES ${_} SECONDS`,nextSeason:e.jsx("br",{}),disabled:!1});return}},[t]),U=l.useCallback(async()=>{if(u){p(!0);try{await de(u)&&(await z(6e3),Q())}catch(a){console.log(a)}finally{p(!1)}}},[u]);return l.useEffect(()=>{y()},[y]),l.useEffect(()=>{if(!(t!=null&&t[0]))return;const a=setInterval(()=>{var b;const o=new Date,g=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());if(P(new Date(g),new Date(t[0].season_start))){const{days:m,hours:w,minutes:h}=T(new Date((b=t==null?void 0:t[0])==null?void 0:b.season_start));c(_=>({..._,nextSeason:`Next season starting in ${m} days ${w} hours and ${h} minutes`})),v(new Date(g),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})&&(y(),clearInterval(a))}},1e3);return()=>clearInterval(a)},[t,y]),i?e.jsx(E,{}):n&&t&&v(new Date(F),{start:new Date(t[0].season_start),end:new Date(t[0].season_end)})?e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(be,{season:t[0]})}):e.jsx(l.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs(Z,{children:[e.jsx(me,{}),e.jsxs(X,{children:[e.jsx(ee,{children:x.title}),e.jsxs(te,{children:[e.jsx(O,{onClick:()=>f("newSeason"),isActive:r==="newSeason",children:"New Season"}),e.jsx(O,{onClick:()=>f("prevSeason"),isActive:r==="prevSeason",children:"Previous Season"})]}),e.jsx(ne,{children:r==="prevSeason"?e.jsx(we,{}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/assets/mcp/mcp-builder.png",alt:""}),e.jsxs(se,{children:[e.jsxs(ae,{children:["WELCOME TO ",e.jsx("br",{})," OUTPOST BUILDER"]}),e.jsxs(re,{children:["Mission Control needs YOU to help gain more resources. Build an outpost on a remote planet in this seasonal idle building game. Ramp up your production and deliver resources to Mission Control in exchange for McPoints.",e.jsx("br",{})," ",e.jsx("br",{}),"Who will manage to to deliver the most resources to Mission Control? Who will take up the challenge for the top of the leaderboard this season?",e.jsx("br",{})," ",e.jsx("br",{}),"Ready? Then what are you waiting for?"]}),e.jsx(ie,{children:x.nextSeason}),e.jsx(G,{isLoading:d,color:"solidBlue",disabled:d||x.disabled,rounded:!1,onClick:U,children:"START NOW !"})]})]})})]})]})})},je=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"}));export{E as L,le as a,$ as b,je as i,Q as o,q as u};

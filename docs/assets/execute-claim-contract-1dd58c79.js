import{S as r}from"./index-d022a5fa.js";import{u as c,g as u}from"./showTlmValueFromMine-691f5ea3.js";import{s as m}from"./sleep-da79c358.js";import{u as p}from"./use-transaction-0e3d8672.js";async function d(a){const{executeTransaction:n}=p(),t=c.getState().nonce;if(!(t!=null&&t.rand_str))return await u(),!1;const e=t.rand_str,i=await l(a,e);if(!await n(i,{broadcast:!0,sign:!0}))return!1;await m(500);const o=c.getState().updateNonce;return o(void 0),!0}async function l(a,n){return{actions:[{account:"cpu.mc",name:"paycpu",authorization:[{actor:"cpu.mc",permission:"cosign"}],data:{wallet:a.name,type:0}},{account:r.M__FEDERATION,name:"mine",authorization:[{actor:a.name,permission:"active"}],data:{miner:a.name,nonce:n,notify:"notify.mc"}}]}}async function N(a,n){if(!n)return d(a);const{executeTransaction:t}=p(),e=c.getState().nonce;if(!(e!=null&&e.rand_str))return await u(),!1;const i=e.rand_str,s=await _(a,i,n),o=await t(s,{broadcast:!0,sign:!0});if(!o)return!1;await m(500);const f=c.getState().updateNonce;return f(void 0),!!o}async function _(a,n,t){return{max_net_usage_words:5e3,actions:[{account:"cpu.mc",name:"paycpu",authorization:[{actor:"cpu.mc",permission:"cosign"}],data:{wallet:a.name,type:1}},{account:r.M__FEDERATION,name:"setland",authorization:[{actor:a.name,permission:"active"}],data:{account:a.name,land_id:t}},{account:r.M__FEDERATION,name:"mine",authorization:[{actor:a.name,permission:"active"}],data:{miner:a.name,nonce:n,notify:"notify.mc"}}]}}export{N as a,d as e};

import{P as ue,e as pe,s as i,k as U,S as x,T as k,l as O,Q as f,q as C,h as xe,R as w,_ as j,b as fe,r as o,j as n,B as A,m as N}from"./index-3483566a.js";import{a as H}from"./mineCooldown-321485bc.js";import{d as X}from"./use-transaction-56dfdb0d.js";import{u as ge,a as me,L as Q,o as V}from"./index-2c85516c.js";import{s as q}from"./sleep-da79c358.js";import{m}from"./mcpFormatNumber-1b3dda04.js";import{T as he}from"./index-66dd0205.js";import{s as M}from"./index-8efb2186.js";function ye(r,a){ue(2,arguments);var t=M(r),h=M(a);return t.getTime()===h.getTime()}const ee=pe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),_e=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),we=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),je=i("div",{d:"flex",align:"flex-start",justify:"flex-start",mt:"40px",w:"100%","@sm":{direction:"column"}}),Se=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",mt:"40px",w:"100%"}),be=i("div",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px",mt:"40px",w:"100%","@sm":{align:"flex-start",justify:"flex-start",order:-1}}),Ce=i("a",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px",svg:{w:"35px",h:"35px"},"@sm":{align:"center",justify:"center",order:-1}}),Te=i("div",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px","@sm":{align:"flex-start",justify:"flex-start"}}),Y=i("div",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",fw:"bold",fs:"30px",ff:"$heading",svg:{w:"35px",h:"35px"}}),K=i("h2",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",fw:"normal",fs:"16px",ff:"$heading"}),ve=i("button",{d:"flex",align:"center",justify:"center",gap:"10px",color:"#858585",fw:"normal",fs:"16px",ff:"$heading"}),Ee=i("div",{d:"flex",align:"flex-end",justify:"flex-start",gap:"10px",button:{padding:"0px",h:"35px",minH:"unset",minW:"unset",div:{px:"15px",border:"none"}},"@sm":{flexWrap:"wrap"}}),$e=i("span",{textWrap:"nowrap",color:"#72C630",fw:"bold",fs:"30px",ff:"$heading","@xsm":{fs:"24px",textWrap:"wrap"}});i("span",{color:"$white500",fs:"16px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%"});const De=i("span",{d:"flex",align:"flex-start",justify:"flex-start",color:"#72C630",fs:"16px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%"}),Le=i("div",{d:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"30px",mt:"40px",w:"100%","@md":{gridTemplateColumns:"repeat(1, 1fr)",flexWrap:"wrap"}}),Be=i("div",{d:"grid",gridTemplateRows:"50px repeat(6, 1fr)",direction:"column",gap:"5px",w:"100%"}),Z=i("h2",{color:"$white500",fs:"24px",ff:"$heading",mb:"20px"}),Me=i("div",{d:"flex",align:"center",justify:"space-between",overflow:"hidden",position:"relative",gap:"15px",padding:"0px 15px 0 0",w:"100%",bg:"#131313",br:"10px ",border:"2px solid #EDEDED",">img":{w:"110px",objectFit:"contain",cursor:"pointer"},">button":{padding:"0px",h:"50px",w:"120px",minH:"unset",minW:"unset",mb:"15px",div:{px:"15px",border:"none"}},variants:{disabled:{true:{button:{zIndex:2},">img":{zIndex:2,filter:"grayscale(100%)"},"&::after":{inset:0,content:'""',position:"absolute",bg:"#000000",opacity:.55,br:"10px 10px 0px 0px",zIndex:1}}}},"@md":{flexWrap:"wrap",padding:"5px 5px 0 5px",">img":{mb:"0px"}},"@sm":{justify:"space-between",align:"center",gap:"10px",">button":{mt:"0px",w:"100%",maxW:"unset"}},"@xxsm":{">img":{w:"50px"}}}),Pe=i("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",pb:"15px",">span":{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"16px",ff:"$heading","&:nth-child(3)":{mt:"10px",color:"#72C630"}},"@sm":{span:{fs:"14px"}}}),Ae=i("div",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",ml:"auto",pb:"15px",">span":{fw:"bold",fs:"16px",ff:"$heading",color:"#9C9C9C","&:first-child":{color:"$white500"}},"@sm":{span:{fs:"16px"}}}),Ie=i("div",{d:"flex",align:"center",justify:"center",gap:"5px",cursor:"pointer",">img":{w:"35px",objectFit:"contain"},span:{color:"$white500",fw:"bold",fs:"18px",ff:"$heading"},variants:{canStakeCard:{true:{span:{color:"#ff4141"}}}},"@sm":{span:{fs:"16px"}}}),Ue=i("div",{d:"grid",gridTemplateRows:"50px repeat(3, 1fr)",gap:"5px",w:"100%"}),ke=i("div",{d:"flex",align:"flex-start",justify:"flex-start",position:"relative",gap:"15px",bg:"#131313",br:"10px",border:"2px solid #EDEDED",w:"100%",">img":{w:"110px",h:"228px",minW:"110px",objectFit:"cover",cursor:"pointer"},variants:{disabled:{true:{button:{zIndex:2},">img":{zIndex:2,filter:"grayscale(100%)"},"&::after":{inset:0,content:'""',position:"absolute",bg:"#000000",opacity:.55,br:"10px 10px 0px 0px",zIndex:1}}}},"@sm":{d:"grid",gridTemplateAreas:`
    "img data data"
    "img button button"
    "img button button"
  `,">img":{gridArea:"img",h:"330px"}},"@xsm":{d:"grid",gridTemplateAreas:`
    "button button button"
    "img data data"
    "img data data"
  `,">img":{w:"90px",minW:"90px",h:"280px"}}}),Oe=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",span:{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"18px",ff:"$heading","&:nth-child(2)":{fs:"16px",color:"#9C9C9C"}},"@sm":{span:{fs:"16px"}}}),Re=i("div",{d:"flex",align:"flex-end",justify:"center",direction:"column",w:"100%",">span":{color:"#9C9C9C",fw:"bold",fs:"18px",ff:"$heading"}}),ze=i("div",{d:"flex",align:"center",justify:"flex-end",w:"100%",cursor:"pointer",">img":{w:"40px",objectFit:"contain"},span:{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"16px",ff:"$heading"},variants:{canStakeCard:{true:{span:{color:"#ff4141"}}}}}),Ge=i("div",{d:"flex",align:"space",justify:"flex-start",direction:"column",gap:"25px",w:"100%",mt:"25px","@sm":{gridArea:"data"}}),We=i("div",{d:"flex",align:"flex-start",justify:"space-between",gap:"5px",w:"100%","@sm":{pr:"15px"}}),Fe=i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"15px",mt:"25px",w:"50%",button:{padding:"0px",w:"120px",h:"60px",minH:"unset",minW:"unset",div:{px:"15px",border:"none"}},"@md":{gridArea:"button",w:"100%",direction:"row",flexWrap:"wrap"}}),Ne=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",color:"$white500",">button >div":{border:"2px solid rgba(255, 255, 255, 0.25)",bg:"#FF005C"},"@md":{w:"40%"}}),He=i("p",{fw:"bold",fs:"15px",ff:"$heading",color:"#BCBCBC",w:"100%","@md":{ml:"0px"}});i("div",{mt:"10px",w:"100%",height:"80px",background:"linear-gradient( -90deg, rgba(32, 16, 32, 0.40), rgba(0, 0, 0, 1) ,rgba(32, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${ee} 1.2s ease-in-out infinite`});i("div",{mt:"10px",w:"100%",height:"170px",background:"linear-gradient( -90deg, rgba(32, 16, 32, 0.40), rgba(0, 0, 0, 1) ,rgba(32, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${ee} 1.2s ease-in-out infinite`});const Qe=async()=>await U({options:{code:x.GAME_MC,index_position:1,limit:"10000",scope:x.GAME_MC,table:k.BUILDINGS}}),Ve=()=>O({queryKey:[f.BUILDING],queryFn:()=>qe(),staleTime:1e3*60*60});async function Sn(){return await C.invalidateQueries(f.BUILDING)}async function qe(){try{const r=await Qe();return r||null}catch(r){return console.log(r),null}}const I=xe((r,a)=>({selectedProduction:null,gameCurrency:0}));async function Ye(r,a){const{executeTransaction:t}=X(),h=Ke(r,a);return!!await t(h)}function Ke(r,a){return{actions:[{account:x.GAME_MC,name:"upgbuilding",authorization:[{actor:r.name,permission:r.authorization.permission}],data:{wallet:r.name,buildingid:a}}]}}async function Ze(r){const{executeTransaction:a}=X(),t=Je(r);return!!await a(t)}function Je(r){return{actions:[{account:x.GAME_MC,name:"faucet",authorization:[{actor:r.name,permission:r.authorization.permission}],data:{wallet:r.name}}]}}const Xe=async()=>await U({options:{code:x.GAME_MC,index_position:1,limit:"1000",scope:x.GAME_MC,table:k.SETTINGS}}),en=()=>O({queryKey:[f.SETTINGS],queryFn:()=>tn(),staleTime:1e3*60*60});async function nn(){return C.removeQueries(f.SETTINGS),await C.invalidateQueries(f.SETTINGS)}async function tn(){try{const r=await Xe();return r?r[0]:null}catch(r){return console.log(r),null}}const sn=async()=>await U({options:{code:x.GAME_MC,index_position:1,limit:"10000",scope:x.GAME_MC,table:k.SWAPPOOL}}),rn=()=>O({queryKey:[f.SWAPPOOL],queryFn:()=>an(),staleTime:1e3*60*60});async function bn(){return C.removeQueries(f.SWAPPOOL),await C.invalidateQueries(f.SWAPPOOL)}async function an(){try{const r=await sn();return r||null}catch(r){return console.log(r),null}}const on=w.lazy(()=>j(()=>import("./star-a7c950af.js"),["assets/star-a7c950af.js","assets/index-3483566a.js","assets/index-55fec1ff.css"])),cn=w.lazy(()=>j(()=>import("./atom-9bd323f2.js"),["assets/atom-9bd323f2.js","assets/index-3483566a.js","assets/index-55fec1ff.css"])),ln=w.lazy(()=>j(()=>import("./leaderboard-4c1bbdea.js"),["assets/leaderboard-4c1bbdea.js","assets/index-3483566a.js","assets/index-55fec1ff.css"])),J={days:0,hours:0,minutes:0,seconds:0},dn=w.lazy(()=>j(()=>import("./index-536fa814.js"),["assets/index-536fa814.js","assets/index-3483566a.js","assets/index-55fec1ff.css","assets/index-2c85516c.js","assets/user-miners-query-8ff34682.js","assets/axios-43b00e28.js","assets/mineCooldown-321485bc.js","assets/index-d52efe8c.js","assets/index-045edd8f.js","assets/use-transaction-56dfdb0d.js","assets/sleep-da79c358.js","assets/index-d7f5ebb2.js","assets/index.esm-bb028b82.js","assets/iconBase-4606e050.js","assets/inventory-query-15cd5e11.js","assets/mcpFormatNumber-1b3dda04.js","assets/index-b541e4ef.js","assets/index.esm-330023e6.js","assets/index-6a2e4e49.js","assets/index-b08e0854.js","assets/index-9e55efa7.js","assets/index-66dd0205.js","assets/index-fd291b24.js","assets/use-media-5527e23a.js","assets/index-8efb2186.js"])),un=w.lazy(()=>j(()=>import("./index-5552940f.js"),["assets/index-5552940f.js","assets/index-3483566a.js","assets/index-55fec1ff.css","assets/index.esm-bb028b82.js","assets/iconBase-4606e050.js","assets/index-2c85516c.js","assets/user-miners-query-8ff34682.js","assets/axios-43b00e28.js","assets/mineCooldown-321485bc.js","assets/index-d52efe8c.js","assets/index-045edd8f.js","assets/use-transaction-56dfdb0d.js","assets/sleep-da79c358.js","assets/index-d7f5ebb2.js","assets/mcpFormatNumber-1b3dda04.js","assets/index-66dd0205.js","assets/index-b08e0854.js","assets/index-fd291b24.js","assets/use-media-5527e23a.js","assets/index-8efb2186.js"])),pn=w.lazy(()=>j(()=>import("./index-3ecbbd64.js"),["assets/index-3ecbbd64.js","assets/index-3483566a.js","assets/index-55fec1ff.css"])),xn=({season:r})=>{var G,W;const a=fe(e=>e.user),{data:t,isLoading:h}=ge(),{data:T}=Ve(),{data:c,isLoading:ne}=en();rn();const{data:u}=me(),v=I(e=>e.selectedProduction),[y,E]=o.useState(!1),[_,te]=o.useState(0),[l,se]=o.useState(J),[P,ie]=o.useState(J),[$,re]=o.useState({production:[],special:[]});async function ae(){if(a){E(!0);try{await Ze(a)&&(await q(1500),await V(),await nn(),N.success("Exploder used successfully"))}catch(e){console.log(e)}finally{E(!1)}}}async function R(e){if(!(!a||!e)){E(!0);try{await Ye(a,e)&&(await q(2e3),V(),N.success("Upgrade successful"))}catch(s){console.log(s)}finally{E(!1)}}}function D(e){I.setState({selectedProduction:e})}function oe(){I.setState({selectedProduction:{buildingid:"leaderBoard"}})}const ce=()=>{const e=(((t==null?void 0:t.max_gamecurrency)||0)-_)/((t==null?void 0:t.gamecurrency_per_minute)||1)*60;let s={days:0,hours:0,minutes:0,seconds:0};e>0&&(s={days:Math.floor(e/(60*60)/24),hours:Math.floor(e/(60*60)),minutes:Math.floor(e/60%60),seconds:Math.floor(e%60)});const d=s.minutes>0?`${s.minutes>9?s.minutes:`0${s.minutes}`}`:"00",g=s.seconds>9?s.seconds:`0${s.seconds}`,p=s.hours>0?s.hours:`0${s.hours}`;return s.hours>0?`${p}:${d}:${g}`:`${d}:${g}`},L=o.useCallback(()=>{const e=$.special.find(s=>s.buildingid==="faucet");e&&se(H(new Date(new Date((e==null?void 0:e.last_interaction)??0).getTime()+((c==null?void 0:c.seconds_mine_cd)??0)*1e3)))},[$.special,c==null?void 0:c.seconds_mine_cd]),le=o.useCallback(()=>{const e=l.minutes>0?`${l.minutes>9?l.minutes:`0${l.minutes}`}`:"00",s=l.seconds>9?l.seconds:`0${l.seconds}`;return`${e}:${s}`},[l]),z=o.useCallback(()=>{const e=new Date,s=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),d=new Date((t==null?void 0:t.last_claim)??"").getTime()/1e3,p=s.getTime()/1e3-d,S=Number((t==null?void 0:t.gamecurrency)??0),b=Number((t==null?void 0:t.gamecurrency_per_minute)??0)/60,B=Number((t==null?void 0:t.max_gamecurrency)??0),F=S+p*b;return F>B?B:F},[t]),de=o.useCallback(e=>{const s=new Date,d=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds()),g=M(new Date(e.last_interaction)),p=M(d);return ye(g,p)?e.todays_interactions:0},[]);return o.useEffect(()=>{if(!t)return;let e={production:[],special:[]};t==null||t.buildings.forEach(s=>{if(s.building_type==="production"){e={...e,production:[...e.production,s]};return}e={...e,special:[...e.special,{...s,isSpecial:!0}]}}),re(e)},[t]),o.useEffect(()=>{const e=setInterval(()=>{te(z()),ie(H(new Date(r.season_end))),L()},1e3);return()=>{clearInterval(e)}},[r.season_end,z,L]),o.useEffect(()=>{L()},[L]),(v==null?void 0:v.buildingid)==="leaderBoard"?n.jsx(o.Suspense,{fallback:n.jsx(Q,{}),children:n.jsx(un,{})}):v?n.jsx(o.Suspense,{fallback:n.jsx(Q,{}),children:n.jsx(dn,{gamecurecy:_})}):n.jsxs(_e,{children:[n.jsx(pn,{}),n.jsxs(we,{children:[n.jsxs(je,{children:[n.jsxs(Se,{children:[n.jsxs(K,{children:["SEASON ENDS IN ",P.days," DAYS ",P.hours," HOURS ",P.minutes," MINUTES"]}),n.jsx(Ee,{children:n.jsx(he,{delayDuration:10,text:`${ce()} remaining until the storage is full`,children:n.jsxs($e,{children:["Я ",m(_,3)," / ",m((t==null?void 0:t.max_gamecurrency)||0,3)]})})}),n.jsxs(De,{children:["per minute: ",m((t==null?void 0:t.gamecurrency_per_minute)||0,3)]})]}),n.jsxs(be,{children:[n.jsx(K,{children:(((G=u==null?void 0:u[0])==null?void 0:G.season_mcp_rewards)||0)>0&&"SEASON PRIZE POOL"}),n.jsx(Te,{children:(((W=u==null?void 0:u[0])==null?void 0:W.season_mcp_rewards)||0)>0?n.jsxs(n.Fragment,{children:[n.jsxs(Y,{children:[25e4.toLocaleString("en-US")," ",n.jsx(cn,{color:"#EBB309"})]}),n.jsxs(Y,{children:[((u==null?void 0:u[0].season_mcp_rewards)??0).toLocaleString("en-US")," ",n.jsx(on,{})]})]}):n.jsx(Ce,{href:"https://medium.com/mining-matters/outpost-building-game-99ce21da1744",target:"_blank",children:"What is the Outpost Builder?"})}),n.jsxs(ve,{onClick:oe,children:["LEADERBOARD",n.jsx(ln,{})]})]})]}),n.jsxs(Le,{children:[n.jsxs(Be,{children:[n.jsx(Z,{children:"PRODUCTION BUILDINGS"}),$.production.map(e=>{const s=!(e.building_level>0),d=_<e.gamecurrency_upgrade_cost;return n.jsxs(Me,{disabled:s,children:[n.jsx("img",{onClick:()=>D(e),src:`/assets/mcp/${e==null?void 0:e.buildingid}.png`,alt:""}),n.jsxs(Pe,{children:[n.jsx("span",{children:e.building_name}),n.jsxs("span",{children:["Level ",e.building_level]}),n.jsxs("span",{children:["Я ",m(e.gamecurrency_per_minute_boosted,3),"/min"]})]}),n.jsxs(Ae,{children:[n.jsxs(Ie,{onClick:()=>D(e),canStakeCard:e.unlocked_slots>e.staked_template_ids.length,children:[n.jsxs("span",{children:[e.staked_template_ids.length,"/",e.unlocked_slots]}),n.jsx("img",{src:"/assets/default-card.png",alt:""})]}),n.jsxs("span",{children:["Я ",m(e.gamecurrency_upgrade_cost,3)]})]}),n.jsx(A,{isLoading:y,disabled:y||d,onClick:()=>R(e==null?void 0:e.buildingid),color:"solidBlue",rounded:!1,children:s?"BUILD":"UPGRADE"})]},e.buildingid)})]}),n.jsxs(Ue,{children:[n.jsx(Z,{children:"SPECIAL BUILDINGS"}),$.special.map(e=>{const s=T==null?void 0:T.find(B=>B.buildingid===e.buildingid),d=!(e.building_level>0),g=_<e.gamecurrency_upgrade_cost,p=e.building_level*((t==null?void 0:t.gamecurrency_per_minute)||0)+e.building_level*((t==null?void 0:t.gamecurrency_per_minute)||0)*(e.nft_bonuspercent/100),S=p>100?p:100,b=de(e);return n.jsxs(ke,{disabled:d,children:[n.jsx("img",{onClick:()=>D(e),src:`/assets/mcp/${e.buildingid}.png`,alt:""}),n.jsxs(Ge,{children:[n.jsxs(We,{children:[n.jsxs(Oe,{children:[n.jsx("span",{children:e.building_name}),n.jsxs("span",{children:["Level ",e.building_level]})]}),n.jsxs(Re,{children:[n.jsxs(ze,{onClick:()=>D(e),canStakeCard:e.unlocked_slots>e.staked_template_ids.length,children:[n.jsx("img",{src:"/assets/default-card.png",alt:""}),n.jsxs("span",{children:[e.staked_template_ids.length,"/",e.unlocked_slots]})]}),n.jsxs("span",{children:["Я ",m(e.gamecurrency_upgrade_cost,3)]})]})]}),n.jsx(He,{children:e.buildingid==="faucet"?`Use up to 10 times per day. Using it now would grant  ${m(b===0?(t==null?void 0:t.gamecurrency_per_minute)===0?100:S*5:S,3)} Я. Amount based on your Я per minute and Exploder level.`:s==null?void 0:s.building_description})]}),n.jsxs(Fe,{children:[n.jsx(A,{isLoading:y,disabled:y||g,onClick:()=>R(e==null?void 0:e.buildingid),color:"solidBlue",rounded:!1,children:d?"BUILD":"UPGRADE"}),e.buildingid==="faucet"&&n.jsxs(Ne,{children:[n.jsxs(A,{isLoading:y||h||ne,disabled:y||d||_===((t==null?void 0:t.max_gamecurrency)||0)||b===(c==null?void 0:c.manual_mines_per_day)||l.minutes!==0||l.seconds!==0,onClick:ae,color:"solidBlue",rounded:!1,children:["Use (",b,"/",c==null?void 0:c.manual_mines_per_day,")"]}),(l.minutes!==0||l.seconds!==0)&&le()]})]})]},e.buildingid)})]})]})]})]})},Cn=Object.freeze(Object.defineProperty({__proto__:null,default:xn},Symbol.toStringTag,{value:"Module"}));export{rn as a,en as b,I as c,bn as d,Ye as e,Sn as f,Cn as i,nn as o,Ve as u};

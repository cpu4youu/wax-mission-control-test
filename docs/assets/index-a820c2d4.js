import{r as q,s as O,e as oe,a as i,g as M,S as x,T as k,u as $,Q as f,q as y,c as ce,b as V,j as n,R as Z,_ as K,d as le,f as de,h as pe,i as o,k as U,L as W,l as ue,B,m as z,o as N,n as G}from"./index-eb60d4d1.js";function xe(s,r){q(2,arguments);var t=O(s),d=O(r);return t.getTime()===d.getTime()}function fe(s){return q(1,arguments),xe(s,Date.now())}const Y=oe({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),ge=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),me=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),he=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),we=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),ye=i("div",{d:"flex",align:"flex-start",justify:"flex-start",mt:"40px",w:"100%","@sm":{direction:"column"}}),Ce=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",mt:"40px",w:"100%"}),je=i("div",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px",mt:"40px",w:"100%","@sm":{align:"flex-start",justify:"flex-start",order:-1}}),_e=i("a",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px",w:"100%","@sm":{align:"flex-start",justify:"flex-start",order:-1}}),be=i("div",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",fw:"bold",fs:"30px",ff:"$heading",svg:{w:"35px",h:"35px"}}),H=i("h2",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",fw:"normal",fs:"16px",ff:"$heading"}),Se=i("button",{d:"flex",align:"center",justify:"center",gap:"10px",color:"#858585",fw:"normal",fs:"16px",ff:"$heading"}),ve=i("div",{d:"flex",align:"flex-end",justify:"flex-start",gap:"10px",button:{padding:"0px",h:"35px",minH:"unset",minW:"unset",div:{px:"15px",border:"none"}},"@sm":{flexWrap:"wrap"}}),Te=i("span",{textWrap:"nowrap",color:"#72C630",fw:"bold",fs:"30px",ff:"$heading","@xsm":{fs:"24px",textWrap:"wrap"}});i("span",{color:"$white500",fs:"16px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%"});const Le=i("span",{d:"flex",align:"flex-start",justify:"flex-start",color:"#72C630",fs:"16px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%"}),Be=i("div",{d:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"30px",mt:"40px",w:"100%","@md":{gridTemplateColumns:"repeat(1, 1fr)",flexWrap:"wrap"}}),Ee=i("div",{d:"grid",gridTemplateRows:"50px repeat(6, 1fr)",direction:"column",gap:"5px",w:"100%"}),F=i("h2",{color:"$white500",fs:"24px",ff:"$heading",mb:"20px"}),Me=i("div",{d:"flex",align:"center",justify:"space-between",overflow:"hidden",position:"relative",gap:"15px",padding:"0px 15px 0 0",w:"100%",bg:"#131313",br:"10px ",border:"2px solid #EDEDED",">img":{w:"110px",objectFit:"contain",cursor:"pointer"},">button":{padding:"0px",h:"50px",w:"120px",minH:"unset",minW:"unset",mb:"15px",div:{px:"15px",border:"none"}},variants:{disabled:{true:{button:{zIndex:2},">img":{zIndex:2,filter:"grayscale(100%)"},"&::after":{inset:0,content:'""',position:"absolute",bg:"#000000",opacity:.55,br:"10px 10px 0px 0px",zIndex:1}}}},"@md":{flexWrap:"wrap",padding:"5px 5px 0 5px",">img":{mb:"0px"}},"@sm":{justify:"space-between",align:"center",gap:"10px",">button":{mt:"0px",w:"100%",maxW:"unset"}},"@xxsm":{">img":{w:"50px"}}}),ke=i("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",pb:"15px",">span":{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"16px",ff:"$heading","&:nth-child(3)":{mt:"10px",color:"#72C630"}},"@sm":{span:{fs:"14px"}}}),$e=i("div",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",ml:"auto",pb:"15px",">span":{fw:"bold",fs:"16px",ff:"$heading",color:"#9C9C9C","&:first-child":{color:"$white500"}},"@sm":{span:{fs:"16px"}}}),De=i("div",{d:"flex",align:"center",justify:"center",gap:"5px",cursor:"pointer",">img":{w:"35px",objectFit:"contain"},span:{color:"$white500",fw:"bold",fs:"18px",ff:"$heading"},variants:{canStakeCard:{true:{span:{color:"#ff4141"}}}},"@sm":{span:{fs:"16px"}}}),Pe=i("div",{d:"grid",gridTemplateRows:"50px repeat(3, 1fr)",gap:"5px",w:"100%"}),Ie=i("div",{d:"flex",align:"flex-start",justify:"flex-start",position:"relative",gap:"15px",bg:"#131313",br:"10px",border:"2px solid #EDEDED",w:"100%",">img":{w:"110px",h:"228px",minW:"110px",objectFit:"cover",cursor:"pointer"},variants:{disabled:{true:{button:{zIndex:2},">img":{zIndex:2,filter:"grayscale(100%)"},"&::after":{inset:0,content:'""',position:"absolute",bg:"#000000",opacity:.55,br:"10px 10px 0px 0px",zIndex:1}}}},"@sm":{d:"grid",gridTemplateAreas:`
    "img data data"
    "img button button"
    "img button button"
  `,">img":{gridArea:"img",h:"330px"}},"@xsm":{d:"grid",gridTemplateAreas:`
    "button button button"
    "img data data"
    "img data data"
  `,">img":{w:"90px",minW:"90px",h:"280px"}}}),Ae=i("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",span:{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"18px",ff:"$heading","&:nth-child(2)":{fs:"16px",color:"#9C9C9C"}},"@sm":{span:{fs:"16px"}}}),Re=i("div",{d:"flex",align:"flex-end",justify:"center",direction:"column",w:"100%",">span":{color:"#9C9C9C",fw:"bold",fs:"18px",ff:"$heading"}}),Oe=i("div",{d:"flex",align:"center",justify:"flex-end",w:"100%",cursor:"pointer",">img":{w:"40px",objectFit:"contain"},span:{textTransform:"capitalize",color:"$white500",fw:"bold",fs:"16px",ff:"$heading"},variants:{canStakeCard:{true:{span:{color:"#ff4141"}}}}}),Ue=i("div",{d:"flex",align:"space",justify:"flex-start",direction:"column",gap:"25px",w:"100%",mt:"25px","@sm":{gridArea:"data"}}),We=i("div",{d:"flex",align:"flex-start",justify:"space-between",gap:"5px",w:"100%","@sm":{pr:"15px"}}),ze=i("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"15px",mt:"25px",w:"50%",button:{padding:"0px",w:"120px",h:"60px",minH:"unset",minW:"unset",div:{px:"15px",border:"none"}},"@md":{gridArea:"button",w:"100%",direction:"row",flexWrap:"wrap"}}),Ne=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",color:"$white500",">button >div > span":{m:"auto",svg:{w:"17px",h:"15px"}},"@md":{w:"40%"}}),Ge=i("p",{fw:"bold",fs:"16px",ff:"$heading",color:"#BCBCBC",w:"100%","@md":{ml:"0px"}});i("div",{mt:"10px",w:"100%",height:"80px",background:"linear-gradient( -90deg, rgba(32, 16, 32, 0.40), rgba(0, 0, 0, 1) ,rgba(32, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${Y} 1.2s ease-in-out infinite`});i("div",{mt:"10px",w:"100%",height:"170px",background:"linear-gradient( -90deg, rgba(32, 16, 32, 0.40), rgba(0, 0, 0, 1) ,rgba(32, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${Y} 1.2s ease-in-out infinite`});const He=async()=>await M({options:{code:x.GAME_MC,index_position:1,limit:"10000",scope:x.GAME_MC,table:k.BUILDINGS}}),Fe=()=>$({queryKey:[f.BUILDING],queryFn:()=>Qe(),staleTime:1e3*60*60});async function pn(){return await y.invalidateQueries(f.BUILDING)}async function Qe(){try{const s=await He();return s||null}catch(s){return console.log(s),null}}const E=ce((s,r)=>({selectedProduction:null,gameCurrency:0}));async function qe(s,r){const{executeTransaction:t}=V(),d=Ve(s,r);return!!await t(d)}function Ve(s,r){return{actions:[{account:x.GAME_MC,name:"upgbuilding",authorization:[{actor:s.name,permission:s.requestPermission}],data:{wallet:s.name,buildingid:r}}]}}async function Ze(s){const{executeTransaction:r}=V(),t=Ke(s);return!!await r(t)}function Ke(s){return{actions:[{account:x.GAME_MC,name:"faucet",authorization:[{actor:s.name,permission:s.requestPermission}],data:{wallet:s.name}}]}}const Ye=async()=>await M({options:{code:x.GAME_MC,index_position:1,limit:"1000",scope:x.GAME_MC,table:k.SETTINGS}}),Je=()=>$({queryKey:[f.SETTINGS],queryFn:()=>en(),staleTime:1e3*60*60});async function Xe(){return y.removeQueries(f.SETTINGS),await y.invalidateQueries(f.SETTINGS)}async function en(){try{const s=await Ye();return s?s[0]:null}catch(s){return console.log(s),null}}function w(s,r=1){const t=["","","k","M","B","T"];let d=0,u=s;for(;u>=1e3&&d<t.length-1;)u/=1e3,d++;return`${s>999?u.toFixed(r).replace(".",","):Math.floor(s)} ${t[d]}`}const nn=async()=>await M({options:{code:x.GAME_MC,index_position:1,limit:"10000",scope:x.GAME_MC,table:k.SWAPPOOL}}),tn=()=>$({queryKey:[f.SWAPPOOL],queryFn:()=>sn(),staleTime:1e3*60*60});async function un(){return y.removeQueries(f.SWAPPOOL),await y.invalidateQueries(f.SWAPPOOL)}async function sn(){try{const s=await nn();return s||null}catch(s){return console.log(s),null}}const an=()=>n.jsxs("svg",{className:"feather feather-info",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10"}),n.jsx("line",{x1:"12",x2:"12",y1:"16",y2:"12"}),n.jsx("line",{x1:"12",x2:"12.01",y1:"8",y2:"8"})]}),rn=()=>n.jsx("svg",{width:"21",height:"17",viewBox:"0 0 21 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.1376 0.633025C19.3025 0.611658 19.4701 0.637386 19.621 0.707238C19.7717 0.777785 19.8991 0.889833 19.9884 1.03024C20.0777 1.17065 20.1251 1.3336 20.125 1.49999V13.75C20.125 14.4462 19.8484 15.1139 19.3562 15.6061C18.8639 16.0984 18.1962 16.375 17.5 16.375H3.5C2.80381 16.375 2.13613 16.0984 1.64384 15.6061C1.15156 15.1139 0.875 14.4462 0.875 13.75V1.49999C0.875062 1.33373 0.922493 1.17092 1.01174 1.03064C1.10098 0.890362 1.22835 0.778411 1.37892 0.7079C1.52949 0.637389 1.69703 0.611237 1.86193 0.632504C2.02682 0.653772 2.18225 0.72158 2.31 0.827988L6.874 4.63161L9.81663 0.956613C9.90171 0.858984 10.0067 0.780721 10.1246 0.727092C10.2425 0.673463 10.3705 0.645714 10.5 0.645714C10.6295 0.645714 10.7575 0.673463 10.8754 0.727092C10.9933 0.780721 11.0983 0.858984 11.1834 0.956613L14.126 4.63161L18.6891 0.827988C18.8172 0.721984 18.9727 0.654392 19.1376 0.633025ZM18.1187 14.3687C18.2828 14.2046 18.375 13.9821 18.375 13.75V12.875H2.625V13.75C2.625 13.9821 2.71719 14.2046 2.88128 14.3687C3.04538 14.5328 3.26794 14.625 3.5 14.625H17.5C17.7321 14.625 17.9546 14.5328 18.1187 14.3687ZM2.625 3.36811V11.125H18.375V3.36811L14.5609 6.54611C14.4715 6.62077 14.3681 6.67683 14.2567 6.71101C14.1454 6.74518 14.0283 6.75678 13.9124 6.74513C13.7966 6.73347 13.6842 6.6988 13.5819 6.64314C13.4795 6.58748 13.3894 6.51195 13.3166 6.42099L10.5 2.89999L7.68338 6.42186C7.61069 6.51266 7.52064 6.58806 7.41847 6.64365C7.31631 6.69924 7.20409 6.7339 7.08838 6.74561C6.97251 6.75766 6.8554 6.74629 6.74401 6.71216C6.63263 6.67804 6.52924 6.62187 6.44 6.54699L2.625 3.36811ZM8.75 7.62499H12.25C12.4821 7.62499 12.7046 7.71718 12.8687 7.88127C13.0328 8.04536 13.125 8.26792 13.125 8.49999C13.125 8.73205 13.0328 8.95461 12.8687 9.11871C12.7046 9.2828 12.4821 9.37499 12.25 9.37499H8.75C8.51794 9.37499 8.29538 9.2828 8.13128 9.11871C7.96719 8.95461 7.875 8.73205 7.875 8.49999C7.875 8.26792 7.96719 8.04536 8.13128 7.88127C8.29538 7.71718 8.51794 7.62499 8.75 7.62499Z",fill:"#858585"})}),Q={days:0,hours:0,minutes:0,seconds:0},on=Z.lazy(()=>K(()=>import("./index-4b032e56.js"),["assets/index-4b032e56.js","assets/index-eb60d4d1.js","assets/index-55fec1ff.css"])),cn=Z.lazy(()=>K(()=>import("./index-f344dfb9.js"),["assets/index-f344dfb9.js","assets/index-eb60d4d1.js","assets/index-55fec1ff.css"])),ln=({season:s})=>{var I,A;const r=le(e=>e.user),{data:t,isLoading:d}=de(),{data:u}=Fe(),{data:c,isLoading:J}=Je();tn();const{data:p}=pe(),C=E(e=>e.selectedProduction),X=o.useRef(0),[h,j]=o.useState(!1),[g,ee]=o.useState(0),[l,ne]=o.useState(Q),[L,te]=o.useState(Q),[_,se]=o.useState({production:[],special:[]});async function ie(){if(r){j(!0);try{await Ze(r)&&(await z(1500),await N(),await Xe(),G.success("Exploder used successfully"))}catch(e){console.log(e)}finally{j(!1)}}}async function D(e){if(!(!r||!e)){j(!0);try{await qe(r,e)&&(await z(2e3),N(),G.success("Upgrade successful"))}catch(a){console.log(a)}finally{j(!1)}}}function b(e){E.setState({selectedProduction:e})}function ae(){E.setState({selectedProduction:{buildingid:"leaderBoard"}})}const S=o.useCallback(()=>{const e=_.special.find(a=>a.buildingid==="faucet");e&&ne(U(new Date(new Date((e==null?void 0:e.last_interaction)??0).getTime()+((c==null?void 0:c.seconds_mine_cd)??0)*1e3)))},[_.special,c==null?void 0:c.seconds_mine_cd]),re=o.useCallback(()=>{const e=l.minutes>0?`${l.minutes>9?l.minutes:`0${l.minutes}`}`:"00",a=l.seconds>9?l.seconds:`0${l.seconds}`;return`${e}:${a}`},[l]),P=o.useCallback(()=>{const e=new Date,a=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),m=new Date((t==null?void 0:t.last_claim)??"").getTime()/1e3,v=a.getTime()/1e3-m,T=((t==null?void 0:t.gamecurrency)??0)+v*(((t==null?void 0:t.gamecurrency_per_minute)??0)/60);return T>((t==null?void 0:t.max_gamecurrency)||0)?(t==null?void 0:t.max_gamecurrency)||0:T},[t]);return o.useEffect(()=>{if(!t)return;let e={production:[],special:[]};t==null||t.buildings.forEach(a=>{if(a.building_type==="production"){e={...e,production:[...e.production,a]};return}e={...e,special:[...e.special,{...a,isSpecial:!0}]}}),se(e)},[t]),o.useEffect(()=>{const e=setInterval(()=>{ee(P()),te(U(new Date(s.season_end))),S()},1e3);return()=>{clearInterval(e)}},[s.season_end,P,S]),o.useEffect(()=>{X.current=g},[g]),o.useEffect(()=>{S()},[S]),(C==null?void 0:C.buildingid)==="leaderBoard"?n.jsx(o.Suspense,{fallback:n.jsx(W,{}),children:n.jsx(cn,{})}):C?n.jsx(o.Suspense,{fallback:n.jsx(W,{}),children:n.jsx(on,{gamecurecy:g})}):n.jsxs(ge,{children:[n.jsxs(me,{children:[n.jsx(he,{children:"Outpost Builder"}),n.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),n.jsxs(we,{children:[n.jsxs(ye,{children:[n.jsxs(Ce,{children:[n.jsxs(H,{children:["SEASON ENDS IN ",L.days," DAYS ",L.hours," HOURS ",L.minutes," MINUTES"]}),n.jsx(ve,{children:n.jsxs(Te,{children:["Я ",w(g,3)," / ",w((t==null?void 0:t.max_gamecurrency)||0,3)]})}),n.jsxs(Le,{children:["per minute: ",w((t==null?void 0:t.gamecurrency_per_minute)||0,3)]})]}),n.jsxs(je,{children:[n.jsxs(_e,{href:"https://medium.com/mining-matters/outpost-building-game-99ce21da1744",target:"_blank",children:[n.jsxs(H,{children:[(((I=p==null?void 0:p[0])==null?void 0:I.season_mcp_rewards)||0)>0&&"SEASON PRIZE POOL",n.jsx(an,{})]}),n.jsx(be,{children:(((A=p==null?void 0:p[0])==null?void 0:A.season_mcp_rewards)||0)>0?n.jsxs(n.Fragment,{children:[p==null?void 0:p[0].season_mcp_rewards.toLocaleString("en-US")," ",n.jsx(ue,{})]}):"What is the Outpost Builder?"})]}),n.jsxs(Se,{onClick:ae,children:["LEADERBOARD",n.jsx(rn,{})]})]})]}),n.jsxs(Be,{children:[n.jsxs(Ee,{children:[n.jsx(F,{children:"PRODUCTION BUILDINGS"}),_.production.map(e=>{const a=!(e.building_level>0),m=g<e.gamecurrency_upgrade_cost;return n.jsxs(Me,{disabled:a,children:[n.jsx("img",{onClick:()=>b(e),src:`/assets/mcp/${e==null?void 0:e.buildingid}.png`,alt:""}),n.jsxs(ke,{children:[n.jsx("span",{children:e.building_name}),n.jsxs("span",{children:["Level ",e.building_level]}),n.jsxs("span",{children:["Я ",w(e.gamecurrency_per_minute_boosted,3),"/min"]})]}),n.jsxs($e,{children:[n.jsxs(De,{onClick:()=>b(e),canStakeCard:e.unlocked_slots>e.staked_template_ids.length,children:[n.jsxs("span",{children:[e.staked_template_ids.length,"/",e.unlocked_slots]}),n.jsx("img",{src:"/assets/default-card.png",alt:""})]}),n.jsxs("span",{children:["Я ",w(e.gamecurrency_upgrade_cost,3)]})]}),n.jsx(B,{isLoading:h,disabled:h||m,onClick:()=>D(e==null?void 0:e.buildingid),color:"eleventh",rounded:!1,children:a?"BUILD":"UPGRADE"})]},e.buildingid)})]}),n.jsxs(Pe,{children:[n.jsx(F,{children:"SPECIAL BUILDINGS"}),_.special.map(e=>{const a=u==null?void 0:u.find(T=>T.buildingid===e.buildingid),m=!(e.building_level>0),R=g<e.gamecurrency_upgrade_cost,v=fe(new Date(e.last_interaction))?e.todays_interactions:0;return n.jsxs(Ie,{disabled:m,children:[n.jsx("img",{onClick:()=>b(e),src:`/assets/mcp/${e.buildingid}.png`,alt:""}),n.jsxs(Ue,{children:[n.jsxs(We,{children:[n.jsxs(Ae,{children:[n.jsx("span",{children:e.building_name}),n.jsxs("span",{children:["Level ",e.building_level]})]}),n.jsxs(Re,{children:[n.jsxs(Oe,{onClick:()=>b(e),canStakeCard:e.unlocked_slots>e.staked_template_ids.length,children:[n.jsx("img",{src:"/assets/default-card.png",alt:""}),n.jsxs("span",{children:[e.staked_template_ids.length,"/",e.unlocked_slots]})]}),n.jsxs("span",{children:["Я ",w(e.gamecurrency_upgrade_cost,3)]})]})]}),n.jsx(Ge,{children:a==null?void 0:a.building_description})]}),n.jsxs(ze,{children:[n.jsx(B,{isLoading:h,disabled:h||R,onClick:()=>D(e==null?void 0:e.buildingid),color:"eleventh",rounded:!1,children:m?"BUILD":"UPGRADE"}),e.buildingid==="faucet"&&n.jsxs(Ne,{children:[n.jsxs(B,{isLoading:h||d||J,disabled:h||m||g===((t==null?void 0:t.max_gamecurrency)||0)||v===(c==null?void 0:c.manual_mines_per_day)||l.minutes!==0||l.seconds!==0,onClick:ie,color:"eleventh",rounded:!1,children:["Use (",v,"/",c==null?void 0:c.manual_mines_per_day,")"]}),(l.minutes!==0||l.seconds!==0)&&re()]})]})]},e.buildingid)})]})]})]})]})},xn=Object.freeze(Object.defineProperty({__proto__:null,default:ln},Symbol.toStringTag,{value:"Module"}));export{tn as a,Je as b,E as c,un as d,qe as e,pn as f,xn as i,w as m,Xe as o,Fe as u};

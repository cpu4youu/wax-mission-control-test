import{s as i,g as R,S as M,T as A,a as I,Q as L,b as W,R as y,f as _,j as e}from"./index-9794b69c.js";import{m as d,c as F}from"./index-0dcb5b0d.js";import{b as B}from"./index.esm-a3c365a4.js";import{b as j,u as H}from"./index-15abe5c0.js";import"./info-builder-98b3ac58.js";import"./index-ef852a9d.js";import"./index-26b5ecf8.js";import"./index-087c3034.js";import"./index-80b4175a.js";const O=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),P=i("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),Q=i("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Y=i("div",{d:"flex",align:"center",justify:"center",w:"100%",maxW:"1250px",mx:"auto",my:"20px",svg:{cursor:"pointer",mr:"auto"}}),z=i("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1250px","@md":{d:"flex",flexWrap:"wrap"}}),G=i("h2",{color:"$white500",fs:"24px",ff:"$heading",mr:"auto"}),N=i("div",{d:"grid",gap:"5px",mt:"20px",w:"100%",maxW:"1250px"}),q=i("div",{d:"grid",gap:"5px",maxH:"555px",overflowY:"auto",w:"100%",maxW:"1250px"}),D=i("div",{d:"grid",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",w:"100%",h:"37px",maxW:"1250px",bg:"rgba(0, 0, 0, 0.27)",px:"20px","span, button":{d:"flex",align:"center",justify:"flex-start",color:"#797979",fs:"16px",fw:"bold",ff:"$heading"},"button:hover":{color:"$yellow500"},"@sm":{gridTemplateColumns:"0.5fr repeat(3, 1fr)",gap:"10px",span:{fs:"12px","&:last-child":{d:"none"}}}}),K=i("div",{d:"grid",alignItems:"center",justifyContent:"center",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",minH:"55px",w:"100%",maxW:"1250px",bg:"rgba(72, 150, 222, 0.27)",pl:"20px",pr:"10px",mb:"15px",span:{d:"flex",align:"center",justify:"flex-start",color:"white",fs:"16px",fw:"bold",ff:"$heading"},"@sm":{h:"unset",gridTemplateColumns:"0.5fr repeat(3, 1fr)",gridTemplateRows:"0.8fr 2fr",gap:"10px",span:{fs:"12px"}}}),U=i("div",{d:"grid",gridTemplateColumns:"0.5fr repeat(4, 1fr) 3fr",gap:"10px",w:"100%",maxW:"1250px",bg:"rgba(0, 0, 0, 0.27)",pl:"20px",span:{d:"flex",align:"center",justify:"flex-start",color:"#797979",fs:"16px",fw:"bold",ff:"$heading"},"@sm":{h:"unset",gridTemplateColumns:"0.5fr repeat(3, 1fr)",gridTemplateRows:"0.8fr 2fr",gap:"10px",span:{fs:"12px"}}}),$=i("div",{d:"flex",flexWrap:"wrap",gap:"5px",py:"5px",">span":{d:"flex",gap:"5px"},"@sm":{gridColumnStart:1,gridColumnEnd:5,align:"center",justify:"center"}}),h=i("div",{d:"flex",align:"center",justify:"center",direction:"column",img:{objectFit:"cover",br:"10px",w:"37px",h:"37px"},span:{d:"flex",align:"center",justify:"flex-start",mt:"-10px",textShadow:"-1px 0 white, 0 1px white, 1px 0 white, 0 -1px white",color:"black !important",fs:"16px",fw:"bold",ff:"$heading"}}),J=async r=>await R({options:{code:M.GAME_MC,index_position:r,key_type:"i64",limit:"100",scope:M.GAME_MC,table:A.PLAYERS,reverse:!0}}),V=r=>I({queryKey:[L.LeaderBoard,r],queryFn:()=>X(r),staleTime:1e3*60*60});async function X(r){try{const o=await J(r);return o?Z(o):null}catch(o){return console.log(o),null}}async function Z(r){return r==null?void 0:r.map(o=>{var c,b,m;(c=o.buildings)==null||c.sort((s,g)=>j.findIndex(l=>l.label===s.buildingid)-j.findIndex(l=>l.label===g.buildingid));const u=(b=o.buildings)==null?void 0:b.filter(s=>s.building_type==="production"),a=(m=o.buildings)==null?void 0:m.filter(s=>s.building_type!=="production");return{...o,buildings:{production:u,special:a}}})}const ae=()=>{var C,T,S,k;W(n=>n.user);const{data:r,isLoading:o}=H(),[u,a]=y.useState(3),{data:c,isLoading:b}=V(u);function m(){F.setState(n=>({...n,selectedProduction:null}))}const s=_.useMemo(()=>{var p,x,t;if(!r)return;(p=r==null?void 0:r.buildings)==null||p.sort((f,E)=>j.findIndex(v=>v.label===f.buildingid)-j.findIndex(v=>v.label===E.buildingid));const n=(x=r.buildings)==null?void 0:x.filter(f=>f.building_type==="production"),w=(t=r.buildings)==null?void 0:t.filter(f=>f.building_type!=="production");return{...r,buildings:{production:n,special:w}}},[]),g=_.useMemo(()=>!c||!r?-1:c.findIndex(n=>n.wallet===r.wallet)+1,[c,r]),l=_.useCallback(n=>{switch(n){case"mcp":a(1);break;case"score":a(2);break;case"rMin":a(3);break;default:a(3)}},[]);return console.log(s),e.jsxs(O,{children:[e.jsxs(P,{children:[e.jsx(Q,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(Y,{children:e.jsx(B,{onClick:m,color:"white",size:30})}),e.jsxs(z,{children:[e.jsx(G,{children:"SEASON LEADERBOARD"}),e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx("span",{children:"Rank"}),e.jsx("span",{children:"Gamertag"}),e.jsx("button",{onClick:()=>l("score"),children:"Building Score"}),e.jsx("button",{onClick:()=>l("rMin"),children:"Ð¯ / min"}),e.jsx("button",{onClick:()=>l("mcp"),children:"MCP earned"}),e.jsx("span",{children:"Buildings"})]}),e.jsxs(K,{children:[e.jsx("span",{children:g===0?"> 100":g}),e.jsx("span",{children:s==null?void 0:s.gamertag}),e.jsx("span",{children:d((s==null?void 0:s.score_building)||0)}),e.jsx("span",{children:d((s==null?void 0:s.gamecurrency_per_minute)||0,3)}),e.jsx("span",{children:d((s==null?void 0:s.score_mcp)||0,3)}),e.jsxs($,{children:[(T=(C=s==null?void 0:s.buildings)==null?void 0:C.production)==null?void 0:T.map(n=>e.jsxs(h,{children:[e.jsx("img",{src:`/assets/mcp/${n==null?void 0:n.buildingid}.png`,alt:""}),e.jsx("span",{children:n.building_level===0?"-":n.building_level})]},n.buildingid)),e.jsx("span",{children:(k=(S=s==null?void 0:s.buildings)==null?void 0:S.special)==null?void 0:k.map(n=>e.jsxs(h,{children:[e.jsx("img",{src:`/assets/mcp/${n==null?void 0:n.buildingid}.png`,alt:""}),e.jsx("span",{children:n.building_level===0?"-":n.building_level})]},n.buildingid))})]})]}),e.jsx(q,{children:c==null?void 0:c.map((n,w)=>{var p,x;return e.jsxs(U,{children:[e.jsx("span",{children:w+1}),e.jsx("span",{children:n.gamertag}),e.jsx("span",{children:d(n.score_building,3)}),e.jsx("span",{children:d((n==null?void 0:n.gamecurrency_per_minute)||0,3)}),e.jsx("span",{children:d((n==null?void 0:n.score_mcp)||0,3)}),e.jsxs($,{children:[(p=n.buildings.production)==null?void 0:p.map(t=>e.jsxs(h,{children:[e.jsx("img",{src:`/assets/mcp/${t==null?void 0:t.buildingid}.png`,alt:""}),e.jsx("span",{children:t.building_level===0?"-":t.building_level})]},t.buildingid)),e.jsx("span",{children:(x=n.buildings.special)==null?void 0:x.map(t=>e.jsxs(h,{children:[e.jsx("img",{src:`/assets/mcp/${t==null?void 0:t.buildingid}.png`,alt:""}),e.jsx("span",{children:t.building_level===0?"-":t.building_level})]},t.buildingid))})]})]},n.wallet)})})]})]})]})};export{ae as default};

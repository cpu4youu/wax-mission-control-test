import{e as ee,s as styled,c as create,S as SMART_CONTRACTS,u as useTransaction,r as rpc,T as TABLES,g as getTable,a as useQuery,Q as QUERY_KEYS,b as useAuthStore,q as queryClient,i as isBefore,d as calculateTimeLeft,f as isAfter,h as reactExports,j as jsxRuntimeExports,B as Button,k as sleep,l as Q,R as React,_ as __vitePreload,m as useMedia,n as QuestSVG,I as IMAGE_URL,v as v4,G as GenIcon,o as onRefetchUserWeekly}from"./index-e35bb2ad.js";import{B as BiLockAlt,H as HiMiniArrowLeftCircle}from"./index.esm-d1d9180e.js";import{u as useInventoryUnlocksQuery}from"./inventory-query-3131e9d2.js";import{D as Dialog,a as DialogTrigger,b as DialogContent}from"./index-f51bc244.js";import{I as InformationSvgBuilder}from"./info-builder-4ffbee50.js";import"./index-43533084.js";import"./index-1a55952d.js";const shimmer$1=ee({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Wrapper$4=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px"}),Title$4=styled("h2",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%",mt:"60px","@sm":{mt:"0px",fs:"26px"}}),InfoLink=styled("a",{d:"flex",align:"flex-end",justify:"flex-end",direction:"column",gap:"5px",svg:{w:"35px",h:"35px"},"@sm":{align:"flex-start",justify:"flex-start"}}),Tab=styled("div",{d:"flex",align:"center",justify:"center",gap:"20px",w:"100%",mt:"20px",position:"relative",">svg":{position:"absolute",left:"0px",cursor:"pointer"},"@sm":{">svg":{top:"-55px",left:"10px"}}}),TabButton=styled("button",{d:"flex",align:"center",justify:"center",color:"$white500",ff:"$heading",fs:"26px",fw:"700",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",variants:{isActive:{true:{color:"$yellow500"}}},"@sm":{fs:"16px"}}),Loading=styled("div",{mt:"30px",w:"100%",height:"450px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${shimmer$1} 1.2s ease-in-out infinite`}),Content$4=styled("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",mt:"30px",w:"100%","@md":{direction:"column",padding:"0 10px"}}),Wrapper$3=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",padding:"0 5px 15px 0",w:"100%",maxW:"1190px"});styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",w:"100%",h:"calc(100vh - 380px)",pr:"5px",overflow:"auto"});const EmptyContainer$2=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px",color:"$white500",ff:"$heading",fs:"36px",fw:"bold",textAlign:"center",w:"100%",maxW:"1190px",minH:"450px"}),Container$2=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px",w:"100%",maxW:"1190px",">button":{d:"none"},"@md":{position:"relative",align:"center",justify:"center",padding:"10px 5px",">button":{d:"flex"}}}),Expire$3=styled("div",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",ff:"$heading",fs:"16px","@sm":{m:"5px auto 0",textAlign:"center",fs:"10px"}}),Header$3=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",">button ":{fs:"18px","> div":{h:"50px"}},"@md":{zIndex:1,direction:"column",">button ":{d:"none"}}}),HeaderContent$3=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column","@md":{w:"100%",h:"155px"}}),Title$3=styled("h2",{d:"flex",align:"flex-start",justify:"flex-start",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@md":{my:"10px"},"@sm":{align:"center",justify:"center",my:"0px",order:-1,textAlign:"center",fs:"20px"}}),Data$2=styled("div",{d:"flex",align:"center",justify:"center",gap:"10px",span:{d:"flex",align:"center",justify:"center",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",color:"$white500",ff:"$heading",fs:"16px",svg:{ml:"5px"}},"@sm":{gap:"0px",direction:"column",mt:"auto",">span":{justify:"flex-start",w:"100%",fs:"12px"}}}),Content$3=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",mt:"30px"}),ImageContainer$2=styled("div",{position:"relative",overflow:"hidden",minWidth:"382px",height:"249px",img:{br:"10px",width:"382px",height:"249px",objectFit:"cover"},"@md":{position:"absolute",minWidth:"100%",width:"100%",h:"170px",top:0,left:0,img:{width:"100%",h:"170px",position:"absolute"}}}),ImgFlag$3=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",zIndex:"1",w:"300px",padding:"0 0 5px",position:"absolute",right:"-90px",top:"40px",transform:"rotate(45deg)",bg:"#65B5FF",color:"$white500",ff:"$heading",span:{fw:"$bold",fs:"20px"},p:{fs:"16px"},"@md":{transform:"rotate(315deg)",w:"210px",top:"115px",right:"-70px",span:{pt:"5px",fs:"12px"},p:{fs:"8px"}}}),ContentData=styled("div",{d:"flex",align:"center",justify:"space-between",direction:"column",flexWrap:"wrap",gap:"5px",maxH:"320px",w:"100%","@sm":{d:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"5px",mb:"10px"}}),Mod$1=styled("div",{d:"flex",align:"center",justify:"space-between",padding:"10px 15px",w:"350px",br:"9px",border:"0px solid #FFF",color:"$white500",variants:{firstFive:{true:{background:"linear-gradient(90deg, #1B1B1B 0%, rgba(0, 0, 0, 0.00) 100%)"},false:{background:"linear-gradient(270deg, #1B1B1B 0%, rgba(0, 0, 0, 0.00) 100%)"}},lock:{true:{"@sm":{background:"linear-gradient(90deg, #4B4B4B96 0%, #53535396 100%) !important"}},false:{"@sm":{background:"linear-gradient(90deg, #1B1B1B 0%, #000 100%) !important"}}}},"@sm":{justify:"center",w:"100%",height:"47px",padding:"5px"},"@xsm":{width:"53px"}}),ModValue$1=styled("span",{ff:"$heading",fs:"16px","@sm":{display:"none"}}),ModType$1=styled("div",{d:"flex",align:"flex-end",justify:"center",direction:"column",span:{ff:"$heading",textAlign:"right"},variants:{firstFive:{true:{align:"flex-start",order:-1,">span":{textAlign:"left"},"@sm":{align:"center"}}}},"@sm":{align:"center",width:"53px",height:"47px"}}),AffType$1=styled("span",{ff:"$heading",fs:"10px",fw:"bold","@sm":{mb:"4px",fs:"15px"},"@xsm":{fs:"8px"}}),AffValue$1=styled("span",{ff:"$heading",fs:"16px",textAlign:"center","@sm":{fs:"12px"},"@xsm":{fs:"6px"}}),useAdventuresStore=create((r,t)=>({advTemplate:void 0,updateAdvTemplate:o=>onUpdateAdvTemplate(r,o),advActives:{available:[],claimable:[]},updateAdvActives:o=>onUpdateAdvActives(r,o),selectedAdventure:void 0,updateSelectedAdventure:o=>onUpdateSelectedAdventure(r,o)}));function onUpdateAdvTemplate(r,t){r(o=>({...o,advTemplate:t}))}function onUpdateAdvActives(r,t){r(o=>({...o,advActives:t}))}function onUpdateSelectedAdventure(r,t){r(o=>({...o,selectedAdventure:t}))}const shimmer=ee({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Wrapper$2=styled("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",maxW:"1190px",br:"10px",background:"rgba(3, 16, 32, 0.95)",">button button":{mt:"20px",h:"50px",fs:"22px"},"@sm":{">button button":{my:"10px"}}}),Header$2=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",position:"relative",overflow:"hidden",direction:"column",w:"100%",minH:"300px",br:"10px",img:{br:"10px 10px 0 0",mt:"-120px",objectFit:"cover",w:"100%",height:"294px",inset:"0"},"@sm":{position:"relative",minH:"initial",img:{mt:"-170px",h:"170px"}}}),ImgFlag$2=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",zIndex:"1",w:"450px",padding:"0 0 10px",position:"absolute",right:"-105px",top:"65px",transform:"rotate(45deg)",bg:"#65B5FF",color:"$white500",ff:"$heading",span:{fw:"$bold",fs:"33px"},p:{fs:"21px"},"@sm":{transform:"rotate(315deg)",w:"210px",top:"100px",right:"-65px",span:{pt:"5px",fs:"12px"},p:{fs:"8px"}}}),HeaderData=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",zIndex:"1",padding:"20px",p:{d:"flex",align:"center",justify:"center",color:"$white500",ff:"$heading",fs:"16px",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",svg:{ml:"5px"}},"@sm":{mt:"80px",p:{fs:"10px"}}}),HeaderContent$2=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",padding:"10px 20px","@sm":{align:"center",justify:"center",position:"absolute",padding:"5px 10px",w:"100%"}}),Expire$2=styled("span",{color:"$white500",ff:"$heading",fs:"16px",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)","@sm":{order:1,textAlign:"center",fs:"10px"}}),Title$2=styled("h2",{color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{textAlign:"center",fs:"20px"}}),Description=styled("span",{color:"$white500",ff:"$heading",fs:"16px",padding:"0 20px 20px","@sm":{padding:"10px",fs:"12px",textAlign:"center"}}),Content$2=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",padding:"0 20px",mt:"100px","@xlg":{flexWrap:"wrap"},"@sm":{padding:"0px",mt:"0px",direction:"column"},"@xsm":{}});styled("div",{d:"flex",align:"center",justify:"space-between",direction:"column",gap:"5px",w:"100%",maxW:"550px"});const ModsContainer=styled("div",{d:"flex",align:"center",justify:"space-between",direction:"column",w:"290px",gap:"5px",color:"$white500","@sm":{w:"100%",mt:"5px",px:"4px",direction:"row"}}),Mod=styled("div",{d:"flex",align:"center",justify:"flex-start",padding:"10px 15px",w:"290px",br:"9px",border:"0px solid #FFF",color:"$white500",variants:{lock:{true:{"@sm":{background:"linear-gradient(90deg, #4B4B4B96 0%, #53535396 100%)"}},false:{"@sm":{background:"linear-gradient(90deg, #1B1B1B 0%, #000 100%)"}}},firstFive:{true:{"@media(min-width: 768px)":{background:"linear-gradient(90deg, #1B1B1B 0%, rgba(0, 0, 0, 0.00) 100%)"}},false:{"@media(min-width: 768px)":{background:"linear-gradient(270deg, #1B1B1B 0%, rgba(0, 0, 0, 0.00) 100%)"}}},leftSelected:{true:{background:"linear-gradient(90deg, #019D8A 0%, rgba(1, 120, 157, 0.00) 100%)","@sm":{background:"linear-gradient(180deg, #019D8A 0%, rgba(1, 120, 157, 0.00) 100%)"}}},rightSelected:{true:{background:"linear-gradient(270deg, #019D8A 0%, rgba(1, 120, 157, 0.00) 100%)","@sm":{background:"linear-gradient(0deg, #019D8A 0%, rgba(1, 120, 157, 0.00) 100%)"}}}},"@sm":{direction:"column",justify:"center",width:"100%",height:"47px",padding:"5px"}}),ButtonFilter=styled("button",{variants:{isSelected:{true:{svg:{fill:"#EBB309"}}}},"@sm":{order:-1,svg:{width:"15px",height:"15px"}}}),ModValue=styled("span",{ff:"$heading",fs:"16px","@sm":{order:1,fs:"8px",ml:"0px !important",mr:"0px !important"}}),ModType=styled("div",{d:"flex",align:"flex-end",justify:"center",direction:"column",">span":{ff:"$heading",textAlign:"right"},variants:{firstFive:{true:{align:"flex-start",order:-1,">span":{textAlign:"left"},"@sm":{align:"center",">span":{textAlign:"center"}}}}},"@sm":{align:"center",justify:"flex-start",">span":{textAlign:"center"}}}),AffType=styled("span",{ff:"$heading",fs:"10px",fw:"bold","@sm":{mb:"1px",fs:"8px"}}),AffValue=styled("span",{ff:"$heading",fs:"16px",textAlign:"center","@sm":{fs:"6px"}}),MainContent=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@xlg":{order:1}}),Tabs=styled("div",{d:"flex",align:"center",justify:"center",gap:"20px",mb:"20px","@sm":{m:"20px 0 0px",gap:"10px"}}),ButtonTabs=styled("button",{d:"flex",align:"center",justify:"center",fs:"20px",ff:"$heading",fw:"$bold",color:"$white500",variants:{isSelected:{true:{textUnderlineOffset:"0.5em",textDecoration:"underline"}}},"@sm":{fs:"10px"}}),CardsContainer$2=styled("div",{d:"flex",align:"flex-start",justify:"center",variants:{isInventoryOpen:{true:{flexWrap:"wrap",width:"100%",maxH:"525px",gap:"5px",overflowY:"auto"},false:{img:{"&:hover":{transform:"scale(1.05)",zIndex:"4"},"&:nth-of-type(1)":{transform:"translate(60px,20px) rotate(-20deg)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(60px,20px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"translate(-60px,20px) rotate(20deg)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(-60px,20px) rotate(20deg)",zIndex:"4"}}},"@sm":{img:{transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.05)",zIndex:"4"},"&:nth-of-type(1)":{transform:" rotate(-20deg) translate(0px,15px)",zIndex:"3","&:hover":{transform:"scale(1.05) translate(0px,15px) rotate(-20deg)",zIndex:"4"}},"&:nth-of-type(3)":{transform:"rotate(20deg) translate(0px,15px)",zIndex:"1","&:hover":{transform:"scale(1.05) translate(0px,15px) rotate(20deg)",zIndex:"4"}}}}}}},"@sm":{gap:"20px",mt:"20px"}}),CardImage=styled("img",{cursor:"pointer",transition:"all 0.2s ease-in-out",width:"174px",height:"259px",zIndex:"2","@sm":{width:"110px",height:"150px"},"@xsm":{width:"70px",height:"100px"}}),CardLoading=styled("div",{width:"174px",height:"259px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.25) ,rgba(255, 255, 255, 0.15))",br:"10px",backgroundSize:"400% 400%",animation:`${shimmer} 1.2s ease-in-out infinite`,"@sm":{width:"70px",height:"100px"}}),Total=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",mt:"40px",span:{ff:"$heading",fs:"28px",color:"$green500","&:first-child":{color:"$white500",fs:"24px"}},"@sm":{mt:"20px",span:{fs:"18px","&:first-child":{fs:"14px"}}}}),FooterDescription=styled("span",{color:"$white500",padding:"20px",ff:"$heading",fs:"16px","@sm":{padding:"0px 10px 20px",textAlign:"center",fs:"10px"}});async function executeStartAdventureContract({user:r,adventureid:t,assets_ids:o}){const a=buildTransaction$1(r,t,o),{executeTransaction:d}=useTransaction();return!!await d(a)}function buildTransaction$1(r,t,o){const a={actions:[]};return o.length>0?(a.actions.push({account:"atomicassets",name:"transfer",authorization:[{actor:r.name,permission:r.requestPermission}],data:{from:r.name,to:"adventure.mc",memo:`mcadventure,${t}`,asset_ids:o}}),a):(a.actions.push({account:SMART_CONTRACTS.ADVENTURE_MC,name:"joinadv",authorization:[{actor:r.name,permission:r.requestPermission}],data:{wallet:r.name,adventureid:t}}),a)}const getAdventuresTable=async()=>{let r=!1,t;const o=[];for(;!r;){const a=await rpc.get_table_rows({code:SMART_CONTRACTS.ADVENTURE_MC,index_position:1,reverse:!0,limit:"10000",scope:SMART_CONTRACTS.ADVENTURE_MC,table:TABLES.ADVENTURES,upper_bound:t});r=!a.more,o.push(...a.rows.slice(0,-1)),t=a.next_key}return o},getParticipantsTable=async r=>await getTable({options:{code:SMART_CONTRACTS.ADVENTURE_MC,index_position:3,key_type:"i64",limit:"1000",lower_bound:r,upper_bound:r,scope:SMART_CONTRACTS.ADVENTURE_MC,table:TABLES.PARTICIPANTS}}),getLevelUnlocksTable=async()=>await getTable({options:{code:SMART_CONTRACTS.ADVENTURE_MC,index_position:1,limit:"1000",scope:SMART_CONTRACTS.ADVENTURE_MC,table:TABLES.LEVEL_UNLOCKS}});function getCurrentUTDate(){const r=new Date;return new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds())}const useAdventureQuery=()=>useQuery({queryKey:[QUERY_KEYS.ADVENTURES],queryFn:()=>onFetch$1(),staleTime:1e3*60*60,enabled:!!useAuthStore.getState().user&&!!queryClient.getQueryData(QUERY_KEYS.ADV_TEMPLATES)});async function onRefetchAdventure(){return queryClient.removeQueries([QUERY_KEYS.ADVENTURES]),await queryClient.invalidateQueries([QUERY_KEYS.ADVENTURES])}async function onFetch$1(){try{const r=await getAdventuresTable(),t=queryClient.getQueryData(QUERY_KEYS.ADV_TEMPLATES),o=useAuthStore.getState().user;if(!r||!o||!t)return{available:null,participants:null,claimable:null};const a=formattedTemplateData$1(t),d=useAdventuresStore.getState().updateAdvTemplate;d(a);const p=await getParticipantsTable(o==null?void 0:o.name),x=await formateAdvData(r,o,p);if(!p)return{available:x,participants:null,claimable:null};const n=formateParticipantData("participants",p,r,a),c=formateParticipantData("claimable",p,r,a);return{available:x,participants:n,claimable:c}}catch(r){return console.log(r),null}}async function formateAdvData(r,t,o){const a=await getLevelUnlocksTable();return r.filter(d=>isBefore(getCurrentUTDate(),new Date((d==null?void 0:d.enter_end)??""))).filter(d=>!(o!=null&&o.some(p=>d.adventureid===p.adventureid))).map(d=>{var p;return{...d,mods:(p=d.mods)==null?void 0:p.map((x,n)=>{var c,s;return(((c=a==null?void 0:a[n])==null?void 0:c.level)??1)>((t==null?void 0:t.level)??1)?{...x,lock:!0,level_to_unlock:((s=a==null?void 0:a[n])==null?void 0:s.level)??1}:{...x,lock:!1}}),formatted_enter_end:calculateTimeLeft(new Date((d==null?void 0:d.enter_end)??""))}})}function formattedTemplateData$1(r){return r.map(t=>({...t,"nft.mp":t.nft_mp,"tlm.mp":t.tlm_mp}))}function formateParticipantData(r,t,o,a){var d,p,x;return r==="participants"?(p=(d=t==null?void 0:t.filter(n=>isBefore(getCurrentUTDate(),new Date((n==null?void 0:n.return_date)??""))))==null?void 0:d.sort((n,c)=>+new Date(n.return_date??"")-+new Date(c.return_date??"")))==null?void 0:p.map(n=>{var f;const c=o==null?void 0:o.find(l=>l.adventureid===n.adventureid),s=(f=n==null?void 0:n.template_ids)==null?void 0:f.map(l=>a==null?void 0:a.find(y=>y.templateid===l));return{...c,...n,cards:s,formatted_return:calculateTimeLeft(new Date((n==null?void 0:n.return_date)??""))}}):(x=t==null?void 0:t.filter(n=>isAfter(getCurrentUTDate(),new Date((n==null?void 0:n.return_date)??""))))==null?void 0:x.map(n=>{var f;const c=o==null?void 0:o.find(l=>l.adventureid===n.adventureid),s=(f=n==null?void 0:n.template_ids)==null?void 0:f.map(l=>a==null?void 0:a.find(y=>y.templateid===l));return{...c,...n,cards:s}})}const ShowMore=styled("span",{color:"$white500",fw:"$bold",ff:"$heading",fs:"14px"}),CollapseText=({text:r,characterLimit:t=100})=>{const[o,a]=reactExports.useState(!1),d=()=>{a(!0)},p=x=>{const n=x!=null;return n&&x.length<=t?jsxRuntimeExports.jsx("div",{children:x}):n&&x.length>t&&o?jsxRuntimeExports.jsxs("div",{children:[r,jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(ShowMore,{onClick:()=>a(!1),children:"Show less"})]}):n&&x.length>t?jsxRuntimeExports.jsxs("div",{children:[x.slice(0,t),jsxRuntimeExports.jsx("span",{children:"... "}),jsxRuntimeExports.jsx(ShowMore,{onClick:()=>d(),children:"Show more"})]}):jsxRuntimeExports.jsx("div",{})};return jsxRuntimeExports.jsx("div",{children:p(r)})},WrapperModal=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",bg:"$dark_blue500",w:"80vw",maxW:"300px",">button":{mt:"20px",w:"100%",minW:"150px",h:"30px",fs:"16px",div:{border:"none"},svg:{w:"20px",h:"20px"}}}),TitleModal=styled("span",{d:"flex",align:"center",justify:"center",mr:"auto",ff:"$heading",fs:"22px",fw:"$bold",color:"$light_blue500"}),ButtonWrapper=styled("div",{d:"flex",align:"center",justify:"center",w:"100%",mt:"20px",">button":{mt:"20px",w:"100%",minW:"150px",h:"30px",fs:"16px",div:{border:"none"},svg:{w:"20px",h:"20px"}}}),DescriptionModal=styled("span",{bg:"rgba(0,0,0,0.5)",padding:"10px",w:"100%",ff:"$heading",fs:"16px",fw:"$normal",mt:"15px",textAlign:"center",color:"$white500",span:{fw:"$bold"}}),ConfirmationModal=({children:r,adventureid:t,disabled:o})=>{const a=useAuthStore(h=>h.user),d=useAdventuresStore(h=>h.advActives),p=useAdventuresStore(h=>h.updateAdvActives),x=useAdventuresStore(h=>h.updateSelectedAdventure),[n,c]=reactExports.useState(!1),[s,f]=reactExports.useState(!1);function l(h){f(o?!1:h)}async function y(){if(!(!a||!t))try{c(!0),await executeStartAdventureContract({user:a,adventureid:t,assets_ids:[]})&&(await sleep(2e3),await onRefetchAdventure(),p({...d,available:[...d.claimable,t]}),x(void 0),Q.success("Adventure started successfully"))}catch(h){console.log(h)}finally{c(!1)}}return jsxRuntimeExports.jsxs(Dialog,{onOpenChange:l,open:s,children:[jsxRuntimeExports.jsx(DialogTrigger,{children:r}),jsxRuntimeExports.jsx(DialogContent,{closeType:"primary",closePosition:"inside",children:jsxRuntimeExports.jsxs(WrapperModal,{children:[jsxRuntimeExports.jsx(TitleModal,{children:"Confirm"}),jsxRuntimeExports.jsx(DescriptionModal,{children:"Are you sure that you wants to start the adventure without NFTs ?"}),jsxRuntimeExports.jsxs(ButtonWrapper,{children:[jsxRuntimeExports.jsx(Button,{isLoading:n,disabled:n,onClick:y,color:"solidBlue",rounded:!1,children:"Confirm"}),jsxRuntimeExports.jsx(Button,{isLoading:n,disabled:n,onClick:()=>l(!1),color:"solidBlue",rounded:!1,children:"Cancel"})]})]})})]})};function Filter2SVG(){return jsxRuntimeExports.jsx("svg",{width:"22",height:"20",viewBox:"0 0 22 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M21 1H1L9 10.46V17L13 19V10.46L21 1Z",stroke:"#EBB309",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}const StarSVG$1=React.lazy(()=>__vitePreload(()=>import("./star-ba28bbaa.js"),["assets/star-ba28bbaa.js","assets/index-e35bb2ad.js","assets/index-55fec1ff.css"])),AdventureSelected=({selected})=>{var r,t,o,a,d,p,x,n,c,s,f,l,y,h,E,b;const{isSmall}=useMedia(),user=useAuthStore(e=>e.user),advActives=useAdventuresStore(e=>e.advActives),updateAdvActives=useAdventuresStore(e=>e.updateAdvActives),advTemplate=useAdventuresStore(e=>e.advTemplate),updateSelectedAdventure=useAdventuresStore(e=>e.updateSelectedAdventure),[isLoading,setIsLoading]=reactExports.useState(!1),[inventoryPosition,setInventoryPosition]=reactExports.useState(-1),[totalBonus,setTotalBonus]=reactExports.useState(100),[selectedFilter,setSelectedFilter]=reactExports.useState([]),[selectedBonus,setSelectedBonus]=reactExports.useState({}),[inventoryFilter,setInventoryFilter]=reactExports.useState("crew.worlds"),[selectedCards,setSelectedCards]=reactExports.useState([void 0,void 0,void 0]),{data:inventory,isLoading:isInventoryLoading}=useInventoryUnlocksQuery(inventoryFilter);function handleInventoryPosition(e){setInventoryPosition(e)}function handleSelectCard(e){if(!e){const i=selectedCards.map((g,v)=>{if(v!==inventoryPosition)return g});calculateTotalBonus(i),setInventoryPosition(-1),setSelectedCards(i);return}if(selectedCards.some(i=>(i==null?void 0:i.asset_id)===(e==null?void 0:e.asset_id))){setInventoryPosition(-1);return}const u=selectedCards.map((i,g)=>g===inventoryPosition?e:i);calculateTotalBonus(u),setInventoryPosition(-1),setSelectedCards(u)}function calculateTotalBonus(e){if(!selected)return;let u={};e.forEach(g=>{const v=advTemplate==null?void 0:advTemplate.find(w=>(w==null?void 0:w.templateid)===Number(g==null?void 0:g.template.template_id));if(!v)return;const m=selected.mods.reduce((w,j,A)=>{if(j!=null&&j.lock)return w;if(j.affix_value!==99999&&j.affix_value===(v==null?void 0:v[j.affix_type])){const R=1+(j==null?void 0:j.mod_value)/100;return w[A]=R,w}if(j.affix_type==="element"&&(j.affix_string.toLocaleLowerCase()===(v==null?void 0:v.element.toLocaleLowerCase())||j.affix_string.toLocaleLowerCase()===(v==null?void 0:v.weaponclass.toLocaleLowerCase()))){const R=1+(j==null?void 0:j.mod_value)/100;return w[A]=R,w}if(j.affix_string!=="-"&&j.affix_string.toLocaleLowerCase()===String(v==null?void 0:v[j.affix_type]).toLocaleLowerCase()){const R=1+(j==null?void 0:j.mod_value)/100;return w[A]=R,w}return w},{});u={...u,...m}});const i=Object.values(u).reduce((g,v)=>g*v,100);setSelectedBonus(u),setTotalBonus(i)}async function startAdventure(){if(!(!user||!selected))try{setIsLoading(!0);const e=selectedCards.filter(i=>!!(i!=null&&i.asset_id)).map(i=>Number(i==null?void 0:i.asset_id));await executeStartAdventureContract({user,adventureid:selected.adventureid,assets_ids:e})&&(await sleep(2e3),await onRefetchAdventure(),updateAdvActives({...advActives,available:[...advActives.claimable,selected.adventureid]}),updateSelectedAdventure(void 0),Q.success("Adventure started successfully"))}catch(e){console.log(e)}finally{setIsLoading(!1)}}function formatAffixValue(e,u,i){return e==="tlm.mp"||e==="nft.mp"?(u/10).toFixed(1):i==="-"?u:i}function handleAddFilter(e){const u=formatAffixValue(e==null?void 0:e.affix_type,e==null?void 0:e.affix_value,e==null?void 0:e.affix_string);if(selectedFilter.some(i=>(i==null?void 0:i.type)===(e==null?void 0:e.affix_type)&&i.value===u)){const i=selectedFilter.filter(g=>g.value!==u||(g==null?void 0:g.type)!==(e==null?void 0:e.affix_type));setSelectedFilter(i);return}setSelectedFilter([...selectedFilter,{type:e==null?void 0:e.affix_type,value:u}])}function filterInventoryCards(card){const cardTemplate=advTemplate==null?void 0:advTemplate.find(e=>(e==null?void 0:e.templateid)===Number(card.template.template_id));if(!cardTemplate)return!0;const conditionalString=selectedFilter.reduce((e,{type:u,value:i},g)=>(u=u==="element"&&inventoryFilter==="arms.worlds"?"weaponclass":u,typeof i=="number"?e+=` cardTemplate.${u} === ${i} ${g===selectedFilter.length-1?"":"&&"}`:e+=` cardTemplate.${u} === '${i}' ${g===selectedFilter.length-1?"":"&&"}`,e),"");return conditionalString?eval(conditionalString):!0}return jsxRuntimeExports.jsxs(Wrapper$2,{children:[jsxRuntimeExports.jsxs(Header$2,{children:[jsxRuntimeExports.jsxs(HeaderData,{children:[jsxRuntimeExports.jsxs("p",{children:["Total Rewards: ",selected==null?void 0:selected.reward_qp," ",jsxRuntimeExports.jsx(QuestSVG,{})]}),jsxRuntimeExports.jsxs("p",{children:["Point Cost: ",selected==null?void 0:selected.point_cost.toLocaleString("en-US")," ",jsxRuntimeExports.jsx(StarSVG$1,{})]}),jsxRuntimeExports.jsxs("p",{children:["Duration: ",((selected==null?void 0:selected.duration_hours)??0)/24," Days"]}),jsxRuntimeExports.jsxs("p",{children:["Current Total Score: ",selected==null?void 0:selected.score_total]})]}),(selected==null?void 0:selected.sponsored)===1&&jsxRuntimeExports.jsxs(ImgFlag$2,{children:[jsxRuntimeExports.jsx("span",{children:"Sponsor"}),jsxRuntimeExports.jsx("p",{children:selected==null?void 0:selected.sponsor})]}),jsxRuntimeExports.jsx("img",{src:`${IMAGE_URL}/ipfs/${selected==null?void 0:selected.image}`,alt:"test"}),jsxRuntimeExports.jsxs(HeaderContent$2,{children:[jsxRuntimeExports.jsxs(Expire$2,{children:["send in period ends in ",(r=selected==null?void 0:selected.formatted_enter_end)==null?void 0:r.days,"d"," ",(t=selected==null?void 0:selected.formatted_enter_end)==null?void 0:t.hours,"h ",(o=selected==null?void 0:selected.formatted_enter_end)==null?void 0:o.minutes,"min"]}),jsxRuntimeExports.jsx(Title$2,{children:selected==null?void 0:selected.title})]})]}),jsxRuntimeExports.jsx(Description,{children:isSmall?jsxRuntimeExports.jsx(CollapseText,{text:selected==null?void 0:selected.flavor}):selected==null?void 0:selected.flavor}),jsxRuntimeExports.jsxs(Content$2,{children:[jsxRuntimeExports.jsx(ModsContainer,{children:selected==null?void 0:selected.mods.map((e,u)=>{const i=formatAffixValue(e==null?void 0:e.affix_type,e==null?void 0:e.affix_value,e==null?void 0:e.affix_string);if(u<5)return jsxRuntimeExports.jsxs(Mod,{leftSelected:!!selectedBonus[u],firstFive:!0,lock:e==null?void 0:e.lock,children:[jsxRuntimeExports.jsx(ModValue,{style:{marginRight:e!=null&&e.lock?"":"15px",marginLeft:"auto"},children:e!=null&&e.lock?jsxRuntimeExports.jsx(BiLockAlt,{size:25}):`+${e==null?void 0:e.mod_value}%`}),!(e!=null&&e.lock)&&jsxRuntimeExports.jsx(ButtonFilter,{isSelected:!!selectedFilter.find(g=>(g==null?void 0:g.type)===(e==null?void 0:e.affix_type)&&g.value===i),onClick:()=>handleAddFilter(e),children:jsxRuntimeExports.jsx(Filter2SVG,{})}),jsxRuntimeExports.jsx(ModType,{firstFive:!0,children:e!=null&&e.lock?!isSmall&&jsxRuntimeExports.jsxs("span",{children:["unlocked at level ",e==null?void 0:e.level_to_unlock]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AffType,{children:e==null?void 0:e.affix_type}),jsxRuntimeExports.jsx(AffValue,{children:i})]})})]},v4())})}),jsxRuntimeExports.jsxs(MainContent,{children:[inventoryPosition!==-1&&jsxRuntimeExports.jsxs(Tabs,{children:[jsxRuntimeExports.jsx(ButtonTabs,{isSelected:inventoryFilter==="crew.worlds",onClick:()=>setInventoryFilter("crew.worlds"),children:"Minions"}),jsxRuntimeExports.jsx(ButtonTabs,{isSelected:inventoryFilter==="arms.worlds",onClick:()=>setInventoryFilter("arms.worlds"),children:"Weapons"}),jsxRuntimeExports.jsx(ButtonTabs,{isSelected:inventoryFilter==="tool.worlds",onClick:()=>setInventoryFilter("tool.worlds"),children:"Tools"}),jsxRuntimeExports.jsx(ButtonTabs,{isSelected:inventoryFilter==="level.worlds",onClick:()=>setInventoryFilter("level.worlds"),children:"Levels"}),jsxRuntimeExports.jsx(ButtonTabs,{isSelected:inventoryFilter==="faces.worlds",onClick:()=>setInventoryFilter("faces.worlds"),children:"Avatars"})]}),jsxRuntimeExports.jsx(CardsContainer$2,{isInventoryOpen:inventoryPosition!==-1,children:inventoryPosition===-1?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CardImage,{onClick:()=>handleInventoryPosition(0),src:selectedCards[0]?`https://ipfs.alienworlds.io/ipfs/${(d=(a=selectedCards[0])==null?void 0:a.data)==null?void 0:d.img}`:"/assets/default-card.png",alt:(x=(p=selectedCards[0])==null?void 0:p.data)==null?void 0:x.name}),jsxRuntimeExports.jsx(CardImage,{onClick:()=>handleInventoryPosition(1),src:selectedCards[1]?`https://ipfs.alienworlds.io/ipfs/${(c=(n=selectedCards[1])==null?void 0:n.data)==null?void 0:c.img}`:"/assets/default-card.png",alt:(f=(s=selectedCards[1])==null?void 0:s.data)==null?void 0:f.name}),jsxRuntimeExports.jsx(CardImage,{onClick:()=>handleInventoryPosition(2),src:selectedCards[2]?`https://ipfs.alienworlds.io/ipfs/${(y=(l=selectedCards[2])==null?void 0:l.data)==null?void 0:y.img}`:"/assets/default-card.png",alt:(E=(h=selectedCards[2])==null?void 0:h.data)==null?void 0:E.name})]}):isInventoryLoading?new Array(6).fill(0).map((e,u)=>jsxRuntimeExports.jsx(CardLoading,{},u)):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CardImage,{onClick:()=>handleSelectCard(void 0),src:"/assets/default-card.png",alt:"default card"}),(b=inventory==null?void 0:inventory.filter(filterInventoryCards))==null?void 0:b.map(e=>{var u,i;return jsxRuntimeExports.jsx(CardImage,{onClick:()=>handleSelectCard(e),src:`https://ipfs.alienworlds.io/ipfs/${(u=e==null?void 0:e.data)==null?void 0:u.img}`,alt:(i=e==null?void 0:e.data)==null?void 0:i.name},e==null?void 0:e.asset_id)})]})})]}),jsxRuntimeExports.jsx(ModsContainer,{children:selected==null?void 0:selected.mods.map((e,u)=>{const i=formatAffixValue(e==null?void 0:e.affix_type,e==null?void 0:e.affix_value,e==null?void 0:e.affix_string);if(u>=5)return jsxRuntimeExports.jsxs(Mod,{rightSelected:!!selectedBonus[u],firstFive:!1,lock:e==null?void 0:e.lock,children:[!(e!=null&&e.lock)&&jsxRuntimeExports.jsx(ButtonFilter,{isSelected:!!selectedFilter.find(g=>(g==null?void 0:g.type)===(e==null?void 0:e.affix_type)&&g.value===i),onClick:()=>handleAddFilter(e),children:jsxRuntimeExports.jsx(Filter2SVG,{})}),jsxRuntimeExports.jsx(ModValue,{style:{marginLeft:e!=null&&e.lock?"":"15px",marginRight:"auto"},children:e!=null&&e.lock?jsxRuntimeExports.jsx(BiLockAlt,{size:25}):`+${e==null?void 0:e.mod_value}%`}),jsxRuntimeExports.jsx(ModType,{firstFive:!1,children:e!=null&&e.lock?!isSmall&&jsxRuntimeExports.jsxs("span",{children:["unlocked at level ",e==null?void 0:e.level_to_unlock]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AffType,{children:e==null?void 0:e.affix_type}),jsxRuntimeExports.jsx(AffValue,{children:formatAffixValue(e==null?void 0:e.affix_type,e==null?void 0:e.affix_value,e==null?void 0:e.affix_string)})]})})]},v4())})})]}),jsxRuntimeExports.jsxs(Total,{children:[jsxRuntimeExports.jsx("span",{children:"Score"}),jsxRuntimeExports.jsx("span",{children:Math.floor(100*(1+(totalBonus-100)/100))})]}),jsxRuntimeExports.jsx(ConfirmationModal,{adventureid:selected==null?void 0:selected.adventureid,disabled:selectedCards.some(e=>e!==void 0),children:jsxRuntimeExports.jsx(Button,{isLoading,disabled:inventoryPosition!==-1||isLoading||Number((user==null?void 0:user.mcPoints)??0)<((selected==null?void 0:selected.point_cost)??0),onClick:selectedCards.some(e=>e!==void 0)?()=>startAdventure():void 0,color:inventoryPosition!==-1?"gradientGray":"gradientPink",children:"Start"})}),jsxRuntimeExports.jsx(FooterDescription,{children:selectedCards.some(e=>e!==void 0)?`NFTs can be claimed back after ${((selected==null?void 0:selected.duration_hours)??0)/24} days`:"To complete objectives, choose NFTs before starting."})]})},StarSVG=React.lazy(()=>__vitePreload(()=>import("./star-ba28bbaa.js"),["assets/star-ba28bbaa.js","assets/index-e35bb2ad.js","assets/index-55fec1ff.css"])),AvailableDefault=({data:r})=>{const{isSmall:t}=useMedia(),o=useAdventuresStore(n=>n.advActives),a=useAdventuresStore(n=>n.selectedAdventure),d=useAdventuresStore(n=>n.updateSelectedAdventure);function p(n,c,s){return n==="tlm.mp"||n==="nft.mp"?(c/10).toFixed(1):s==="-"?c:s}const x=r==null?void 0:r.filter(n=>{var s;return((s=o==null?void 0:o.available)==null?void 0:s.find(f=>f===(n==null?void 0:n.adventureid)))!==n.adventureid});return jsxRuntimeExports.jsx(Wrapper$3,{children:a?jsxRuntimeExports.jsx(AdventureSelected,{selected:a}):!x||x.length===0?jsxRuntimeExports.jsx(EmptyContainer$2,{children:"No adventure available"}):x==null?void 0:x.map(n=>{var c,s,f;return jsxRuntimeExports.jsxs(Container$2,{children:[jsxRuntimeExports.jsxs(Header$3,{children:[jsxRuntimeExports.jsxs(HeaderContent$3,{children:[jsxRuntimeExports.jsxs(Expire$3,{children:["expires in ",(c=n==null?void 0:n.formatted_enter_end)==null?void 0:c.days,"d ",(s=n==null?void 0:n.formatted_enter_end)==null?void 0:s.hours,"h ",(f=n==null?void 0:n.formatted_enter_end)==null?void 0:f.minutes,"min"]}),jsxRuntimeExports.jsx(Title$3,{children:n==null?void 0:n.title}),jsxRuntimeExports.jsxs(Data$2,{children:[jsxRuntimeExports.jsxs("span",{children:["Duration: ",((n==null?void 0:n.duration_hours)??0)/24," Days"]}),jsxRuntimeExports.jsxs("span",{children:["Total Rewards: ",n==null?void 0:n.reward_qp," ",jsxRuntimeExports.jsx(QuestSVG,{})]}),jsxRuntimeExports.jsxs("span",{children:["MC Point Cost: ",n==null?void 0:n.point_cost.toLocaleString("en-US")," ",jsxRuntimeExports.jsx(StarSVG,{})]})]})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>d(n),color:"gradientPink",children:"View"})]}),jsxRuntimeExports.jsxs(Content$3,{children:[jsxRuntimeExports.jsx(ContentData,{children:n==null?void 0:n.mods.map((l,y)=>jsxRuntimeExports.jsxs(Mod$1,{firstFive:y<5,lock:l==null?void 0:l.lock,children:[jsxRuntimeExports.jsx(ModValue$1,{children:l!=null&&l.lock?jsxRuntimeExports.jsx(BiLockAlt,{size:25}):`+${l==null?void 0:l.mod_value}%`}),jsxRuntimeExports.jsx(ModType$1,{firstFive:y<5,children:l!=null&&l.lock?t?jsxRuntimeExports.jsx(BiLockAlt,{size:25}):jsxRuntimeExports.jsxs("span",{children:["unlocked at level ",l==null?void 0:l.level_to_unlock]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AffType$1,{children:l==null?void 0:l.affix_type}),jsxRuntimeExports.jsx(AffValue$1,{children:p(l==null?void 0:l.affix_type,l==null?void 0:l.affix_value,l==null?void 0:l.affix_string)})]})})]},v4()))}),jsxRuntimeExports.jsxs(ImageContainer$2,{children:[(n==null?void 0:n.sponsored)===1&&jsxRuntimeExports.jsxs(ImgFlag$3,{children:[jsxRuntimeExports.jsx("span",{children:"Sponsor"}),jsxRuntimeExports.jsx("p",{children:n==null?void 0:n.sponsor})]}),jsxRuntimeExports.jsx("img",{src:`${IMAGE_URL}/ipfs/${n==null?void 0:n.image}`,alt:"test"})]})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>d(n),color:"gradientPink",children:"View"})]},n==null?void 0:n.adventureid)})})},Available=React.memo(AvailableDefault);function LuCheckSquare(r){return GenIcon({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 11 12 14 22 4"}},{tag:"path",attr:{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"}}]})(r)}const Wrapper$1=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",padding:"0 5px 15px 0",overflowX:"hidden",w:"100%",maxW:"1190px"});styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",w:"100%",h:"calc(100vh - 380px)",pr:"5px",overflow:"auto"});const EmptyContainer$1=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px",color:"$white500",ff:"$heading",fs:"36px",fw:"bold",textAlign:"center",w:"100%",maxW:"1190px",minH:"450px","@sm":{padding:"10px"}}),Container$1=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px",w:"100%",maxW:"1190px",">button":{display:"none"},"@sm":{align:"center",justify:"center",position:"relative",padding:"13px 5px",">button":{display:"flex"}}}),Expire$1=styled("div",{d:"flex",align:"center",justify:"center",gap:"10px",color:"$white500",ff:"$heading",fs:"16px","@sm":{w:"100%",fs:"10px",gap:"5px",order:2,zIndex:1,">svg":{w:"12px",h:"12px"}}}),Header$1=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",">button ":{fs:"18px","> div":{h:"50px"}},"@sm":{zIndex:1,">button ":{d:"none"}}}),HeaderContent$1=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column","@sm":{w:"100%"}}),Title$1=styled("h2",{d:"flex",align:"flex-start",justify:"flex-start",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{order:1,textAlign:"center",fs:"16px"}}),Data$1=styled("div",{d:"flex",align:"center",justify:"center",gap:"10px",span:{d:"flex",align:"center",justify:"center",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",color:"$white500",ff:"$heading",fs:"16px",svg:{ml:"5px"}},"@sm":{direction:"column",gap:"0px",w:"100%",order:3,mt:"125px",span:{justify:"flex-start",w:"100%",textAlign:"right","&:nth-of-type(1)":{order:2}}}}),Content$1=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",mt:"30px",">img":{br:"10px",width:"382px",height:"249px"},"@md":{">img":{width:"282px",height:"auto"}},"@sm":{mt:"5px",direction:"column",">img":{width:"100%",h:"calc(100% - 70px)",top:0,left:0,position:"absolute"}}}),CardsContainer$1=styled("div",{d:"flex",align:"flex-start",justify:"center",pb:"20px",">img":{width:"174px",height:"259px",zIndex:"2","&:nth-of-type(1)":{transform:"translate(60px,20px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-60px,20px) rotate(20deg)",zIndex:"1"}},"@md":{gap:"20px",">img":{width:"100px",height:"155px","&:nth-of-type(1)":{transform:"translate(30px,10px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-30px,10px) rotate(20deg)",zIndex:"1"}}},"@sm":{gap:"20px",mt:"-165px",ml:"-90px",">img":{width:"60px",height:"95px","&:nth-of-type(1)":{transform:"translate(30px,10px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-30px,10px) rotate(20deg)",zIndex:"1"}}}}),ImageContainer$1=styled("div",{position:"relative",overflow:"hidden",minWidth:"382px",height:"249px",img:{br:"10px",width:"382px",height:"249px",objectFit:"cover"},"@sm":{position:"absolute",minWidth:"100%",width:"100%",h:"170px",top:0,left:0,img:{width:"100%",h:"170px",position:"absolute"}}}),ImgFlag$1=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",zIndex:"1",w:"300px",padding:"0 0 5px",position:"absolute",right:"-90px",top:"40px",transform:"rotate(45deg)",bg:"#65B5FF",color:"$white500",ff:"$heading",span:{fw:"$bold",fs:"20px"},p:{fs:"16px"},"@sm":{transform:"rotate(315deg)",w:"210px",top:"115px",right:"-70px",span:{pt:"5px",fs:"12px"},p:{fs:"8px"}}});async function executeClaimAdventureContract(r,t){const{executeTransaction:o}=useTransaction(),a=buildTransaction(r,t);return!!await o(a)}function buildTransaction(r,t){return{actions:[{account:SMART_CONTRACTS.ADVENTURE_MC,name:"claimadv",authorization:[{actor:r.name,permission:r.requestPermission}],data:{wallet:r.name,adventureid:t}}]}}const ClaimableDefault=({data:r})=>{const t=useAuthStore(s=>s.user),o=useAuthStore(s=>s.updateMember),a=useAdventuresStore(s=>s.advActives),d=useAdventuresStore(s=>s.updateAdvActives),[p,x]=reactExports.useState(!1);async function n(s){if(!(!t||typeof s!="number"))try{x(!0),await executeClaimAdventureContract(t,s)&&(await sleep(4e3),await onRefetchAdventure(),await onRefetchUserWeekly(),d({...a,claimable:[...a.claimable,s]}),await o(),Q.success("Adventure claimed successfully"))}catch(f){console.log(f)}finally{x(!1)}}const c=r==null?void 0:r.filter(s=>{var l;return((l=a==null?void 0:a.claimable)==null?void 0:l.find(y=>y===(s==null?void 0:s.adventureid)))!==s.adventureid});return jsxRuntimeExports.jsx(Wrapper$1,{children:!c||c.length===0?jsxRuntimeExports.jsx(EmptyContainer$1,{children:"No adventure available to claim"}):c==null?void 0:c.map(s=>{var f,l,y,h,E,b,e,u,i,g,v,m;return jsxRuntimeExports.jsxs(Container$1,{children:[jsxRuntimeExports.jsxs(Header$1,{children:[jsxRuntimeExports.jsxs(HeaderContent$1,{children:[jsxRuntimeExports.jsxs(Expire$1,{children:["Mission Completed",jsxRuntimeExports.jsx(LuCheckSquare,{size:20,color:"#40D727"})]}),jsxRuntimeExports.jsx(Title$1,{children:s==null?void 0:s.title}),jsxRuntimeExports.jsxs(Data$1,{children:[jsxRuntimeExports.jsxs("span",{children:["Expected RP rewards:"," ",Math.floor(((s==null?void 0:s.score)??0)/((s==null?void 0:s.score_total)??1)*((s==null?void 0:s.reward_qp)??0))," ",jsxRuntimeExports.jsx(QuestSVG,{})]}),jsxRuntimeExports.jsxs("span",{children:["Players: ",s==null?void 0:s.players]})]})]}),jsxRuntimeExports.jsxs(Button,{disabled:p,isLoading:p,onClick:()=>n(s==null?void 0:s.adventureid),color:"gradientPink",children:["Claim NFTs & ",jsxRuntimeExports.jsx("br",{}),"Rewards"]})]}),jsxRuntimeExports.jsxs(Content$1,{children:[jsxRuntimeExports.jsxs(CardsContainer$1,{children:[jsxRuntimeExports.jsx("img",{src:(f=s==null?void 0:s.cards)!=null&&f[0]?`https://ipfs.alienworlds.io/ipfs/${(l=s==null?void 0:s.cards[0])==null?void 0:l.nftimage}`:"/assets/default-card.png",alt:(h=(y=s==null?void 0:s.cards)==null?void 0:y[0])==null?void 0:h.cardname}),jsxRuntimeExports.jsx("img",{src:(E=s==null?void 0:s.cards)!=null&&E[1]?`https://ipfs.alienworlds.io/ipfs/${(b=s==null?void 0:s.cards[1])==null?void 0:b.nftimage}`:"/assets/default-card.png",alt:(u=(e=s==null?void 0:s.cards)==null?void 0:e[1])==null?void 0:u.cardname}),jsxRuntimeExports.jsx("img",{src:(i=s==null?void 0:s.cards)!=null&&i[2]?`https://ipfs.alienworlds.io/ipfs/${(g=s==null?void 0:s.cards[2])==null?void 0:g.nftimage}`:"/assets/default-card.png",alt:(m=(v=s==null?void 0:s.cards)==null?void 0:v[2])==null?void 0:m.cardname})]}),jsxRuntimeExports.jsxs(ImageContainer$1,{children:[(s==null?void 0:s.sponsored)===1&&jsxRuntimeExports.jsxs(ImgFlag$1,{children:[jsxRuntimeExports.jsx("span",{children:"Sponsor"}),jsxRuntimeExports.jsx("p",{children:s==null?void 0:s.sponsor})]}),jsxRuntimeExports.jsx("img",{src:`${IMAGE_URL}/ipfs/${s==null?void 0:s.image}`,alt:"test"})]})]}),jsxRuntimeExports.jsxs(Button,{disabled:p,isLoading:p,onClick:()=>n(s==null?void 0:s.adventureid),color:"gradientPink",children:["Claim NFTs & ",jsxRuntimeExports.jsx("br",{}),"Rewards"]})]},s==null?void 0:s.adventureid)})})},Claimable=React.memo(ClaimableDefault),Wrapper=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",padding:"0 5px 15px 0",overflowX:"hidden",w:"100%",maxW:"1190px"});styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"20px",w:"100%",h:"calc(100vh - 380px)",pr:"5px",overflow:"auto"});const EmptyContainer=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px",color:"$white500",ff:"$heading",fs:"36px",fw:"bold",textAlign:"center",w:"100%",maxW:"1190px",minH:"450px","@sm":{padding:"10px"}}),Container=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",br:"10px",background:"rgba(3, 16, 32, 0.65)",padding:"30px 18px 60px",w:"100%",maxW:"1190px",">button":{display:"none"},"@sm":{align:"center",justify:"center",position:"relative",padding:"13px",">button":{display:"flex"}}}),Expire=styled("div",{d:"flex",align:"center",justify:"center",gap:"10px",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",color:"$white500",ff:"$heading",fs:"16px","@sm":{w:"100%",fs:"10px",gap:"5px",order:2,zIndex:1,">svg":{w:"12px",h:"12px"}}}),Header=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",">button ":{fs:"18px","> div":{h:"50px"}},"@sm":{zIndex:1,">button ":{d:"none"}}}),HeaderContent=styled("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column","@sm":{w:"100%"}}),Title=styled("h2",{d:"flex",align:"flex-start",justify:"flex-start",color:"$white500",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",fs:"40px",w:"100%","@sm":{order:1,fs:"20px"}}),Data=styled("div",{d:"flex",align:"center",justify:"center",gap:"10px",span:{d:"flex",align:"center",justify:"center",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.9)",color:"$white500",ff:"$heading",fs:"16px",svg:{ml:"5px"}},"@sm":{direction:"column",gap:"0px",w:"100%",order:3,mt:"125px",span:{justify:"flex-start",w:"100%",textAlign:"right","&:nth-of-type(1)":{order:2}}}}),Content=styled("div",{d:"flex",align:"center",justify:"space-between",w:"100%",mt:"30px",">img":{br:"10px",width:"382px",height:"249px"},"@sm":{direction:"column",mt:"0px",">img":{width:"100%",h:"calc(100% - 70px)",top:0,left:0,position:"absolute"}}}),CardsContainer=styled("div",{d:"flex",align:"flex-start",justify:"center",">img":{width:"174px",height:"259px",zIndex:"2","&:nth-of-type(1)":{transform:"translate(60px,20px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-60px,20px) rotate(20deg)",zIndex:"1"}},"@md":{gap:"20px",">img":{width:"100px",height:"155px","&:nth-of-type(1)":{transform:"translate(30px,10px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-30px,10px) rotate(20deg)",zIndex:"1"}}},"@sm":{gap:"20px",mt:"-160px",ml:"-90px",">img":{width:"60px",height:"95px","&:nth-of-type(1)":{transform:"translate(30px,10px) rotate(-20deg)",zIndex:"3"},"&:nth-of-type(3)":{transform:"translate(-30px,10px) rotate(20deg)",zIndex:"1"}}}}),ImageContainer=styled("div",{position:"relative",overflow:"hidden",minWidth:"382px",height:"249px",img:{br:"10px",width:"382px",height:"249px",objectFit:"cover"},"@sm":{position:"absolute",minWidth:"100%",width:"100%",h:"170px",top:0,left:0,img:{width:"100%",h:"170px",position:"absolute"}}}),ImgFlag=styled("div",{d:"flex",align:"center",justify:"center",direction:"column",zIndex:"1",w:"300px",padding:"0 0 5px",position:"absolute",right:"-90px",top:"40px",transform:"rotate(45deg)",bg:"#65B5FF",color:"$white500",ff:"$heading",span:{fw:"$bold",fs:"20px"},p:{fs:"16px"},"@sm":{transform:"rotate(315deg)",w:"210px",top:"115px",right:"-70px",span:{pt:"5px",fs:"12px"},p:{fs:"8px"}}}),RunningDefault=({data:r})=>jsxRuntimeExports.jsx(Wrapper,{children:!r||r.length===0?jsxRuntimeExports.jsx(EmptyContainer,{children:"No adventure running"}):r==null?void 0:r.map(t=>{var o,a,d,p,x,n,c,s,f,l,y,h,E,b,e;return jsxRuntimeExports.jsxs(Container,{children:[jsxRuntimeExports.jsx(Header,{children:jsxRuntimeExports.jsxs(HeaderContent,{children:[jsxRuntimeExports.jsxs(Expire,{children:["Returning in ",(o=t==null?void 0:t.formatted_return)==null?void 0:o.days,"d ",(a=t==null?void 0:t.formatted_return)==null?void 0:a.hours,"h"," ",(d=t==null?void 0:t.formatted_return)==null?void 0:d.minutes,"min"]}),jsxRuntimeExports.jsx(Title,{children:t==null?void 0:t.title}),jsxRuntimeExports.jsxs(Data,{children:[jsxRuntimeExports.jsxs("span",{children:["Current RP Estimation:"," ",Math.floor(((t==null?void 0:t.score)??0)/((t==null?void 0:t.score_total)??1)*((t==null?void 0:t.reward_qp)??0))," ",jsxRuntimeExports.jsx(QuestSVG,{})]}),jsxRuntimeExports.jsxs("span",{children:["Players: ",t==null?void 0:t.players]})]})]})}),jsxRuntimeExports.jsxs(Content,{children:[jsxRuntimeExports.jsxs(CardsContainer,{children:[jsxRuntimeExports.jsx("img",{src:(p=t==null?void 0:t.cards)!=null&&p[0]?`https://ipfs.alienworlds.io/ipfs/${(x=t==null?void 0:t.cards[0])==null?void 0:x.nftimage}`:"/assets/default-card.png",alt:(c=(n=t==null?void 0:t.cards)==null?void 0:n[0])==null?void 0:c.cardname}),jsxRuntimeExports.jsx("img",{src:(s=t==null?void 0:t.cards)!=null&&s[1]?`https://ipfs.alienworlds.io/ipfs/${(f=t==null?void 0:t.cards[1])==null?void 0:f.nftimage}`:"/assets/default-card.png",alt:(y=(l=t==null?void 0:t.cards)==null?void 0:l[1])==null?void 0:y.cardname}),jsxRuntimeExports.jsx("img",{src:(h=t==null?void 0:t.cards)!=null&&h[2]?`https://ipfs.alienworlds.io/ipfs/${(E=t==null?void 0:t.cards[2])==null?void 0:E.nftimage}`:"/assets/default-card.png",alt:(e=(b=t==null?void 0:t.cards)==null?void 0:b[2])==null?void 0:e.cardname})]}),jsxRuntimeExports.jsxs(ImageContainer,{children:[(t==null?void 0:t.sponsored)===1&&jsxRuntimeExports.jsxs(ImgFlag,{children:[jsxRuntimeExports.jsx("span",{children:"Sponsor"}),jsxRuntimeExports.jsx("p",{children:t==null?void 0:t.sponsor})]}),jsxRuntimeExports.jsx("img",{src:`${IMAGE_URL}/ipfs/${t==null?void 0:t.image}`,alt:"test"})]})]})]},t==null?void 0:t.adventureid)})}),Running=React.memo(RunningDefault),getAdvTemplateTable=async()=>{var a,d;let r=!1,t;const o=[];for(;!r;){const p=await rpc.get_table_rows({code:SMART_CONTRACTS.ADVENTURE_MC,index_position:1,limit:"10000",scope:SMART_CONTRACTS.ADVENTURE_MC,table:TABLES.ADV_TEMPLATES,show_payer:!1,json:!0,lower_bound:t});r=!p.more,o.push(...p.rows.slice(0,-1)),t=((d=(a=p.rows)==null?void 0:a[p.rows.length-1])==null?void 0:d.templateid)??""}return o},useAdvTemplateQuery=()=>useQuery({queryKey:[QUERY_KEYS.ADV_TEMPLATES],queryFn:()=>onFetch(),staleTime:1e3*60*60,enabled:!!useAuthStore.getState().user});async function onFetch(){try{const r=await getAdvTemplateTable();return r?formattedTemplateData(r):null}catch(r){return console.log(r),null}}function formattedTemplateData(r){return r.map(t=>({...t,"nft.mp":t.nft_mp,"tlm.mp":t.tlm_mp}))}const Adventures=()=>{const{isLoading:r}=useAdvTemplateQuery(),{data:t,isLoading:o,isFetching:a}=useAdventureQuery(),d=useAdventuresStore(f=>f.selectedAdventure),p=useAdventuresStore(f=>f.updateSelectedAdventure),[x,n]=reactExports.useState("available");function c(f){n(f),p(void 0),s()}async function s(){await onRefetchAdventure()}return jsxRuntimeExports.jsxs(Wrapper$4,{children:[jsxRuntimeExports.jsxs(Title$4,{children:["Adventures"," ",jsxRuntimeExports.jsxs(InfoLink,{href:"https://medium.com/mining-matters/feature-spotlight-adventures-c28fb9fff6e2",target:"_blank",children:[jsxRuntimeExports.jsx(InformationSvgBuilder,{})," "]})]}),jsxRuntimeExports.jsxs(Tab,{children:[d&&jsxRuntimeExports.jsx(HiMiniArrowLeftCircle,{color:"white",size:40,onClick:()=>p(void 0)}),jsxRuntimeExports.jsx(TabButton,{onClick:()=>c("available"),isActive:x==="available",children:"Available"}),jsxRuntimeExports.jsx(TabButton,{onClick:()=>c("running"),isActive:x==="running",children:"Running"}),jsxRuntimeExports.jsx(TabButton,{onClick:()=>c("claimable"),isActive:x==="claimable",children:"Claimable"})]}),o||a||r?jsxRuntimeExports.jsx(Loading,{}):jsxRuntimeExports.jsxs(Content$4,{children:[x==="available"&&jsxRuntimeExports.jsx(Available,{data:t==null?void 0:t.available}),x==="running"&&jsxRuntimeExports.jsx(Running,{data:t==null?void 0:t.participants}),x==="claimable"&&jsxRuntimeExports.jsx(Claimable,{data:t==null?void 0:t.claimable})]})]})};export{Adventures as default};

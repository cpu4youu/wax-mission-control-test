import{s as o,e as me,S as Se,u as Me,j as s,R as Ee,an as Fe,W as Ie,V as ke,U as Re,aw as Ne,b as F,P as L,f,m as b,Z as We,_ as $e,$ as Be,a1 as C,a3 as I,a2 as J,d as K,a0 as X,a5 as _e,aq as k,v as ee,B as m,ay as se,w as te,az as ne,l as ae,L as ie,n as T}from"./index-2923b243.js";import{u as Ae}from"./index-326021c2.js";import{a as Pe}from"./index.esm-e4ba0765.js";import{S as re}from"./shards-19d3235f.js";import{a as Ve,e as Ue}from"./execute-remove-favorites-land-contract-8de61989.js";import{e as qe}from"./execute-equip-tools-contract-da320a48.js";import{o as ze}from"./inventory-query-a176ce42.js";import"./info-builder-84cc6b86.js";const Ge=o("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",maxW:"1190px",padding:"0 10px",">svg":{mr:"auto",mt:"20px",cursor:"pointer"}}),oe=o("h3",{d:"flex",justify:"space-between",w:"100%",mr:"auto",mt:"25px",gap:"10px",fs:"29px",fw:"$bold",ff:"$heading",color:"$white500",">button":{h:"25px",div:{fs:"16px",border:"none",br:"10px"}},"@sm":{align:"center",fs:"18px",flexWrap:"wrap",svg:{w:"25px",h:"25px"}}}),ce=o("h4",{w:"100%",textAlign:"center",fs:"22px",fw:"$normal",ff:"$heading",color:"$white500","@sm":{fs:"18px"}}),He=o("div",{d:"flex",align:"center",justify:"flex-start",flexWrap:"wrap",gap:"20px",mt:"30px",mb:"30px",w:"100%","@sm":{gap:"10px",justify:"center"}}),Qe=o("div",{d:"flex",align:"center",justify:"center",w:"100%",variants:{isSelected:{true:{">div:last-child":{border:"3px solid #00BAFF","@sm":{border:"1px solid #00BAFF"}}}}},"@sm":{justify:"center"}}),Ze=o("div",{d:"flex",align:"center",justify:"flex-start",gap:"6px",w:"100%",maxW:"260px"}),Oe=o("div",{w:"82px",h:"82px",border:"3px solid $black500",overflow:"hidden",br:"5px",">img":{w:"82px",h:"82px",objectFit:"cover",objectPosition:"center 3px",scale:"1.9"},variants:{rarity:{Abundant:{borderColor:"#4c4c4c"},Common:{borderColor:"#000000"},Rare:{borderColor:"#3d74e9"},Epic:{borderColor:"#8719f0"},Legendary:{borderColor:"#da992e"},Mythical:{borderColor:"#d20066"}}},"@sm":{w:"52px",h:"52px",">img":{w:"52px",h:"52px"}}}),Ye=o("div",{d:"flex",align:"center",justify:"space-between",br:"8px",padding:"20px",bg:"rgba(255, 255, 255, 0.06)",w:"100%",">button":{h:"25px",br:"10px",minW:"50px","&:first-child":{minW:"140px"},div:{fs:"16px",border:"none",br:"10px"}},"@sm":{padding:"5px",justify:"center",gap:"5px",">button":{w:"50px",maxW:"50px",minW:"50px"}}}),De=o("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",margin:"auto",w:"100%","@md":{d:"flex",padding:"0 20px",flexWrap:"wrap"},"@sm":{align:"center",padding:"0px"}}),Je=me({"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}}),Ke=o("button",{variants:{isLoading:{true:{svg:{animation:`${Je} 1.2s ease-in-out infinite`}}}}}),Xe=o("div",{d:"flex",align:"center",justify:"flex-start",flexWrap:"wrap",gap:"56px",mt:"65px",w:"100%","@md":{d:"flex",justify:"center",padding:"0 20px"},"@sm":{mt:"45px",gap:"35px",padding:"0 10px"}}),le=o("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",maxW:"250px","@sm":{w:"100%",maxW:"unset"}}),de=o("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%","@sm":{gap:"10px",direction:"row",w:"100%"}}),xe=o("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column"}),pe=o("div",{d:"flex",align:"center",justify:"center",overflow:"hidden",h:"140px",w:"100%",borderRadius:"8px",border:"3px solid rgba(255, 255, 255, 0.06)",">img:nth-child(2)":{objectFit:"cover",h:"140px",w:"100%"},"@sm":{w:"100%",maxW:"150px",h:"80px",">img:nth-child(2)":{objectFit:"cover",h:"80px",w:"100%"}}}),h=o("div",{d:"flex",span:{d:"flex",align:"center",justify:"center",gap:"7px",fs:"16px",ff:"$body",color:"$white500","&:nth-child(2)":{ml:"7px"},svg:{w:"20px",h:"20px"}},"@sm":{span:{fs:"14px"}}}),ue=o("img",{w:"82px",h:"82px",position:"absolute",left:"-30px",top:"-30px",zIndex:1,"@sm":{left:"-15px",top:"-20px",w:"50px",h:"50px"}}),fe=o("div",{d:"flex",align:"center",justify:"center",direction:"row",mb:"5px",w:"100%",">button":{h:"25px",minH:"40px",minW:"unset",w:"100%",div:{fs:"16px",border:"none",br:"10px"},"&:last-child":{position:"absolute",bottom:"155px",right:"5px",w:"40px",h:"40px",minH:"40px",minW:"40px",br:"10px",">div":{fs:"14px",border:"none",br:"10px"}}},"@sm":{w:"100%",">button":{w:"100%",maxW:"unset",minW:"unset","&:last-child":{position:"relative",bottom:"0px",right:"0px"}}}}),he=me({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),es=o("div",{d:"flex",w:"100%",h:"90px",background:"linear-gradient( -90deg, rgba(255,255,255, .05), rgba(255,255,255, 0.07) ,rgba(255,255,255, .05))",br:"10px",backgroundSize:"400% 400%",animation:`${he} 1.2s ease-in-out infinite`,"@sm":{h:"215px",w:"100%"}}),ss=o("div",{d:"flex",w:"250px",h:"280px",background:"linear-gradient( -90deg, rgba(255,255,255, .05), rgba(255,255,255, 0.07) ,rgba(255,255,255, .05))",br:"10px",backgroundSize:"400% 400%",animation:`${he} 1.2s ease-in-out infinite`,"@sm":{w:"100%",h:"275px"}});async function ts(n,j){const{executeTransaction:x}=Me(),S=ns(n,j);return!!await x(S)}function ns(n,j){return{actions:[{account:Se.MEMBERS_MC,name:"remfavtools",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name,asset_ids:j}}]}}function as(){return s.jsx("svg",{width:"26",height:"36",viewBox:"0 0 26 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M12.9993 5.4V9C11.217 8.99681 9.47379 9.52292 7.99079 10.5116C6.50779 11.5003 5.35175 12.9071 4.66923 14.5537C3.98672 16.2002 3.80846 18.0123 4.15706 19.7602C4.50567 21.5082 5.36543 23.1133 6.62735 24.372L4.08935 26.91C2.32703 25.1479 1.12685 22.9027 0.640598 20.4584C0.154349 18.0141 0.403873 15.4805 1.35761 13.1781C2.31135 10.8756 3.92646 8.90769 5.99869 7.52319C8.07092 6.1387 10.5072 5.39982 12.9993 5.4ZM21.9093 9.09C23.6717 10.8521 24.8719 13.0973 25.3581 15.5416C25.8443 17.9859 25.5948 20.5195 24.6411 22.8219C23.6873 25.1244 22.0722 27.0923 20 28.4768C17.9278 29.8613 15.4915 30.6002 12.9993 30.6V27C14.7817 27.0032 16.5249 26.4771 18.0079 25.4884C19.4909 24.4996 20.6469 23.0929 21.3295 21.4463C22.012 19.7998 22.1902 17.9877 21.8416 16.2398C21.493 14.4918 20.6333 12.8867 19.3713 11.628L21.9093 9.09ZM12.9993 36L5.79935 28.8L12.9993 21.6V36ZM12.9993 14.4V0L20.1993 7.2L12.9993 14.4Z",fill:"white"})})}const R=Ee.lazy(()=>Fe(()=>import("./hearth-broken-ef06e9e5.js"),["assets/hearth-broken-ef06e9e5.js","assets/index-2923b243.js","assets/index-55fec1ff.css"])),us=()=>{var U,q;const{data:n,isFetching:j}=Ie(),{data:x,isFetching:S}=ke(),{data:M,isFetching:ge}=Re(),{data:a,isLoading:N,isFetching:je}=Ne(),r=F(e=>e.user),g=L(e=>e.nonce),we=L(e=>e.updateHashExpire),v=L(e=>e.isCalculating),W=L(e=>e.updateIsCalculating),[l,p]=f.useState(!1),[,E]=f.useState(!1),$=f.useCallback(e=>{var i;return(((i=n==null?void 0:n.userTools)==null?void 0:i.reduce((c,d)=>c+(d==null?void 0:d.nft_power),0))??0)*(e/10)},[n==null?void 0:n.userTools]);function be(){Ae.setState({selectedPage:"main"})}const B=(U=a==null?void 0:a.favoriteTools)==null?void 0:U.findIndex(e=>e.every(t=>{var i;return(i=n==null?void 0:n.userTools)==null?void 0:i.some(c=>c.asset_id===t.assetId)}));async function _(e){if(r){p(!0);try{const t=e.map(({assetId:c})=>c).join(",");if(await Ve(r,t)){await b(1e3);const c=await ie(r==null?void 0:r.name);F.setState(d=>({...d,user:d.user?{...d.user,...c}:null})),await k(),T.success("Land removed from favorites")}}catch(t){console.error(t)}finally{p(!1)}}}async function ve(e){if(r){p(!0);try{const t=e.map(({assetId:c})=>c).join(",");if(await ts(r,t)){await b(1e3);const c=await ie(r==null?void 0:r.name);F.setState(d=>({...d,user:d.user?{...d.user,...c}:null})),await k(),T.success("Toolset removed from favorites")}}catch(t){console.error(t)}finally{p(!1)}}}async function ye(e){if(!(!(n!=null&&n.userTools)||!r)){p(!0);try{const t=e==null?void 0:e.map(({assetId:c})=>Number(c));await qe(r,t)&&(await b(1500),await ze("tool.worlds"),await V(),T.success("Tools added to current setup"))}catch(t){console.error(t)}finally{p(!1)}}}async function A(e){if(r){p(!0);try{await Ue(r,e)&&(await b(1e3),await C(),T.success("Land changed successfully"))}catch(t){console.error(t)}finally{p(!1)}}}async function Le(){await X(),await C()}const P=f.useCallback(async e=>{p(!0);try{if(W(!0),await b(500),!r)return null;if(!(g!=null&&g.rand_str)){await We();const c=new Date;we(c.setMinutes(c.getMinutes()+1))}const t=(x==null?void 0:x.current_land)===e?void 0:e;await $e(r,t)&&(await Be(r==null?void 0:r.name),await Le(),await C())}catch(t){console.log(t)}finally{W(!1),p(!1)}},[r,x,g==null?void 0:g.rand_str]),y=f.useCallback(e=>{var d,z,G,H,Q,Z,O,Y,D;const t=(e??0)/10;if(((d=n==null?void 0:n.userTools)==null?void 0:d.length)===1){const w=t*(((G=(z=n==null?void 0:n.userTools)==null?void 0:z[0])==null?void 0:G.delay)??0);return I(w,n,x)}const i=(H=n==null?void 0:n.userTools)==null?void 0:H.sort((w,Te)=>Te.delay-w.delay);if(((Q=n==null?void 0:n.userTools)==null?void 0:Q.length)===2){const w=t*((((Z=i==null?void 0:i[0])==null?void 0:Z.delay)??0)+(((O=i==null?void 0:i[1])==null?void 0:O.delay)??0)/2);return I(w,n,x)}const c=t*((((Y=i==null?void 0:i[0])==null?void 0:Y.delay)??0)+(((D=i==null?void 0:i[1])==null?void 0:D.delay)??0));return I(c,n,x)},[n,x]),u=f.useCallback(e=>J(K(y(e))),[y]),V=f.useCallback(async()=>{await X(),await _e(),await C(),await k()},[]),Ce=je||j||S||ge;return f.useEffect(()=>{const e=setInterval(()=>{a!=null&&a.favoriteLands.every(t=>J(K(y(t[0].delay)))==="MINE")?(E(t=>!t),clearInterval(e)):E(t=>!t)},1e3);return E(t=>!t),()=>clearInterval(e)},[a==null?void 0:a.favoriteLands,x,y]),s.jsxs(Ge,{children:[s.jsx(Pe,{size:30,color:"#fff",onClick:be}),s.jsxs(oe,{children:["Tool Favorites (",a==null?void 0:a.favoriteTools.length,"/3)"]}),s.jsx(He,{children:N?Array.from({length:3}).map((e,t)=>s.jsx(es,{},t)):(a==null?void 0:a.favoriteTools.length)===0?s.jsx(ce,{children:s.jsx("span",{children:"You don't have any favorite tool"})}):(q=a==null?void 0:a.favoriteTools)==null?void 0:q.map((e,t)=>s.jsxs(Qe,{isSelected:B===t,children:[s.jsx(Ze,{children:e.map(i=>s.jsx(Oe,{rarity:i.rarity,title:i.name,children:s.jsx("img",{src:`https://ipfs.alienworlds.io/ipfs/${i.img}`,alt:i.name})},ee()))}),s.jsxs(Ye,{children:[s.jsx(m,{noBorder:!0,color:"solidBlue",disabled:B===t||l,isLoading:l,onClick:()=>ye(e),children:"Equip"}),s.jsx(m,{disabled:l,isLoading:l,onClick:()=>ve(e),noBorder:!0,children:s.jsx(R,{})})]})]},ee()))}),s.jsxs(De,{children:[s.jsxs(oe,{children:[s.jsxs("span",{children:["Land Favorites (",a==null?void 0:a.favoriteLands.length,"/20)"]}),s.jsx(Ke,{isLoading:Ce,onClick:V,children:s.jsx(as,{})})]}),s.jsx(Xe,{children:N?Array.from({length:8}).map((e,t)=>s.jsx(ss,{},t)):(a==null?void 0:a.favoriteLands.length)===0?s.jsx(ce,{children:s.jsx("span",{children:"You don't have any favorite land"})}):s.jsxs(s.Fragment,{children:[a==null?void 0:a.favoriteLands.filter(([e])=>u(e.delay)==="MINE").sort((e,t)=>t[0].delay-e[0].delay).flatMap(([e])=>s.jsxs(le,{children:[s.jsxs(de,{children:[s.jsxs(pe,{children:[s.jsx(ue,{src:`/assets/planets/${e.planetName.toLowerCase()}.png`,alt:e.planetName,title:e.planetName}),s.jsx("img",{src:`/assets/lands/${e.landName}.webp`,alt:e.landName,title:e.landName})]}),s.jsxs(xe,{children:[s.jsxs(h,{children:[s.jsx("span",{children:"Estimated TLM:"}),s.jsxs("span",{children:[se({land:e}).toFixed(4),s.jsx(te,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Estimated shards:"}),s.jsxs("span",{children:[ne({landCardId:e.cardid,landsType:M,userTools:n==null?void 0:n.userTools})," ",s.jsx(re,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Estimated MCP:"}),s.jsxs("span",{children:[$(e.luck).toLocaleString("US-en")," ",s.jsx(ae,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Commission:"}),s.jsxs("span",{children:[e.commission/100," %"]})]})]})]}),s.jsxs(fe,{children:[s.jsx(m,{isLoading:l,disabled:l,onClick:()=>A(e.assetId),color:"solidBlue",children:"Select"}),s.jsx(m,{color:"solidBlue",isLoading:l||v,disabled:l||v||u(e.delay)!=="MINE",onClick:()=>P(e.assetId),children:u(e.delay)==="MINE"?"Mine":u(e.delay)}),s.jsx(m,{isLoading:l,disabled:l,onClick:()=>_([e]),noBorder:!0,children:s.jsx(R,{})})]})]},e.assetId)),a==null?void 0:a.favoriteLands.filter(([e])=>u(e.delay)!=="MINE").sort((e,t)=>t[0].delay-e[0].delay).flatMap(([e])=>s.jsxs(le,{children:[s.jsxs(de,{children:[s.jsxs(pe,{children:[s.jsx(ue,{src:`/assets/planets/${e.planetName.toLowerCase()}.png`,alt:e.planetName,title:e.planetName}),s.jsx("img",{src:`/assets/lands/${e.landName}.webp`,alt:e.landName,title:e.landName})]}),s.jsxs(xe,{children:[s.jsxs(h,{children:[s.jsx("span",{children:"Estimated TLM:"}),s.jsxs("span",{children:[se({land:e}).toFixed(4),s.jsx(te,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Estimated shards:"}),s.jsxs("span",{children:[ne({landCardId:e.cardid,landsType:M,userTools:n==null?void 0:n.userTools})," ",s.jsx(re,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Estimated MCP:"}),s.jsxs("span",{children:[$(e.luck).toLocaleString("US-en")," ",s.jsx(ae,{})]})]}),s.jsxs(h,{children:[s.jsx("span",{children:"Commission:"}),s.jsxs("span",{children:[e.commission/100," %"]})]})]})]}),s.jsxs(fe,{children:[s.jsx(m,{isLoading:l,disabled:l,onClick:()=>A(e.assetId),color:"solidBlue",children:"Select"}),s.jsx(m,{color:"solidBlue",isLoading:l||v,disabled:l||v||u(e.delay)!=="MINE",onClick:()=>P(e.assetId),children:u(e.delay)==="MINE"?"Mine":u(e.delay)}),s.jsx(m,{isLoading:l,disabled:l,onClick:()=>_([e]),noBorder:!0,children:s.jsx(R,{})})]})]},e.assetId))]})})]})]})};export{us as default};

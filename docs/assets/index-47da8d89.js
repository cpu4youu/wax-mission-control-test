import{s,e as _,g as $,S as p,T as k,d as b,q as j,Q as d,u as x,C,R as c,_ as L,n as F,j as t,I as O,E as A,f as m}from"./index-b4224ac4.js";import{u as D}from"./use-transaction-20953b97.js";import{u as P}from"./settings-061b29ae.js";import{d as w}from"./defaultAvatar-4cad5ddd.js";import{s as Q}from"./sleep-da79c358.js";import{i as I}from"./index-d0f05756.js";import"./toast-options-57b78c68.js";const B=s("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",w:"100%"}),q=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500"}),N=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"15px",mt:"15px",bg:"rgba(255, 255, 255, 0.05)",br:"10px",w:"100%",color:"$white500"}),z=s("div",{d:"flex",align:"flex-start",justify:"center",w:"100%",padding:"15px",br:"5px",color:"$white500"}),W=s("div",{d:"flex",align:"center",justify:"center",mr:"15px",minW:"60px",maxW:"60px",h:"60px",border:"2px solid grey",br:"999px",overflow:"hidden",img:{w:"60px",h:"60px"}}),K=s("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",w:"100%",color:"$white500"}),U=_({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),f=s("div",{m:"10px 0",w:"95%",height:"120px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1) ,rgba(255, 255, 255, 0.2))",br:"10px",backgroundSize:"400% 400%",animation:`${U} 1.2s ease-in-out infinite`}),Y=s("p",{d:"flex",align:"center",justify:"center",height:"320px",w:"100%",fw:"$thin",fs:"26px",ff:"$body",color:"$white500"}),G=s("span",{fw:"$thin",fs:"16px",ff:"$body",color:"$white500",svg:{w:"13px",h:"13px"}}),H=s("button",{d:"flex",align:"center",justify:"center",gap:"5px",mt:"10px",h:"28px",minW:"65px",borderRadius:"4px",border:" 1px solid #8F8F8F",background:"rgba(0, 0, 0, 0.22)",padding:"0px 10px 0 5px",fw:"$thin",fs:"14px",ff:"$body",color:"$white500","&[disabled]":{opacity:"0.5",cursor:"not-allowed"}}),V=async()=>await $({options:{code:p.MEMBERS_MC,index_position:1,limit:"3",reverse:!0,scope:p.MEMBERS_MC,table:k.SPONSOR}}),J=()=>b({queryKey:[d.SPONSOR],queryFn:()=>X(),staleTime:1e3*60*60*24});async function y(){return await j.invalidateQueries(d.SPONSOR)}async function X(){try{const e=await V();return e?Z(e):[]}catch(e){return console.log(e),null}}function Z(e){return e.map(n=>({...n,avatar:n.avatar.split(";")[0],avatarCollection:n.avatar.split(";")[1]}))}async function ee(e,n,a){const{executeTransaction:o}=D(),l=te(e,n,a);return!!await o(l)}function te(e,n,a){return{actions:[{account:p.MEMBERS_MC,name:"like",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,type:n,contentid:a}}]}}const ne=()=>b({queryKey:[d.MEMBERS],queryFn:()=>re(),staleTime:1e3*60*60*24,enabled:!!x.getState().user});async function S(){return await j.invalidateQueries(d.MEMBERS)}async function re(){const e=x.getState().user;if(!e)return null;try{const n=await C(e==null?void 0:e.name);return n?{...n,avatar:n.avatar.split(";")[0],avatarCollection:n.avatar.split(";")[1]}:null}catch(n){return console.log(n),null}}const ae=c.lazy(()=>L(()=>import("./fire-fill-6fe3a84b.js"),["assets/fire-fill-6fe3a84b.js","assets/index-b4224ac4.js","assets/index-55fec1ff.css"])),pe=()=>{const{data:e,isLoading:n}=J(),{data:a}=ne(),{data:o}=P(),l=x(r=>r.user),i=c.useRef(null),[g,h]=c.useState(!1);async function v(r){if(!l){m.error("User not found, please login");return}try{h(!0),await ee(l,"sponsor",r)&&(m.success("Liked"),await Q(800),await S(),await y())}catch(u){console.log(u)}finally{h(!1)}}function E(){i!=null&&i.current&&(i.current.src=w)}const M=c.useMemo(()=>{if(!(a!=null&&a.last_like))return!1;const r=new Date(a==null?void 0:a.last_like).getTime(),u=(o==null?void 0:o.likecd_minutes)??0,T=r+u*6e4,R=F.getTime();return!I(R,T)},[a,o==null?void 0:o.likecd_minutes]);return c.useEffect(()=>{const r=setInterval(()=>{S(),y()},6e4);return()=>clearInterval(r)},[]),t.jsxs(B,{children:[t.jsx(q,{children:"LATEST SPONSORS"}),t.jsx(N,{children:n?t.jsxs(t.Fragment,{children:[t.jsx(f,{}),t.jsx(f,{}),t.jsx(f,{})]}):(e==null?void 0:e.length)===0?t.jsx(Y,{children:"No Sponsors for now"}):e==null?void 0:e.map(r=>t.jsxs(z,{children:[t.jsx(W,{children:r.avatarCollection==="alienavatars "?t.jsx("img",{src:`https://ipfs.alienworlds.io/ipfs/${r.avatar}`,style:{width:"240px",height:"400px",minWidth:"240px",minHeight:"400px",objectFit:"none",scale:"0.24",objectPosition:"45% 1.5%"}}):t.jsx("img",{ref:i,onError:E,src:r.avatar!=="-"?`${O}/ipfs/${r.avatar}`:w,alt:""})}),t.jsxs(K,{children:[t.jsx(G,{children:r.log}),t.jsx(H,{onClick:()=>v(r.index),disabled:g||M,children:g?t.jsx(A,{size:"sm",colorSchema:"light"}):t.jsxs(t.Fragment,{children:[t.jsx(ae,{}),r.likes]})})]})]},r.index))})]})};export{pe as default};

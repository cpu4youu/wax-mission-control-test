import{s as l,e as X,S as D,u as ee,j as n,W as he,V as ge,U as we,b as R,P as L,f as x,m as b,Z as be,_ as ve,$ as je,a1 as C,a3 as k,a2 as H,d as Q,a0 as Z,a5 as Le,v as Y,B as v,w as Ce,l as ye,L as O,n as y}from"./index-dcee1366.js";import{u as Te}from"./index-2338c4f5.js";import{a as Se}from"./index.esm-631168c9.js";import{S as Me}from"./shards-e30caa26.js";import{u as Re,o as E,e as ke}from"./execute-equip-tools-contract-39344230.js";import{o as Ee}from"./inventory-query-2b40edc5.js";import{e as Fe}from"./execute-equip-land-contract-73cd51d8.js";const We=l("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",maxW:"1190px",padding:"0 10px",">svg":{mr:"auto",mt:"20px",cursor:"pointer"}}),J=l("h3",{d:"flex",justify:"space-between",w:"100%",mr:"auto",mt:"25px",gap:"10px",fs:"29px",fw:"$bold",ff:"$heading",color:"$white500",">button":{h:"25px",div:{fs:"16px",border:"none",br:"10px"}},"@sm":{fs:"18px",flexWrap:"wrap",span:{w:"100%"}}}),K=l("h4",{w:"100%",textAlign:"center",fs:"22px",fw:"$normal",ff:"$heading",color:"$white500","@sm":{fs:"18px"}}),Ie=l("div",{d:"flex",align:"center",justify:"flex-start",flexWrap:"wrap",gap:"20px",mt:"30px",mb:"30px",w:"100%","@sm":{justify:"center"}}),_e=l("div",{d:"flex",align:"center",justify:"center",w:"100%",variants:{isSelected:{true:{">div:last-child":{border:"3px solid #00BAFF"}}}},"@sm":{flexWrap:"wrap",justify:"center"}}),$e=l("div",{d:"flex",align:"center",justify:"flex-start",gap:"6px",w:"100%",maxW:"260px"}),Ae=l("div",{w:"82px",h:"82px",border:"3px solid $black500",overflow:"hidden",br:"5px",">img":{w:"82px",h:"82px",objectFit:"cover",objectPosition:"center 3px",scale:"1.9"},variants:{rarity:{Abundant:{borderColor:"#4c4c4c"},Common:{borderColor:"#000000"},Rare:{borderColor:"#3d74e9"},Epic:{borderColor:"#8719f0"},Legendary:{borderColor:"#da992e"},Mythical:{borderColor:"#d20066"}}}}),Pe=l("div",{d:"flex",align:"center",justify:"space-between",br:"8px",padding:"20px",bg:"rgba(255, 255, 255, 0.06)",w:"100%",">button":{h:"25px",br:"10px","&:first-child":{minW:"140px"},div:{fs:"16px",border:"none",br:"10px"}},"@sm":{mt:"10px",padding:"10px",flexWrap:"wrap",justify:"center",gap:"5px",">button":{w:"100%",maxW:"100%",minW:"100%"}}}),Ne=l("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",margin:"auto",w:"100%","@md":{d:"flex",padding:"0 20px",flexWrap:"wrap"},"@sm":{align:"center",padding:"0px"}}),Ve=X({"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}}),Be=l("button",{variants:{isLoading:{true:{svg:{animation:`${Ve} 1.2s ease-in-out infinite`}}}}}),qe=l("div",{d:"flex",align:"center",justify:"flex-start",flexWrap:"wrap",gap:"56px",mt:"65px",w:"100%","@md":{d:"flex",justify:"center",padding:"0 20px"},"@sm":{padding:"0 10px"}}),Ue=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",position:"relative",maxW:"250px",">button":{h:"40px",minH:"40px",minW:"100%",br:"10px",">div":{fs:"14px",border:"none",br:"10px"}},">div:nth-child(3)":{mt:"3px"},"@sm":{w:"100%",maxW:"unset"}}),ze=l("div",{d:"flex",align:"center",justify:"center",overflow:"hidden",h:"140px",w:"100%",borderRadius:"8px",border:"3px solid rgba(255, 255, 255, 0.06)",">img":{objectFit:"cover",h:"140px",w:"100%"},"@sm":{w:"100%",">img:nth-child(2)":{objectFit:"cover",h:"140px",w:"100%"}}}),F=l("div",{d:"flex",span:{d:"flex",align:"center",justify:"center",gap:"7px",fs:"16px",ff:"$body",color:"$white500","&:nth-child(2)":{ml:"7px"},svg:{w:"20px",h:"20px"}}}),Ge=l("img",{w:"82px",h:"82px",position:"absolute",left:"-30px",top:"-30px",zIndex:1,"@sm":{left:"-15px",top:"-20px"}}),He=l("div",{d:"flex",align:"center",justify:"center",direction:"row",mb:"5px",w:"100%",">button":{h:"25px",minH:"40px",minW:"unset",w:"100%",div:{fs:"16px",border:"none",br:"10px"}},"@sm":{w:"100%",">button":{w:"100%",maxW:"unset",minW:"unset"}}}),ne=X({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Qe=l("div",{d:"flex",w:"100%",h:"90px",background:"linear-gradient( -90deg, rgba(255,255,255, .05), rgba(255,255,255, 0.07) ,rgba(255,255,255, .05))",br:"10px",backgroundSize:"400% 400%",animation:`${ne} 1.2s ease-in-out infinite`,"@sm":{h:"215px",w:"100%"}}),Ze=l("div",{d:"flex",w:"250px",h:"280px",background:"linear-gradient( -90deg, rgba(255,255,255, .05), rgba(255,255,255, 0.07) ,rgba(255,255,255, .05))",br:"10px",backgroundSize:"400% 400%",animation:`${ne} 1.2s ease-in-out infinite`,"@sm":{w:"100%",h:"275px"}});async function Ye(a,d){const{executeTransaction:t}=ee(),g=Oe(a,d);return!!await t(g)}function Oe(a,d){return{actions:[{account:D.MEMBERS_MC,name:"remfavtools",authorization:[{actor:a.name,permission:a.requestPermission}],data:{wallet:a.name,asset_ids:d}}]}}async function Je(a,d){const{executeTransaction:t}=ee(),g=Ke(a,d);return!!await t(g)}function Ke(a,d){return{actions:[{account:D.MEMBERS_MC,name:"remfavland",authorization:[{actor:a.name,permission:a.requestPermission}],data:{wallet:a.name,asset_id:d}}]}}function Xe(){return n.jsx("svg",{width:"26",height:"36",viewBox:"0 0 26 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M12.9993 5.4V9C11.217 8.99681 9.47379 9.52292 7.99079 10.5116C6.50779 11.5003 5.35175 12.9071 4.66923 14.5537C3.98672 16.2002 3.80846 18.0123 4.15706 19.7602C4.50567 21.5082 5.36543 23.1133 6.62735 24.372L4.08935 26.91C2.32703 25.1479 1.12685 22.9027 0.640598 20.4584C0.154349 18.0141 0.403873 15.4805 1.35761 13.1781C2.31135 10.8756 3.92646 8.90769 5.99869 7.52319C8.07092 6.1387 10.5072 5.39982 12.9993 5.4ZM21.9093 9.09C23.6717 10.8521 24.8719 13.0973 25.3581 15.5416C25.8443 17.9859 25.5948 20.5195 24.6411 22.8219C23.6873 25.1244 22.0722 27.0923 20 28.4768C17.9278 29.8613 15.4915 30.6002 12.9993 30.6V27C14.7817 27.0032 16.5249 26.4771 18.0079 25.4884C19.4909 24.4996 20.6469 23.0929 21.3295 21.4463C22.012 19.7998 22.1902 17.9877 21.8416 16.2398C21.493 14.4918 20.6333 12.8867 19.3713 11.628L21.9093 9.09ZM12.9993 36L5.79935 28.8L12.9993 21.6V36ZM12.9993 14.4V0L20.1993 7.2L12.9993 14.4Z",fill:"white"})})}const on=()=>{var A,P;const{data:a,isLoading:d}=Re(),{data:t,isLoading:g}=he(),{data:u,isLoading:se}=ge(),{data:j,isLoading:te}=we(),o=R(e=>e.user),m=L(e=>e.nonce),ae=L(e=>e.updateHashExpire),W=L(e=>e.isCalculating),I=L(e=>e.updateIsCalculating),[f,p]=x.useState(!1),[,T]=x.useState(!1),re=x.useCallback(e=>{var r;return(((r=t==null?void 0:t.userTools)==null?void 0:r.reduce((i,c)=>i+(c==null?void 0:c.nft_power),0))??0)*(e/10)},[t==null?void 0:t.userTools]);function ie(){Te.setState({selectedPage:"main"})}const _=(A=a==null?void 0:a.favoriteTools)==null?void 0:A.findIndex(e=>e.every(s=>{var r;return(r=t==null?void 0:t.userTools)==null?void 0:r.some(i=>i.asset_id===s.assetId)}));async function oe(e){if(o){p(!0);try{const s=e.map(({assetId:i})=>i).join(",");if(await Je(o,s)){await b(1e3);const i=await O(o==null?void 0:o.name);R.setState(c=>({...c,user:c.user?{...c.user,...i}:null})),await E(),y.success("Land removed from favorites")}}catch(s){console.error(s)}finally{p(!1)}}}async function ce(e){if(o){p(!0);try{const s=e.map(({assetId:i})=>i).join(",");if(await Ye(o,s)){await b(1e3);const i=await O(o==null?void 0:o.name);R.setState(c=>({...c,user:c.user?{...c.user,...i}:null})),await E(),y.success("Current Land removed from favorites")}}catch(s){console.error(s)}finally{p(!1)}}}async function le(e){if(!(!(t!=null&&t.userTools)||!o)){p(!0);try{const s=e==null?void 0:e.map(({assetId:i})=>Number(i));await ke(o,s)&&(await b(1e3),$(),await Ee("tool.worlds"),y.success("Tools added to current setup"))}catch(s){console.error(s)}finally{p(!1)}}}async function de(e){if(o){p(!0);try{await Fe(o,e)&&(await b(1e3),await C(),y.success("Land added to current setup"))}catch(s){console.error(s)}finally{p(!1)}}}async function ue(){await Z(),await C()}const fe=x.useCallback(e=>{var i;const s=j==null?void 0:j.find(c=>c.landtype_id===e);return(((i=t==null?void 0:t.userTools)==null?void 0:i.reduce((c,h)=>c+(h==null?void 0:h.nft_power),0))??0)*((s==null?void 0:s.nft_power_mod)??0)/100},[t==null?void 0:t.userTools,j]),pe=x.useCallback(async e=>{p(!0);try{if(I(!0),await b(500),!o)return null;if(!(m!=null&&m.rand_str)){await be();const i=new Date;ae(i.setMinutes(i.getMinutes()+1))}const s=(u==null?void 0:u.current_land)===e?void 0:e;await ve(o,s)&&(await je(o==null?void 0:o.name),await ue(),await C())}catch(s){console.log(s)}finally{I(!1),p(!1)}},[o,u,m==null?void 0:m.rand_str]),S=x.useCallback(e=>{var c,h,N,V,B,q,U,z,G;const s=(e??0)/10;if(((c=t==null?void 0:t.userTools)==null?void 0:c.length)===1){const w=s*(((N=(h=t==null?void 0:t.userTools)==null?void 0:h[0])==null?void 0:N.delay)??0);return k(w,t,u)}const r=(V=t==null?void 0:t.userTools)==null?void 0:V.sort((w,me)=>me.delay-w.delay);if(((B=t==null?void 0:t.userTools)==null?void 0:B.length)===2){const w=s*((((q=r==null?void 0:r[0])==null?void 0:q.delay)??0)+(((U=r==null?void 0:r[1])==null?void 0:U.delay)??0)/2);return k(w,t,u)}const i=s*((((z=r==null?void 0:r[0])==null?void 0:z.delay)??0)+(((G=r==null?void 0:r[1])==null?void 0:G.delay)??0));return k(i,t,u)},[t,u]),M=x.useCallback(e=>H(Q(S(e))),[S]),$=x.useCallback(()=>{Z(),Le(),C(),E()},[]),xe=d||g||se||te;return x.useEffect(()=>{const e=setInterval(()=>{a!=null&&a.favoriteLands.every(s=>H(Q(S(s[0].delay)))==="MINE")?(T(s=>!s),clearInterval(e)):T(s=>!s)},1e3);return T(s=>!s),()=>clearInterval(e)},[a==null?void 0:a.favoriteLands,u]),n.jsxs(We,{children:[n.jsx(Se,{size:30,color:"#fff",onClick:ie}),n.jsxs(J,{children:["Tool Favorites (",a==null?void 0:a.favoriteTools.length,"/3)"]}),n.jsx(Ie,{children:d?Array.from({length:3}).map((e,s)=>n.jsx(Qe,{},s)):(a==null?void 0:a.favoriteTools.length)===0?n.jsx(K,{children:n.jsx("span",{children:"You don't have any favorite tool"})}):(P=a==null?void 0:a.favoriteTools)==null?void 0:P.map((e,s)=>n.jsxs(_e,{isSelected:_===s,children:[n.jsx($e,{children:e.map(r=>n.jsx(Ae,{rarity:r.rarity,title:r.name,children:n.jsx("img",{src:`https://ipfs.alienworlds.io/ipfs/${r.img}`,alt:r.name})},Y()))}),n.jsxs(Pe,{children:[n.jsx(v,{noBorder:!0,color:"eleventh",disabled:_===s||f,isLoading:f,onClick:()=>le(e),children:"Equip"}),n.jsx(v,{disabled:f,isLoading:f,onClick:()=>ce(e),noBorder:!0,children:"Remove from favorites"})]})]},Y()))}),n.jsxs(Ne,{children:[n.jsxs(J,{children:[n.jsxs("span",{children:["Land Favorites (",a==null?void 0:a.favoriteLands.length,"/20)"]}),n.jsx(Be,{isLoading:xe,onClick:$,children:n.jsx(Xe,{})})]}),n.jsx(qe,{children:d?Array.from({length:8}).map((e,s)=>n.jsx(Ze,{},s)):(a==null?void 0:a.favoriteLands.length)===0?n.jsx(K,{children:n.jsx("span",{children:"You don't have any favorite land"})}):a==null?void 0:a.favoriteLands.flatMap(e=>n.jsxs(Ue,{children:[n.jsx(Ge,{src:`/assets/planets/${e[0].planetName.toLowerCase()}.png`,alt:e[0].planetName,title:e[0].planetName}),n.jsx(ze,{children:n.jsx("img",{src:`/assets/lands/${e[0].landName}.webp`,alt:e[0].landName,title:e[0].landName})}),n.jsxs(F,{children:[n.jsx("span",{children:"Estimated TLM:"}),n.jsxs("span",{children:[e[0].estimated_tlm.estimated_tlm.toFixed(4)," ",n.jsx(Ce,{})]})]}),n.jsxs(F,{children:[n.jsx("span",{children:"Estimated shards:"}),n.jsxs("span",{children:[fe(e[0].cardid)," ",n.jsx(Me,{})]})]}),n.jsxs(F,{children:[n.jsx("span",{children:"Estimated MCP:"}),n.jsxs("span",{children:[re(e[0].luck).toLocaleString("US-en")," ",n.jsx(ye,{})]})]}),n.jsxs(He,{children:[n.jsx(v,{isLoading:f,disabled:f,onClick:()=>de(e[0].assetId),color:"eleventh",children:"Select"}),n.jsx(v,{color:"eleventh",isLoading:f||W,disabled:f||W||M(e[0].delay)!=="MINE",onClick:()=>pe(e[0].assetId),children:M(e[0].delay)==="MINE"?"Mine":M(e[0].delay)})]}),n.jsx(v,{isLoading:f,disabled:f,onClick:()=>oe(e),noBorder:!0,children:"Remove from favorites"})]},e[0].assetId))})]})]})};export{on as default};

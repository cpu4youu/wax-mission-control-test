import{s as l,S as g,R as p,_ as S,b as C,r as R,j as t,B as m,m as Z,A as J,c as dt,f as F,n as P,o as ut}from"./index-95edd66d.js";import{o as K,a as X,b as tt,u as ft,c as xt,d as mt,f as Q,e as pt}from"./format-date-to-iso-0dd29df4.js";import{d as $,b as et,e as ht}from"./use-transaction-817cc8d1.js";import{s as A}from"./sleep-da79c358.js";import{a as wt}from"./mineCooldown-8ac3d1e2.js";import{I as G}from"./index-82110b0a.js";import{D as gt,a as jt,b as yt,c as Tt}from"./index-a00bd150.js";import{i as W}from"./index-eca9746d.js";import{i as bt}from"./index-323f6ada.js";import"./user-miners-query-230e013a.js";import"./axios-43b00e28.js";import"./index-4e2db0fd.js";import"./index.esm-f75ce796.js";import"./iconBase-1b2f2844.js";import"./index-85464b87.js";import"./index-5531baec.js";const _t=l("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",w:"100%","@sm":{px:"0px"}}),Mt=l("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),Lt=l("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Ct=l("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"20px",w:"100%",maxWidth:"1330px",mt:"40px",px:"15px",bg:"rgba(3, 16, 32,  .55)",br:"22px",padding:"20px 35px","@sm":{padding:"20px"}}),T=l("div",{d:"grid",gridTemplateColumns:"2fr 1fr 2fr",gap:"15px",w:"100%",padding:"10px 40px ",br:"10px",bg:"rgba(255,255,255,0.03)","@sm":{d:"flex",align:"center",justify:"center",direction:"column",padding:"10px 10px ",maxH:"100%",button:{h:"30px",minW:"100%",maxW:"100%"}}}),b=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),H=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"25px",h:"100%",color:"$white500",mr:"auto","@sm":{w:"100%",justify:"space-between",direction:"row"}}),U=l("div",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",gap:"5px",color:"$white500",mr:"auto",">div":{mx:"auto",w:"95%",bg:"rgba(255,255,255)",br:"10px"},input:{color:"black",ff:"$heading",textAlign:"right",mr:"5px"},button:{h:"50px"},"@sm":{w:"100%",justify:"space-between"}}),_=l("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"14px",w:"100%","@md":{fs:"12px"},"@sm":{fs:"11px",fw:"$bold"}}),M=l("div",{d:"flex",align:"flex-start",justify:"flex-start",ff:"$heading",fs:"24px",w:"100%",svg:{m:"auto 5px",w:"20px",h:"20px"},"@md":{fs:"18px"},"@sm":{justify:"space-between",w:"max-content",fw:"$bold",fs:"12px",svg:{w:"15px",h:"15px"}}}),L=l("div",{d:"flex",align:"center",justify:"center",gap:"10px",padding:"5px 20px 5px 10px",w:"100%",svg:{color:"$white500",w:"25px",h:"25px",mr:"auto"},"@sm":{d:"none"}}),h=l("span",{w:"100%",color:"$white500",fs:"18px",ff:"$heading",svg:{verticalAlign:"sub",w:"23px",h:"23px"},"@lg":{fs:"12px"},"@md":{fs:"10px"},"@sm":{}}),Y=l("div",{w:"100%",h:"100%",d:"flex",align:"center",justify:"center",gap:"10px"});async function $t(e){const{executeTransaction:s}=$(),a=vt(e);return!!await s(a)}function vt(e){return{actions:[{account:g.M__FEDERATION,name:"claimcomms",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{receiver:e.name}}]}}async function Dt(e){const{executeTransaction:s}=$(),a=Rt(e);return!!await s(a)}function Rt(e){return{actions:[{account:g.AWLNDRATINGS,name:"claimpay",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{receiver:e.name}}]}}async function St(e,s,a){const{executeTransaction:o}=$(),c=Wt(s,a,e);return!!await o(c)}function Wt(e,s,a){return{actions:s.map(c=>({account:g.MISSION_CONTROL,name:"claimweek",authorization:[{actor:a.name,permission:a.authorization.permission}],data:{wallet:a.name,week_id:c,boost_percentage:e}}))}}async function At(e,s){const{executeTransaction:a}=$(),o=Et(e,s);return!!await a(o)}function Et(e,s){return{actions:[{account:g.HQ_MU,name:"withdrawtlm",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name}},{account:g.MEMBERS_MC,name:"withdrawdepo",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,amount:s}}]}}async function It(e,s){const{executeTransaction:a}=$(),o=zt(e,s);return!!await a(o)}function zt(e,s){return{actions:[{account:g.MISSION_CONTROL,name:"withdrawqp",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,qp:s}}]}}const Bt=l("div",{d:"flex",align:"center",justify:"center",direction:"column",bg:"$dark_blue500",w:"80vw",maxW:"685px",h2:{ff:"$heading",fs:"22px",fw:"$bold",color:"$light_blue500"},">button":{mt:"20px",w:"100%",minW:"150px",h:"30px",fs:"16px",div:{border:"none"},svg:{w:"20px",h:"20px"}}}),Ot=l("div",{d:"flex-inline",align:"flex-start",justify:"flex-start",my:"20px",color:"$white500",fs:"20px",fw:"$bold",ff:"$heading",w:"100%",svg:{mr:"5px"}});l("div",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"26px",fw:"$bold",mt:"15px",ml:"0px",textAlign:"center",color:"$white500",svg:{w:"30px",h:"30px"}});l("span",{d:"flex",align:"center",justify:"center",gap:"10px",ff:"$heading",fs:"26px",fw:"$bold",mt:"15px",ml:"10px",textAlign:"center",color:"$white500",span:{color:"#EBB309"}});const Pt=l("span",{bg:"rgba(0,0,0,0.5)",padding:"10px",w:"100%",ff:"$heading",fs:"16px",fw:"$normal",mt:"15px",textAlign:"center",color:"$white500",span:{fw:"$bold"}});async function Nt(e,s){const{executeTransaction:a}=$(),o=Vt(e,s);return!!await a(o)}function Vt(e,s){return{actions:[{account:g.MISSION_CONTROL,name:"storeqp",authorization:[{actor:e.name,permission:e.authorization.permission}],data:{wallet:e.name,qp:s}}]}}const N=p.lazy(()=>S(()=>import("./quest-eaa773eb.js"),["assets/quest-eaa773eb.js","assets/index-95edd66d.js","assets/index-55fec1ff.css"])),kt=({children:e,depositRewardPoints:s})=>{const a=C(f=>f.user),o=C(f=>f.updateMember),[c,x]=R.useState(!1),[r,d]=R.useState(!1);function E(f){d(f)}async function I(){if(!(a!=null&&a.name))return null;await A(500);const f=await J(a==null?void 0:a.name);C.setState(u=>({...u,user:u.user?{...u.user,userTlm:f}:null})),await o(),await K(),await et(),await X(),await tt()}async function z(){if(a){x(!0);try{if(!await Nt(a,s))throw new Error("Withdrawn TLM error from contract");await I(),await A(1e3),Z.success("Successfully deposited")}catch(f){console.log(f)}finally{x(!1)}}}return t.jsxs(gt,{onOpenChange:E,open:r,children:[t.jsx(jt,{children:e}),t.jsx(yt,{closeType:"primary",closePosition:"inside",children:t.jsxs(Bt,{children:[t.jsx(Tt,{children:"Deposit Reward Points"}),t.jsxs(Ot,{children:["You are about to spend ",s," ",t.jsx(N,{})," ",t.jsx("br",{}),"A"," ",Math.ceil(s*.1)," ",t.jsx(N,{})," fee (10%) will be applied. ",t.jsx("br",{}),"Your vault will receive ",s-Math.ceil(s*.1)," ",t.jsx(N,{})]}),t.jsx(Pt,{children:"Reward Points in your vault will not be automatically converted into TLM rewards at the end of the week and allow you to use them at a later date."}),t.jsx(m,{isLoading:c,disabled:c,onClick:z,color:"solidBlue",rounded:!1,children:"Confirm"})]})})]})},qt={addTLM:!1,withdrawTLM:!1,claimTLM:!1,claimMines:!1,claimComms:!1,claimPay:!1,weekReward:!1},w=p.lazy(()=>S(()=>import("./info-builder-ae483b73.js"),["assets/info-builder-ae483b73.js","assets/index-95edd66d.js","assets/index-55fec1ff.css"])),D=p.lazy(()=>S(()=>import("./tlm-d3428f4f.js"),["assets/tlm-d3428f4f.js","assets/index-95edd66d.js","assets/index-55fec1ff.css"])),Ft=p.lazy(()=>S(()=>import("./star-d3888412.js"),["assets/star-d3888412.js","assets/index-95edd66d.js","assets/index-55fec1ff.css"])),Qt=p.lazy(()=>S(()=>import("./quest-eaa773eb.js"),["assets/quest-eaa773eb.js","assets/index-95edd66d.js","assets/index-55fec1ff.css"])),le=()=>{var V,k,q;const e=C(n=>n.user),s=C(n=>n.updateMember),a=dt(n=>n.weeklies);ft();const{data:o}=ht(),{data:c}=xt(),{data:x}=mt(),[r,d]=p.useState(qt),[E,I]=p.useState(""),[z,f]=p.useState(0),u=R.useRef(null),B=a==null?void 0:a.reduce((n,i)=>{const v=((i==null?void 0:i.initial_prize_pool_formatted)??0)*((i==null?void 0:i.total_quest_points)??1)/((i==null?void 0:i.total_quest_points_week)??1);return i.week_id&&i.total_quest_points_user_week>0&&W(new Date,new Date(i==null?void 0:i.expiresDate))&&bt(new Date,new Date((i==null?void 0:i.end_date)??""))?{total:n.total+v,weeks:[...n.weeks,i.week_id]}:{total:n.total,weeks:[...n.weeks]}},{total:0,weeks:[]});async function nt(){if(e){d({...r,claimMines:!0});try{if(!await pt(e))throw new Error("Claim Mines error from contract");await j()}catch(n){console.log(n)}finally{d({...r,claimMines:!1})}}}async function at(){if(e){d({...r,claimComms:!0});try{if(!await $t(e))throw new Error("Claim Comms error from contract");await j()}catch(n){console.log(n)}finally{d({...r,claimComms:!1})}}}async function st(){if(e){d({...r,claimPay:!0});try{if(!await Dt(e))throw new Error("Claim Pay error from contract");await j()}catch(n){console.log(n)}finally{d({...r,claimPay:!1})}}}async function it(){if(e){d({...r,weekReward:!1});try{if(!await St(e,0,B.weeks))throw new Error("Week Reward error from contract");await j(),await ut()}catch(n){console.log(n)}finally{d({...r,weekReward:!1})}}}async function j(){if(!(e!=null&&e.name))return null;await A(500);const n=await J(e==null?void 0:e.name);C.setState(i=>({...i,user:i.user?{...i.user,userTlm:n}:null})),await s(),await K(),await et(),await X(),await tt()}async function ot(n){if(e){d({...r,withdrawTLM:!0});try{if(!await At(e,n))throw new Error("Withdrawn TLM error from contract");await j()}catch(i){console.log(i)}finally{d({...r,withdrawTLM:!1})}}}async function rt(){if(!(!e||!(u!=null&&u.current))){d({...r,withdrawTLM:!0});try{if(!await It(e,Number(u.current.value)))throw new Error("Withdrawn TLM error from contract");await j(),await A(1e3),Z.success("Successfully withdrawn")}catch(n){console.log(n)}finally{d({...r,withdrawTLM:!1})}}}function lt(){u!=null&&u.current&&(u.current.value=((e==null?void 0:e.score_nft)??0).toString())}const ct=n=>{const i=n.days?`${n.days}d`:"",v=n.hours?`${n.hours}h`:"",O=n.minutes?`${n.minutes}m`:"";return`${i}${v}${O}${n.seconds}s`},y=R.useMemo(()=>new Date((o==null?void 0:o.timestamp)||new Date),[o==null?void 0:o.timestamp]);return R.useEffect(()=>{const n=setInterval(()=>{const i=new Date(`${Q(y)}`),v=wt(i),O=ct(v);I(O)},1e3);return()=>clearInterval(n)},[y]),t.jsxs(_t,{children:[t.jsxs(Mt,{children:[t.jsx(Lt,{children:"The Vault"}),t.jsx("img",{src:"/assets/background/bg-the-vault.webp",alt:""})]}),t.jsxs(Ct,{children:[t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Deposited TLM"}),t.jsxs(M,{children:[(F((V=e==null?void 0:e.HqMember)==null?void 0:V.deposit)+((e==null?void 0:e.tlm_deposit)??0)/1e4).toFixed(4),t.jsx(D,{})]})]}),t.jsx(m,{rounded:!1,color:"solidBlue",isLoading:r.withdrawTLM,disabled:F((k=e==null?void 0:e.HqMember)==null?void 0:k.deposit)+((e==null?void 0:e.tlm_deposit)??0)/1e4===0,onClick:()=>ot((e==null?void 0:e.tlm_deposit)??0),children:"Withdraw"}),t.jsxs(L,{children:[t.jsx(w,{}),t.jsx(h,{children:"Deposits are currently unused"})]})]}),t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Alien Worlds Mining Rewards"}),t.jsxs(M,{children:[(o==null?void 0:o.amount.replace(" TLM",""))??"0.0000"," ",t.jsx(D,{})]})]}),t.jsx(m,{isLoading:r.claimMines,disabled:((o==null?void 0:o.amount)??0)===0||W(P,y),onClick:nt,rounded:!1,color:"solidBlue",children:W(P,y)?E:"Claim"}),t.jsxs(L,{children:[t.jsx(w,{}),t.jsxs(h,{children:["Earned by mining in Alien Worlds",W(P,y)&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),`Available on ${new Date(`${Q(y)}.000Z`).toLocaleString()}`]})]})]})]}),t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Alien Worlds Land Commission"}),t.jsxs(M,{children:[(c==null?void 0:c.comms.replace(" TLM",""))??"0.0000"," ",t.jsx(D,{})]})]}),t.jsx(m,{isLoading:r.claimComms,disabled:((c==null?void 0:c.comms)??0)===0,onClick:at,rounded:!1,color:"solidBlue",children:"Claim"}),t.jsxs(L,{children:[t.jsx(w,{}),t.jsx(h,{children:"Rewarded when others mine your land"})]})]}),t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Alien Worlds DTAL"}),t.jsxs(M,{children:[(x==null?void 0:x.payoutAmount.replace(" TLM",""))??"0.0000"," ",t.jsx(D,{})]})]}),t.jsx(m,{isLoading:r.claimPay,disabled:((x==null?void 0:x.payoutAmount)??0)===0,onClick:st,rounded:!1,color:"solidBlue",children:"Claim"}),t.jsxs(L,{children:[t.jsx(w,{}),t.jsx(h,{children:"Earned daily by owning lands in Alien Worlds"})]})]}),t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Mission Control Weekly Rewards"}),t.jsxs(M,{children:[B.total.toFixed(4)," ",t.jsx(D,{})]})]}),t.jsx(m,{isLoading:r.weekReward,disabled:B.total===0,onClick:it,rounded:!1,color:"solidBlue",children:"Claim"}),t.jsxs(L,{children:[t.jsx(w,{}),t.jsxs(h,{children:["Earned by playing Mission Control, costs ",t.jsx(Ft,{})," to claim"]})]})]}),t.jsxs(T,{children:[t.jsxs(b,{children:[t.jsx(_,{children:"Reward Point Deposit"}),t.jsxs(M,{onClick:lt,children:[e==null?void 0:e.score_nft," ",t.jsx(Qt,{})]})]}),t.jsxs(H,{children:[t.jsxs(U,{children:[t.jsx(m,{isLoading:r.weekReward,onClick:rt,rounded:!1,color:"solidBlue",children:"Withdraw"}),t.jsx(G,{dir:"rtl",type:"number",defaultValue:0,ref:u,label:""})]}),t.jsxs(U,{children:[t.jsx(kt,{depositRewardPoints:z,children:t.jsx(m,{isLoading:r.weekReward,rounded:!1,color:"solidBlue",children:"Deposit"})}),t.jsx(G,{dir:"rtl",type:"number",defaultValue:((q=e==null?void 0:e.userWeekly)==null?void 0:q.total_quest_points)??0,label:"",onChange:n=>f(Number(n.target.value))})]})]}),t.jsx(L,{children:t.jsxs(H,{children:[t.jsxs(Y,{children:[t.jsx(w,{}),t.jsx(h,{children:"Reward Points you deposited at an earlier date"})]}),t.jsxs(Y,{children:[t.jsx(w,{}),t.jsx(h,{children:"Deposit Reward Points for later use. There is a 10% fee when depositing."})]})]})})]})]})]})};export{le as default};

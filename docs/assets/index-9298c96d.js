import{s as r,e as _,S as M,u as O,aD as A,aC as U,b as E,R as T,p as l,j as t,B as j,aw as y,aE as b,h as P,k as C}from"./index-6b7758a9.js";import{C as z}from"./index-428fad6a.js";import{o as k}from"./toolov-query-61363c24.js";import{o as L}from"./inventory-query-603d1745.js";const F=r("div",{d:"flex",align:"flex-start",justify:"center",direction:"column",mt:"35px",w:"100%"}),S=r("h2",{d:"flex",align:"center",justify:"center",fs:"20px",color:"$white500"}),N=r("p",{d:"flex",align:"flex-start",justify:"flex-start",direction:"column",w:"100%",my:"15px",color:"$white500",fw:"400",ff:"$heading",fs:"20px",button:{w:"100%",maxW:"160px",h:"25px",minW:"unset",mt:"5px",">div":{border:"none"}},"@sm":{flexWrap:"wrap",span:{fs:"16px"}}}),Q=r("div",{d:"flex",align:"center",justify:"flex-start",flexWrap:"wrap",gap:"25px",mt:"15px",w:"100%","@sm":{justify:"center"}}),W=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"5px",mt:"auto",w:"100%",button:{w:"100%",maxW:"160px",h:"25px",minW:"unset",">div":{border:"none"}}}),Y=r("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"5px",m:"5px 0 10px",w:"100%"}),u=r("div",{d:"flex",align:"center",justify:"space-between",gap:"10px",px:"10px",w:"100%",svg:{w:"20px",h:"20px"}}),c=r("p",{d:"flex",align:"center",justify:"center",color:"$white500",textShadow:"0px 0px 5px rgba(0, 0, 0, 0.9)",fs:"14px",ff:"$heading",fw:"400"}),q=_({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),I=r("div",{width:"174px",height:"259px",background:"linear-gradient( -90deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.25) ,rgba(255, 255, 255, 0.15))",br:"10px",backgroundSize:"400% 400%",animation:`${q} 1.2s ease-in-out infinite`,"@sm":{width:"70px",height:"100px"}});async function K(n,i){const{executeTransaction:a}=O(),o=V(n,i);return!!await a(o)}function V(n,i){return{actions:[{account:M.TOOLS_MC,name:"unstake",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name,asset_ids:i}}]}}async function G(n){const{executeTransaction:i}=O(),a=H(n);return!!await i(a)}function H(n){return{actions:[{account:M.TOOLS_MC,name:"claim",authorization:[{actor:n.name,permission:n.requestPermission}],data:{wallet:n.name}}]}}const ne=()=>{var m,h,g,w;const{data:n,isLoading:i}=A(),{data:a}=U(),o=E(e=>e.user),[d,x]=T.useState(!1),[f,p]=T.useState(!1);async function $(e){if(o){x(!0);try{await K(o,[Number(e.asset_id)])&&(await P(2e3),await k(),await L("tool.worlds"),C.success("Tool unstaked"))}catch(s){console.error("Error staking tool",s)}finally{x(!1)}}}async function v(){if(o){p(!0);try{await G(o)&&(await k(),await L("tool.worlds"),C.success("Tool unstaked"))}catch(e){console.error("Error staking tool",e)}finally{p(!1)}}}function B(e){const s=e.getFullYear(),R=e.getMonth()+1>9?e.getMonth()+1:`0${e.getMonth()+1}`;return`${e.getDate()>9?e.getDate():`0${e.getDate()}`}/${R}/${s}`}const D=(m=n==null?void 0:n.stakedTools)==null?void 0:m.reduce((e,s)=>e+l(s.total_earned),0);return t.jsxs(F,{children:[t.jsx(S,{children:"CLAIM YOUR TLM"}),t.jsxs(N,{children:["Claimable TLM, earned by loaning:"," ",l(a==null?void 0:a.deposit)>=0?l(a==null?void 0:a.deposit).toFixed(4):`- ${l(a==null?void 0:a.trialtlm).toFixed(4)}`," ","TLM"," ",t.jsx(j,{disabled:f&&D===0,isLoading:f,onClick:v,rounded:!1,color:"solidBlue",children:"Claim TLM"})]}),t.jsx(S,{children:"YOUR STAKED TOOLS"}),t.jsx(Q,{children:i?new Array(6).fill(0).map((e,s)=>t.jsx(I,{},s)):(w=(g=(h=n==null?void 0:n.stakedTools)==null?void 0:h.filter(e=>e.owned>0))==null?void 0:g.sort((e,s)=>y[e.rarity]-y[s.rarity]||b[e.shine]-b[s.shine]))==null?void 0:w.map((e,s)=>t.jsx(z,{tool:e,children:t.jsxs(W,{children:[t.jsx(j,{disabled:d,isLoading:d,onClick:()=>$(e),rounded:!1,color:"solidBlue",children:"Unstake"}),t.jsxs(Y,{children:[t.jsxs(u,{children:[t.jsx(c,{children:"Since"}),t.jsx(c,{children:B(new Date(e.stakedat))})]}),t.jsxs(u,{children:[t.jsx(c,{children:"Total"}),t.jsx(c,{children:e.total_earned})]}),t.jsxs(u,{children:[t.jsx(c,{children:"Uses"}),t.jsx(c,{children:e.total_mines})]})]})]})},s))})]})};export{ne as default};
